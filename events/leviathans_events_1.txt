#################################
#
# Leviathan & Enclave Events
# by Maximilian Olbers, Niclas Karlsson,
# Rufus Tronde & Henrik Thyrwall
#
#################################

namespace = leviathans

country_event = {
	id = leviathans.9
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		from = {
			is_guardian_country = yes
		}
		OR = {
			is_country_type = default
			is_country_type = fallen_empire
			is_country_type = awakened_fallen_empire
		}
	}

	immediate = {
		from = {
			establish_communications_no_message = root
			save_event_target_as = leviathan_story_country
		}
		country_event = { id = story.8 days = 15 }
	}
}

# guardian kill check
country_event = {
	id = leviathans.4
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		from = {
			is_guardian_country = yes
		}
	}

	immediate = {
		fromfromfrom.solar_system = {
			save_event_target_as = leviathan_destroyed_system
		}
		root = {
			save_event_target_as = leviathan_destroyer_country
		}
		from = {
			save_event_target_as = leviathan_destroyed_country
		}
		country_event = { id = leviathans.6 days = 2 }
	}
}

# Delay necessary due to fleets not being instantly deleted, therefore num_fleets trigger won't pass otherwise
country_event = {
	id = leviathans.6
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		exists = event_target:leviathan_destroyed_system
		exists = event_target:leviathan_destroyer_country
		exists = event_target:leviathan_destroyed_country
		event_target:leviathan_destroyed_country = {
			num_fleets < 1
		}
	}

	immediate = {
		observer_event = { id = observer.1 }
		every_country = {
			limit = {
				has_communications = root
				NOT = { is_same_value = root }
			}
			country_event = { id = leviathans.5 }
		}
	}
}

# notification
country_event = {
	id = leviathans.5
	title = leviathans.5.name
	desc = leviathans.5.desc
	picture = GFX_evt_throne_room
	location = event_target:leviathan_destroyed_system
	show_sound = event_mystic_reveal

	is_triggered_only = yes

	option = {
		name = OK
	}
}

# Enclave Yearly Border Opinion
event = {
	id = leviathans.10
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		every_country = {
			limit = { is_country_type = enclave }
			country_event = { id = leviathans.11 }
		}
	}
}

country_event = {
	id = leviathans.11
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		every_owned_fleet = {
			limit = {
				exists = solar_system
				solar_system = {
					exists = space_owner
					space_owner = {
						is_country_type = default
					}
				}
			}
			solar_system = {
				space_owner = {
					root = {
						add_trust = {
							who = prev
							amount = 1
						}
					}
				}
			}
		}
	}
}

# Enclaves make contact after 300 days
country_event = {
	id = leviathans.97
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		exists = from.contact_country
		from.contact_country = { NOT = { has_communications = root } }
	}

	immediate = {
		from.contact_country = {
			root = { establish_communications_no_message = prev }
			country_event = { id = leviathans.98 }
		}
	}
}

# Enclave Establishes Communications
country_event = {
	id = leviathans.98
	title = leviathans.98.name
	desc = leviathans.98.desc
	picture = GFX_evt_throne_room
	show_sound = event_radio_chatter

	is_triggered_only = yes

	after = {
		hidden_effect = {
			from = {
				switch = {
					trigger = has_country_flag
					trader_enclave_country = { country_event = { id = leviathans.101 } }
					artist_enclave_country = { country_event = { id = leviathans.301 } }
					curator_enclave_country = { country_event = { id = leviathans.501 } }
					default = { log_error = "Unexpected enclave type or missing script flag" }
				}
			}
		}
	}

	option = {
		name = SCUM
		trigger = {
			has_valid_civic = civic_fanatic_purifiers
		}
	}

	option = {
		name = TASTY
		trigger = {
			has_valid_civic = civic_hive_devouring_swarm
		}
	}

	option = {
		name = EXTERMINATE
		trigger = {
			has_valid_civic = civic_machine_terminator
		}
	}

	option = {
		name = leviathans.98.a
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
		}
	}
}

# Traders Main Menu #1 (Initial)
country_event = {
	id = leviathans.100
	title = leviathans.100.name
	desc = leviathans.100a.desc
	desc = leviathans.100b.desc
	desc = leviathans.100c.desc
	desc = leviathans.100d.desc
	desc = leviathans.100e.desc
	desc = leviathans.100f.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_trader_window"
	force_open = yes

	picture_event_data = {
		portrait = event_target:traders
		room = enclave_trader_room
	}

	trigger = {
		from = {
			is_country_type = enclave
			has_country_flag = trader_enclave_country_1
		}
		NOT = { has_country_flag = attacked_xuracorp }
		NOT = { has_country_flag = trader_enclave_diplomacy_engaged }
	}

	immediate = {
		set_country_flag = trader_enclave_diplomacy_engaged
		FROM = { save_event_target_as = traders }
	}

	after = {
		hidden_effect = {
			remove_country_flag = trader_enclave_diplomacy_engaged
		}
	}

	option = {
		name = SCUM
		custom_gui = "enclave_trader_option"
		trigger = {
			has_valid_civic = civic_fanatic_purifiers
		}
		hidden_effect = {
			remove_country_flag = trader_enclave_diplomacy_engaged
		}
	}

	option = {
		name = TASTY
		custom_gui = "enclave_trader_option"
		trigger = {
			has_valid_civic = civic_hive_devouring_swarm
		}
		hidden_effect = {
			remove_country_flag = trader_enclave_diplomacy_engaged
		}
	}

	option = {
		name = EXTERMINATE
		custom_gui = "enclave_trader_option"
		trigger = {
			has_valid_civic = civic_machine_terminator
		}
		hidden_effect = {
			remove_country_flag = trader_enclave_diplomacy_engaged
		}
	}

	option = { # Strategic Resource
		name = leviathans.105.c
		custom_gui = "enclave_trader_option"
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
		}
		allow = {
			custom_tooltip = {
				fail_text = leviathans.105.c.sr2
				has_active_xuracorp_trade = no
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.131 }
		}
	}

	option = { # Hire Governor
		name = leviathans.105.z
		custom_gui = "enclave_trader_option"
		allow = {
			custom_tooltip = {
				text = leviathans.105.c.trust
				event_target:traders = {
					trust = {
						who = root
						value >= 50
					}
				}
			}
			custom_tooltip = {
				fail_text = already_hired_trader_governor
				NOR = {
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_1 }
						has_country_flag = hired_trader_governor_xur
					}
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_2 }
						has_country_flag = hired_trader_governor_rig
					}
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_3 }
						has_country_flag = hired_trader_governor_mut
					}
				}
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.125 }
		}
	}

	option = { # End Resource Deal
		name = leviathans.105.e
		custom_gui = "enclave_trader_option"
		trigger = {
			has_active_xuracorp_trade = yes
		}
		custom_tooltip = end_trade_1
		custom_tooltip = opinion-5
		hidden_effect = {
			remove_xuracorp_trades = yes
			event_target:traders = {
				add_trust = {
					who = root
					amount = -5
				}
			}
		}
		is_dialog_only = yes
		response_text = leviathans.105.e.response
	}

	option = {
		name = leviathans.105.d
		custom_gui = "enclave_trader_option"
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
		}
		default_hide_option = yes
		hidden_effect = {
			remove_country_flag = trader_enclave_diplomacy_engaged
		}
	}
}

# Traders Main Menu #2 (Initial)
country_event = {
	id = leviathans.103
	title = leviathans.103.name
	desc = leviathans.103a.desc
	desc = leviathans.103b.desc
	desc = leviathans.103c.desc
	desc = leviathans.103d.desc
	desc = leviathans.103e.desc
	desc = leviathans.103f.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_trader_window"
	force_open = yes

	picture_event_data = {
		portrait = event_target:traders
		room = enclave_trader_room
	}

	trigger = {
		from = {
			is_country_type = enclave
			has_country_flag = trader_enclave_country_2
		}
		NOT = { has_country_flag = trader_enclave_diplomacy_engaged }
		NOT = { has_country_flag = attacked_riggans }
	}

	immediate = {
		set_country_flag = trader_enclave_diplomacy_engaged
		FROM = { save_event_target_as = traders }
	}

	after = {
		hidden_effect = {
			remove_country_flag = trader_enclave_diplomacy_engaged
		}
	}

	option = {
		name = SCUM
		custom_gui = "enclave_trader_option"
		trigger = {
			has_valid_civic = civic_fanatic_purifiers
		}
	}

	option = {
		name = TASTY
		custom_gui = "enclave_trader_option"
		trigger = {
			has_valid_civic = civic_hive_devouring_swarm
		}
	}

	option = {
		name = EXTERMINATE
		custom_gui = "enclave_trader_option"
		trigger = {
			has_valid_civic = civic_machine_terminator
		}
	}

	option = { # Strategic Resource
		name = leviathans.105.c
		custom_gui = "enclave_trader_option"
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
		}
		allow = {
			custom_tooltip = {
				fail_text = leviathans.105.c.sr1
				has_active_riggan_trade = no
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.130 }
		}
	}

	option = { # Hire Governor
		name = leviathans.105.z
		custom_gui = "enclave_trader_option"
		allow = {
			custom_tooltip = {
				text = leviathans.105.c.trust
				event_target:traders = {
					trust = {
						who = root
						value >= 50
					}
				}
			}
			custom_tooltip = {
				fail_text = already_hired_trader_governor
				NOR = {
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_1 }
						has_country_flag = hired_trader_governor_xur
					}
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_2 }
						has_country_flag = hired_trader_governor_rig
					}
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_3 }
						has_country_flag = hired_trader_governor_mut
					}
				}
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.125 }
		}
	}

	option = { # End Resource Deal
		name = leviathans.105.e
		custom_gui = "enclave_trader_option"
		trigger = {
			has_active_riggan_trade = yes
		}
		custom_tooltip = end_trade_2
		custom_tooltip = opinion-5
		hidden_effect = {
			remove_riggan_trades = yes
			event_target:traders = {
				add_trust = {
					who = root
					amount = -5
				}
			}
		}
		is_dialog_only = yes
		response_text = leviathans.105.e.response
	}

	option = {
		name = leviathans.105.d
		custom_gui = "enclave_trader_option"
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
		}
		default_hide_option = yes
	}
}

# Traders Main Menu #3 (Initial)
country_event = {
	id = leviathans.104
	title = leviathans.104.name
	desc = leviathans.104a.desc
	desc = leviathans.104b.desc
	desc = leviathans.104c.desc
	desc = leviathans.104d.desc
	desc = leviathans.104e.desc
	desc = leviathans.104f.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_trader_window"
	force_open = yes

	picture_event_data = {
		portrait = event_target:traders
		room = enclave_trader_room
	}

	trigger = {
		from = {
			is_country_type = enclave
			has_country_flag = trader_enclave_country_3
		}
		NOT = { has_country_flag = trader_enclave_diplomacy_engaged }
		NOT = { has_country_flag = attacked_muutagans }
	}

	immediate = {
		set_country_flag = trader_enclave_diplomacy_engaged
		FROM = { save_event_target_as = traders }
	}

	after = {
		hidden_effect = {
			remove_country_flag = trader_enclave_diplomacy_engaged
		}
	}

	option = {
		name = SCUM
		custom_gui = "enclave_trader_option"
		trigger = {
			has_valid_civic = civic_fanatic_purifiers
		}
	}

	option = {
		name = TASTY
		custom_gui = "enclave_trader_option"
		trigger = {
			has_valid_civic = civic_hive_devouring_swarm
		}
	}

	option = {
		name = EXTERMINATE
		custom_gui = "enclave_trader_option"
		trigger = {
			has_valid_civic = civic_machine_terminator
		}
	}

	option = { # Strategic Resource
		name = leviathans.105.c
		custom_gui = "enclave_trader_option"
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
		}
		allow = {
			custom_tooltip = {
				fail_text = leviathans.105.c.sr3
				has_active_muutagan_trade = no
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.132 }
		}
	}

	option = { # End Resource Deal
		name = leviathans.105.e
		custom_gui = "enclave_trader_option"
		trigger = {
			has_active_muutagan_trade = yes
		}
		custom_tooltip = end_trade_3
		custom_tooltip = opinion-5
		hidden_effect = {
			remove_muutagan_trades = yes
			event_target:traders = {
				add_trust = {
					who = root
					amount = -5
				}
			}
		}
		is_dialog_only = yes
		response_text = leviathans.105.e.response
	}

	option = { # Hire Governor
		name = leviathans.105.z
		custom_gui = "enclave_trader_option"
		allow = {
			custom_tooltip = {
				text = leviathans.105.c.trust
				event_target:traders = {
					trust = {
						who = root
						value >= 50
					}
				}
			}
			custom_tooltip = {
				fail_text = already_hired_trader_governor
				NOR = {
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_1 }
						has_country_flag = hired_trader_governor_xur
					}
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_2 }
						has_country_flag = hired_trader_governor_rig
					}
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_3 }
						has_country_flag = hired_trader_governor_mut
					}
				}
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.125 }
		}
	}

	option = {
		name = leviathans.105.d
		custom_gui = "enclave_trader_option"
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
		}
		default_hide_option = yes
	}
}

# Traders Main Menu #1
country_event = {
	id = leviathans.105
	title = leviathans.100.name
	desc = leviathans.100a.desc
	desc = leviathans.100b.desc
	desc = leviathans.100c.desc
	desc = leviathans.100d.desc
	desc = leviathans.100e.desc
	desc = leviathans.100f.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_trader_window"

	picture_event_data = {
		portrait = event_target:traders
		room = enclave_trader_room
	}

	immediate = {
		set_country_flag = trader_enclave_diplomacy_engaged
	}

	after = {
		hidden_effect = {
			remove_country_flag = trader_enclave_diplomacy_engaged
		}
	}

	option = { # Strategic Resource
		name = leviathans.105.c
		custom_gui = "enclave_trader_option"
		allow = {
			custom_tooltip = {
				fail_text = leviathans.105.c.sr2
				has_active_xuracorp_trade = no
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.131 }
		}
	}

	option = { # Hire Governor
		name = leviathans.105.z
		custom_gui = "enclave_trader_option"
		allow = {
			custom_tooltip = {
				text = leviathans.105.c.trust
				event_target:traders = {
					trust = {
						who = root
						value >= 50
					}
				}
			}
			custom_tooltip = {
				fail_text = already_hired_trader_governor
				NOR = {
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_1 }
						has_country_flag = hired_trader_governor_xur
					}
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_2 }
						has_country_flag = hired_trader_governor_rig
					}
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_3 }
						has_country_flag = hired_trader_governor_mut
					}
				}
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.125 }
		}
	}

	option = { # End Resource Deal
		name = leviathans.105.e
		custom_gui = "enclave_trader_option"
		trigger = {
			has_active_xuracorp_trade = yes
		}
		custom_tooltip = end_trade_1
		custom_tooltip = opinion-5
		hidden_effect = {
			remove_xuracorp_trades = yes
			event_target:traders = {
				add_trust = {
					who = root
					amount = -5
				}
			}
		}
		is_dialog_only = yes
		response_text = leviathans.105.e.response
	}

	option = {
		name = leviathans.105.d
		default_hide_option = yes
		custom_gui = "enclave_trader_option"
		hidden_effect = {
			remove_country_flag = trader_enclave_diplomacy_engaged
		}
	}
}

# Traders Main Menu #2
country_event = {
	id = leviathans.106
	title = leviathans.103.name
	desc = leviathans.103a.desc
	desc = leviathans.103b.desc
	desc = leviathans.103c.desc
	desc = leviathans.103d.desc
	desc = leviathans.103e.desc
	desc = leviathans.103f.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_trader_window"

	picture_event_data = {
		portrait = event_target:traders
		room = enclave_trader_room
	}

	immediate = {
		set_country_flag = trader_enclave_diplomacy_engaged
	}

	after = {
		hidden_effect = {
			remove_country_flag = trader_enclave_diplomacy_engaged
		}
	}

	option = { # Strategic Resource
		name = leviathans.105.c
		custom_gui = "enclave_trader_option"
		allow = {
			custom_tooltip = {
				fail_text = leviathans.105.c.sr1
				has_active_riggan_trade = no
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.130 }
		}
	}

	option = { # Hire Governor
		name = leviathans.105.z
		custom_gui = "enclave_trader_option"
		allow = {
			custom_tooltip = {
				text = leviathans.105.c.trust
				event_target:traders = {
					trust = {
						who = root
						value >= 50
					}
				}
			}
			custom_tooltip = {
				fail_text = already_hired_trader_governor
				NOR = {
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_1 }
						has_country_flag = hired_trader_governor_xur
					}
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_2 }
						has_country_flag = hired_trader_governor_rig
					}
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_3 }
						has_country_flag = hired_trader_governor_mut
					}
				}
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.125 }
		}
	}

	option = { # End Resource Deal
		name = leviathans.105.e
		custom_gui = "enclave_trader_option"
		trigger = {
			has_active_riggan_trade = yes
		}
		custom_tooltip = end_trade_2
		custom_tooltip = opinion-5
		hidden_effect = {
			remove_riggan_trades = yes
			event_target:traders = {
				add_trust = {
					who = root
					amount = -5
				}
			}
		}
		is_dialog_only = yes
		response_text = leviathans.105.e.response
	}

	option = {
		name = leviathans.105.d
		default_hide_option = yes
		custom_gui = "enclave_trader_option"
		hidden_effect = {
			remove_country_flag = trader_enclave_diplomacy_engaged
		}
	}
}

# Traders Main Menu #3
country_event = {
	id = leviathans.107
	title = leviathans.104.name
	desc = leviathans.104a.desc
	desc = leviathans.104b.desc
	desc = leviathans.104c.desc
	desc = leviathans.104d.desc
	desc = leviathans.104e.desc
	desc = leviathans.104f.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_trader_window"

	picture_event_data = {
		portrait = event_target:traders
		room = enclave_trader_room
	}

	immediate = {
		set_country_flag = trader_enclave_diplomacy_engaged
	}

	after = {
		hidden_effect = {
			remove_country_flag = trader_enclave_diplomacy_engaged
		}
	}

	option = { # Strategic Resource
		name = leviathans.105.c
		custom_gui = "enclave_trader_option"
		allow = {
			custom_tooltip = {
				fail_text = leviathans.105.c.sr3
				has_active_muutagan_trade = no
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.132 }
		}
	}

	option = { # Hire Governor
		name = leviathans.105.z
		custom_gui = "enclave_trader_option"
		allow = {
			custom_tooltip = {
				text = leviathans.105.c.trust
				event_target:traders = {
					trust = {
						who = root
						value >= 50
					}
				}
			}
			custom_tooltip = {
				fail_text = already_hired_trader_governor
				NOR = {
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_1 }
						has_country_flag = hired_trader_governor_xur
					}
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_2 }
						has_country_flag = hired_trader_governor_rig
					}
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_3 }
						has_country_flag = hired_trader_governor_mut
					}
				}
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.125 }
		}
	}

	option = { # End Resource Deal
		name = leviathans.105.e
		custom_gui = "enclave_trader_option"
		trigger = {
			has_active_muutagan_trade = yes
		}
		custom_tooltip = end_trade_3
		custom_tooltip = opinion-5
		hidden_effect = {
			remove_muutagan_trades = yes
			event_target:traders = {
				add_trust = {
					who = root
					amount = -5
				}
			}
		}
		is_dialog_only = yes
		response_text = leviathans.105.e.response
	}

	option = {
		name = leviathans.105.d
		default_hide_option = yes
		custom_gui = "enclave_trader_option"
		hidden_effect = {
			remove_country_flag = trader_enclave_diplomacy_engaged
		}
	}
}

# Trader Opinion from Resource Deals
country_event = {
	id = leviathans.122
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		exists = event_target:traders
		OR = {
			AND = {
				event_target:traders = { has_country_flag = trader_enclave_country_1 }
				has_active_xuracorp_trade = yes
			}
			AND = {
				event_target:traders = { has_country_flag = trader_enclave_country_2 }
				has_active_riggan_trade = yes
			}
			AND = {
				event_target:traders = { has_country_flag = trader_enclave_country_3 }
				has_active_muutagan_trade = yes
			}
		}
	}

	immediate = {
		if = {
			limit = {
				OR = {
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_1 }
						OR = {
							has_modifier = enclave_trade_1_xur
							has_modifier = enclave_trade_2_xur
						}
					}
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_2 }
						OR = {
							has_modifier = enclave_trade_1_rig
							has_modifier = enclave_trade_2_rig
						}
					}
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_3 }
						OR = {
							has_modifier = enclave_trade_1_mut
							has_modifier = enclave_trade_2_mut
						}
					}
				}
			}
			event_target:traders = {
				add_trust = {
					who = root
					amount = 1
				}
			}
			country_event = { id = leviathans.122 days = 30 }
		}
		else_if = {
			limit = {
				OR = {
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_1 }
						OR = {
							has_modifier = enclave_trade_3_xur
							has_modifier = enclave_trade_4_xur
						}
					}
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_2 }
						OR = {
							has_modifier = enclave_trade_3_rig
							has_modifier = enclave_trade_4_rig
						}
					}
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_3 }
						OR = {
							has_modifier = enclave_trade_3_mut
							has_modifier = enclave_trade_4_mut
						}
					}
				}
			}
			event_target:traders = {
				add_trust = {
					who = root
					amount = 2
				}
			}
			country_event = { id = leviathans.122 days = 30 }
		}
		else_if = {
			limit = {
				OR = {
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_1 }
						has_modifier = enclave_trade_5_xur
					}
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_2 }
						has_modifier = enclave_trade_5_rig
					}
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_3 }
						has_modifier = enclave_trade_5_mut
					}
				}
			}
			event_target:traders = {
				add_trust = {
					who = root
					amount = 3
				}
			}
			country_event = { id = leviathans.122 days = 30 }
		}
	}
}

# Hire Governor
country_event = {
	id = leviathans.125
	title = leviathans.125.name.z1
	desc = leviathans.125.desc.z1

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_trader_window"

	picture_event_data = {
		portrait = event_target:traders
		room = enclave_trader_room
	}

	immediate = {
		set_country_flag = trader_enclave_diplomacy_engaged
	}

	option = {
		name = leviathans.125.z1
		custom_gui = "enclave_trader_option"
		allow = {
			resource_stockpile_compare = { resource = energy value >= 500 }
			custom_tooltip = {
				fail_text = already_hired_trader_governor
				NOR = {
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_1 }
						has_country_flag = hired_trader_governor_xur
					}
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_2 }
						has_country_flag = hired_trader_governor_rig
					}
					AND = {
						event_target:traders = { has_country_flag = trader_enclave_country_3 }
						has_country_flag = hired_trader_governor_mut
					}
				}
			}
		}
		add_resource = { energy = -500 }
		hidden_effect = {
			create_leader = {
				event_leader = yes
				class = governor
				species = event_target:traders.leader.species
				name = random
				skill = 5
				traits = {
					trait = leader_trait_enclave_trader
				}
				gender = indeterminable
				set_age = 100
				immortal = yes
				effect = {
					set_leader_flag = trader_leader
					owner = { set_country_flag = recruited_trader_leader }
				}
			}
			if = {
				limit = { event_target:traders = { has_country_flag = trader_enclave_country_1 } }
				set_country_flag = hired_trader_governor_xur
			}
			else_if = {
				limit = { event_target:traders = { has_country_flag = trader_enclave_country_2 } }
				set_country_flag = hired_trader_governor_rig
			}
			else_if = {
				limit = { event_target:traders = { has_country_flag = trader_enclave_country_3 } }
				set_country_flag = hired_trader_governor_mut
			}
			remove_country_flag = trader_enclave_diplomacy_engaged
			country_event = { id = leviathans.126 }
		}
		custom_tooltip = recruit_trader_leader
	}
	option = {
		name = leviathans.110.d
		custom_gui = "enclave_trader_option"
		hidden_effect = {
			remove_country_flag = trader_enclave_diplomacy_engaged
			if = {
				limit = { event_target:traders = { has_country_flag = trader_enclave_country_1 } }
				country_event = { id = leviathans.105 }
			}
			if = {
				limit = { event_target:traders = { has_country_flag = trader_enclave_country_2 } }
				country_event = { id = leviathans.106 }
			}
			if = {
				limit = { event_target:traders = { has_country_flag = trader_enclave_country_3 } }
				country_event = { id = leviathans.107 }
			}
		}
	}
	option = {
		name = leviathans.105.d
		default_hide_option = yes
		custom_gui = "enclave_trader_option"
		hidden_effect = {
			remove_country_flag = trader_enclave_diplomacy_engaged
		}
	}
}

# Hire Governor Reply Event
country_event = {
	id = leviathans.126
	title = leviathans.126.name
	desc = leviathans.126.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_trader_window"

	picture_event_data = {
		portrait = event_target:traders
		room = enclave_trader_room
	}

	immediate = {
		set_country_flag = trader_enclave_diplomacy_engaged
	}

	option = {
		name = leviathans.110.d
		custom_gui = "enclave_trader_option"
		hidden_effect = {
			remove_country_flag = trader_enclave_diplomacy_engaged
			if = {
				limit = { event_target:traders = { has_country_flag = trader_enclave_country_1 } }
				country_event = { id = leviathans.105 }
			}
			if = {
				limit = { event_target:traders = { has_country_flag = trader_enclave_country_2 } }
				country_event = { id = leviathans.106 }
			}
			if = {
				limit = { event_target:traders = { has_country_flag = trader_enclave_country_3 } }
				country_event = { id = leviathans.107 }
			}
		}
	}
	option = {
		name = GOODBYE
		custom_gui = "enclave_trader_option"
		default_hide_option = yes
		hidden_effect = {
			remove_country_flag = trader_enclave_diplomacy_engaged
		}
	}
}

# Strategic Resource 1
country_event = {
	id = leviathans.130
	title = leviathans.103.name
	desc = leviathans.130.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_trader_window"
	force_open = yes

	picture_event_data = {
		portrait = event_target:traders
		room = enclave_trader_room
	}

	immediate = {
		set_country_flag = trader_enclave_diplomacy_engaged
	}

	after = {
		hidden_effect = {
			remove_country_flag = trader_enclave_diplomacy_engaged
		}
	}

	option = {
		name = leviathans.130.a
		custom_gui = "enclave_trader_option"
		allow = {
			resource_stockpile_compare = { resource = energy value >= 500 }
			hidden_trigger = {
				NOT = { has_country_flag = attacked_riggans }
			}
		}
		#response_text = leviathans.130.a.reply
		add_resource = { energy = -500 }
		custom_tooltip = opinion5
		add_modifier = {
			modifier = enclave_trade_1_rig
			days = 3600
		}
		hidden_effect = {
			event_target:traders = {
				add_trust = {
					who = root
					amount = 5
				}
			}
			set_relation_flag = {
				who = event_target:traders
				flag = riggan_trade
			}
			country_event = { id = leviathans.135 days = 3600 }
			country_event = { id = leviathans.133 }
		}
	}
	option = {
		name = leviathans.130.b
		custom_gui = "enclave_trader_option"
		allow = {
			resource_stockpile_compare = { resource = energy value >= 1000 }
			hidden_trigger = {
				NOT = { has_country_flag = attacked_riggans }
			}
		}
		#response_text = leviathans.130.a.reply
		add_resource = { energy = -1000 }
		custom_tooltip = opinion10
		add_modifier = {
			modifier = enclave_trade_2_rig
			days = 3600
		}
		hidden_effect = {
			event_target:traders = {
				add_trust = {
					who = root
					amount = 10
				}
			}
			set_relation_flag = {
				who = event_target:traders
				flag = riggan_trade
			}
			country_event = { id = leviathans.135 days = 3600 }
			country_event = { id = leviathans.133 }
		}
	}
	option = {
		name = leviathans.130.c
		custom_gui = "enclave_trader_option"
		allow = {
			resource_stockpile_compare = { resource = energy value >= 1500 }
			hidden_trigger = {
				NOT = { has_country_flag = attacked_riggans }
			}
		}
		#response_text = leviathans.130.a.reply
		add_resource = { energy = -1500 }
		custom_tooltip = opinion15
		add_modifier = {
			modifier = enclave_trade_3_rig
			days = 3600
		}
		hidden_effect = {
			event_target:traders = {
				add_trust = {
					who = root
					amount = 15
				}
			}
			set_relation_flag = {
				who = event_target:traders
				flag = riggan_trade
			}
			country_event = { id = leviathans.135 days = 3600 }
			country_event = { id = leviathans.133 }
		}
	}
	option = {
		name = leviathans.130.d
		custom_gui = "enclave_trader_option"
		trigger = {
			NOT = { has_country_flag = attacked_riggans }
		}
		allow = {
			resource_stockpile_compare = { resource = energy value >= 2000 }
			custom_tooltip = {
				fail_text = riggan_deal_in_place
				NOR = {
					has_modifier = enclave_trade_1_rig
					has_modifier = enclave_trade_2_rig
					has_modifier = enclave_trade_3_rig
					has_modifier = enclave_trade_4_rig
					has_modifier = enclave_trade_5_rig
				}
			}
		}
		#response_text = leviathans.130.a.reply
		add_resource = { energy = -2000 }
		custom_tooltip = opinion20
		add_modifier = {
			modifier = enclave_trade_4_rig
			days = 3600
		}
		hidden_effect = {
			event_target:traders = {
				add_trust = {
					who = root
					amount = 20
				}
			}
			set_relation_flag = {
				who = event_target:traders
				flag = riggan_trade
			}
			country_event = { id = leviathans.135 days = 3600 }
			country_event = { id = leviathans.133 }
		}
	}
	option = {
		name = leviathans.130.e
		custom_gui = "enclave_trader_option"
		trigger = {
			NOT = { has_country_flag = attacked_riggans }
		}
		allow = {
			resource_stockpile_compare = { resource = energy value >= 2500 }
			custom_tooltip = {
				fail_text = riggan_deal_in_place
				NOR = {
					has_modifier = enclave_trade_1_rig
					has_modifier = enclave_trade_2_rig
					has_modifier = enclave_trade_3_rig
					has_modifier = enclave_trade_4_rig
					has_modifier = enclave_trade_5_rig
				}
			}
		}
		#response_text = leviathans.130.a.reply
		add_resource = { energy = -2500 }
		custom_tooltip = opinion25
		add_modifier = {
			modifier = enclave_trade_5_rig
			days = 3600
		}
		hidden_effect = {
			event_target:traders = {
				add_trust = {
					who = root
					amount = 25
				}
			}
			set_relation_flag = {
				who = event_target:traders
				flag = riggan_trade
			}
			country_event = { id = leviathans.135 days = 3600 }
			country_event = { id = leviathans.133 }
		}
	}
	option = {
		name = leviathans.110.d
		custom_gui = "enclave_trader_option"
		hidden_effect = {
			if = {
				limit = { event_target:traders = { has_country_flag = trader_enclave_country_1 } }
				country_event = { id = leviathans.105 }
			}
			if = {
				limit = { event_target:traders = { has_country_flag = trader_enclave_country_2 } }
				country_event = { id = leviathans.106 }
			}
			if = {
				limit = { event_target:traders = { has_country_flag = trader_enclave_country_3 } }
				country_event = { id = leviathans.107 }
			}
		}
	}
	option = {
		name = leviathans.110.e
		custom_gui = "enclave_trader_option"
		default_hide_option = yes
		hidden_effect = {
			remove_country_flag = trader_enclave_diplomacy_engaged
		}
	}
}

# Strategic Resource 2
country_event = {
	id = leviathans.131
	title = leviathans.100.name
	desc = leviathans.131.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_trader_window"
	force_open = yes

	picture_event_data = {
		portrait = event_target:traders
		room = enclave_trader_room
	}

	immediate = {
		set_country_flag = trader_enclave_diplomacy_engaged
	}

	after = {
		hidden_effect = {
			remove_country_flag = trader_enclave_diplomacy_engaged
		}
	}

	option = {
		name = leviathans.131.a
		custom_gui = "enclave_trader_option"
		allow = {
			resource_stockpile_compare = { resource = energy value >= 500 }
			hidden_trigger = {
				NOT = { has_country_flag = attacked_xuracorp }
			}
		}
		#response_text = leviathans.131.a.reply
		add_resource = { energy = -500 }
		custom_tooltip = opinion5
		add_modifier = {
			modifier = enclave_trade_1_xur
			days = 3600
		}
		hidden_effect = {
			event_target:traders = {
				add_trust = {
					who = root
					amount = 5
				}
			}
			set_relation_flag = {
				who = event_target:traders
				flag = xuracorp_trade
			}
			country_event = { id = leviathans.136 days = 3600 }
			country_event = { id = leviathans.133 }
		}
	}
	option = {
		name = leviathans.131.b
		custom_gui = "enclave_trader_option"
		allow = {
			resource_stockpile_compare = { resource = energy value >= 1000 }
			hidden_trigger = {
				NOT = { has_country_flag = attacked_xuracorp }
			}
		}
		#response_text = leviathans.131.a.reply
		add_resource = { energy = -1000 }
		custom_tooltip = opinion10
		add_modifier = {
			modifier = enclave_trade_2_xur
			days = 3600
		}
		hidden_effect = {
			event_target:traders = {
				add_trust = {
					who = root
					amount = 10
				}
			}
			set_relation_flag = {
				who = event_target:traders
				flag = xuracorp_trade
			}
			country_event = { id = leviathans.136 days = 3600 }
			country_event = { id = leviathans.133 }
		}
	}
	option = {
		name = leviathans.131.c
		custom_gui = "enclave_trader_option"
		allow = {
			resource_stockpile_compare = { resource = energy value >= 1500 }
			hidden_trigger = {
				NOT = { has_country_flag = attacked_xuracorp }
			}
		}
		#response_text = leviathans.131.a.reply
		add_resource = { energy = -1500 }
		custom_tooltip = opinion15
		add_modifier = {
			modifier = enclave_trade_3_xur
			days = 3600
		}
		hidden_effect = {
			event_target:traders = {
				add_trust = {
					who = root
					amount = 15
				}
			}
			set_relation_flag = {
				who = event_target:traders
				flag = xuracorp_trade
			}
			country_event = { id = leviathans.136 days = 3600 }
			country_event = { id = leviathans.133 }
		}
	}
	option = {
		name = leviathans.131.d
		custom_gui = "enclave_trader_option"
		trigger = {
			NOT = { has_country_flag = attacked_xuracorp }
		}
		allow = {
			resource_stockpile_compare = { resource = energy value >= 2000 }
			custom_tooltip = {
				fail_text = xuracorp_deal_in_place
				NOR = {
					has_modifier = enclave_trade_1_xur
					has_modifier = enclave_trade_2_xur
					has_modifier = enclave_trade_3_xur
					has_modifier = enclave_trade_4_xur
					has_modifier = enclave_trade_5_xur
				}
			}
		}
		#response_text = leviathans.131.a.reply
		add_resource = { energy = -2000 }
		custom_tooltip = opinion20
		add_modifier = {
			modifier = enclave_trade_4_xur
			days = 3600
		}
		hidden_effect = {
			event_target:traders = {
				add_trust = {
					who = root
					amount = 20
				}
			}
			set_relation_flag = {
				who = event_target:traders
				flag = xuracorp_trade
			}
			country_event = { id = leviathans.136 days = 3600 }
			country_event = { id = leviathans.133 }
		}
	}
	option = {
		name = leviathans.131.e
		custom_gui = "enclave_trader_option"
		trigger = {
			NOT = { has_country_flag = attacked_xuracorp }
		}
		allow = {
			resource_stockpile_compare = { resource = energy value >= 2500 }
			custom_tooltip = {
				fail_text = xuracorp_deal_in_place
				NOR = {
					has_modifier = enclave_trade_1_xur
					has_modifier = enclave_trade_2_xur
					has_modifier = enclave_trade_3_xur
					has_modifier = enclave_trade_4_xur
					has_modifier = enclave_trade_5_xur
				}
			}
		}
		#response_text = leviathans.131.a.reply
		add_resource = { energy = -2500 }
		custom_tooltip = opinion25
		add_modifier = {
			modifier = enclave_trade_5_xur
			days = 3600
		}
		hidden_effect = {
			event_target:traders = {
				add_trust = {
					who = root
					amount = 25
				}
			}
			set_relation_flag = {
				who = event_target:traders
				flag = xuracorp_trade
			}
			country_event = { id = leviathans.136 days = 3600 }
			country_event = { id = leviathans.133 }
		}
	}
	option = {
		name = leviathans.110.d
		custom_gui = "enclave_trader_option"
		hidden_effect = {
			if = {
				limit = { event_target:traders = { has_country_flag = trader_enclave_country_1 } }
				country_event = { id = leviathans.105 }
			}
			if = {
				limit = { event_target:traders = { has_country_flag = trader_enclave_country_2 } }
				country_event = { id = leviathans.106 }
			}
			if = {
				limit = { event_target:traders = { has_country_flag = trader_enclave_country_3 } }
				country_event = { id = leviathans.107 }
			}
		}
	}
	option = {
		name = leviathans.110.e
		custom_gui = "enclave_trader_option"
		default_hide_option = yes
		hidden_effect = {
			remove_country_flag = trader_enclave_diplomacy_engaged
		}
	}
}

# Strategic Resource 3
country_event = {
	id = leviathans.132
	title = leviathans.104.name
	desc = leviathans.132.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_trader_window"
	force_open = yes

	picture_event_data = {
		portrait = event_target:traders
		room = enclave_trader_room
	}

	immediate = {
		set_country_flag = trader_enclave_diplomacy_engaged
	}

	after = {
		hidden_effect = {
			remove_country_flag = trader_enclave_diplomacy_engaged
		}
	}

	option = {
		name = leviathans.132.a
		custom_gui = "enclave_trader_option"
		allow = {
			resource_stockpile_compare = { resource = energy value >= 500 }
			hidden_trigger = {
				NOT = { has_country_flag = attacked_muutagans }
			}
		}
		#response_text = leviathans.132.a.reply
		add_resource = { energy = -500 }
		custom_tooltip = opinion5
		add_modifier = {
			modifier = enclave_trade_1_mut
			days = 3600
		}
		hidden_effect = {
			event_target:traders = {
				add_trust = {
					who = root
					amount = 5
				}
			}
			set_relation_flag = {
				who = event_target:traders
				flag = muutagan_trade
			}
			country_event = { id = leviathans.137 days = 3600 }
			country_event = { id = leviathans.133 }
		}
	}
	option = {
		name = leviathans.132.b
		custom_gui = "enclave_trader_option"
		allow = {
			resource_stockpile_compare = { resource = energy value >= 1000 }
			hidden_trigger = {
				NOT = { has_country_flag = attacked_muutagans }
			}
		}
		#response_text = leviathans.132.a.reply
		add_resource = { energy = -1000 }
		custom_tooltip = opinion10
		add_modifier = {
			modifier = enclave_trade_2_mut
			days = 3600
		}
		hidden_effect = {
			event_target:traders = {
				add_trust = {
					who = root
					amount = 10
				}
			}
			set_relation_flag = {
				who = event_target:traders
				flag = muutagan_trade
			}
			country_event = { id = leviathans.137 days = 3600 }
			country_event = { id = leviathans.133 }
		}
	}
	option = {
		name = leviathans.132.c
		custom_gui = "enclave_trader_option"
		allow = {
			resource_stockpile_compare = { resource = energy value >= 1500 }
			hidden_trigger = {
				NOT = { has_country_flag = attacked_muutagans }
			}
		}
		#response_text = leviathans.132.a.reply
		add_resource = { energy = -1500 }
		custom_tooltip = opinion15
		add_modifier = {
			modifier = enclave_trade_3_mut
			days = 3600
		}
		hidden_effect = {
			event_target:traders = {
				add_trust = {
					who = root
					amount = 15
				}
			}
			set_relation_flag = {
				who = event_target:traders
				flag = muutagan_trade
			}
			country_event = { id = leviathans.137 days = 3600 }
			country_event = { id = leviathans.133 }
		}
	}
	option = {
		name = leviathans.132.d
		custom_gui = "enclave_trader_option"
		trigger = {
			NOT = { has_country_flag = attacked_muutagans }
		}
		allow = {
			resource_stockpile_compare = { resource = energy value >= 2000 }
			custom_tooltip = {
				fail_text = muutagan_deal_in_place
				NOR = {
					has_modifier = enclave_trade_1_mut
					has_modifier = enclave_trade_2_mut
					has_modifier = enclave_trade_3_mut
					has_modifier = enclave_trade_4_mut
					has_modifier = enclave_trade_5_mut
				}
			}
		}
		#response_text = leviathans.132.a.reply
		add_resource = { energy = -2000 }
		custom_tooltip = opinion20
		add_modifier = {
			modifier = enclave_trade_4_mut
			days = 3600
		}
		hidden_effect = {
			event_target:traders = {
				add_trust = {
					who = root
					amount = 20
				}
			}
			set_relation_flag = {
				who = event_target:traders
				flag = muutagan_trade
			}
			country_event = { id = leviathans.137 days = 3600 }
			country_event = { id = leviathans.133 }
		}
	}
	option = {
		name = leviathans.132.e
		custom_gui = "enclave_trader_option"
		trigger = {
			NOT = { has_country_flag = attacked_muutagans }
		}
		allow = {
			resource_stockpile_compare = { resource = energy value >= 2500 }
			custom_tooltip = {
				fail_text = muutagan_deal_in_place
				NOR = {
					has_modifier = enclave_trade_1_mut
					has_modifier = enclave_trade_2_mut
					has_modifier = enclave_trade_3_mut
					has_modifier = enclave_trade_4_mut
					has_modifier = enclave_trade_5_mut
				}
			}
		}
		#response_text = leviathans.132.a.reply
		add_resource = { energy = -2500 }
		custom_tooltip = opinion25
		add_modifier = {
			modifier = enclave_trade_5_mut
			days = 3600
		}
		hidden_effect = {
			event_target:traders = {
				add_trust = {
					who = root
					amount = 25
				}
			}
			set_relation_flag = {
				who = event_target:traders
				flag = muutagan_trade
			}
			country_event = { id = leviathans.137 days = 3600 }
			country_event = { id = leviathans.133 }
		}
	}
	option = {
		name = leviathans.110.d
		custom_gui = "enclave_trader_option"
		hidden_effect = {
			if = {
				limit = { event_target:traders = { has_country_flag = trader_enclave_country_1 } }
				country_event = { id = leviathans.105 }
			}
			if = {
				limit = { event_target:traders = { has_country_flag = trader_enclave_country_2 } }
				country_event = { id = leviathans.106 }
			}
			if = {
				limit = { event_target:traders = { has_country_flag = trader_enclave_country_3 } }
				country_event = { id = leviathans.107 }
			}
		}
	}
	option = {
		name = leviathans.110.e
		custom_gui = "enclave_trader_option"
		default_hide_option = yes
		hidden_effect = {
			remove_country_flag = trader_enclave_diplomacy_engaged
		}
	}
}

# Strategic Resource Reply Event
country_event = {
	id = leviathans.133
	title = leviathans.133.name
	desc = {
		text = leviathans.131.a.reply
		trigger = {
			event_target:traders = {
				has_country_flag = trader_enclave_country_1
			}
		}
	}
	desc = {
		text = leviathans.130.a.reply
		trigger = {
			event_target:traders = {
				has_country_flag = trader_enclave_country_2
			}
		}
	}
	desc = {
		text = leviathans.132.a.reply
		trigger = {
			event_target:traders = {
				has_country_flag = trader_enclave_country_3
			}
		}
	}

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_trader_window"
	force_open = yes

	picture_event_data = {
		portrait = event_target:traders
		room = enclave_trader_room
	}

	immediate = {
		set_country_flag = trader_enclave_diplomacy_engaged
	}

	option = {
		name = leviathans.110.d
		custom_gui = "enclave_trader_option"
		hidden_effect = {
			remove_country_flag = trader_enclave_diplomacy_engaged
			if = {
				limit = { event_target:traders = { has_country_flag = trader_enclave_country_1 } }
				country_event = { id = leviathans.105 }
			}
			if = {
				limit = { event_target:traders = { has_country_flag = trader_enclave_country_2 } }
				country_event = { id = leviathans.106 }
			}
			if = {
				limit = { event_target:traders = { has_country_flag = trader_enclave_country_3 } }
				country_event = { id = leviathans.107 }
			}
		}
	}
	option = {
		name = GOODBYE
		custom_gui = "enclave_trader_option"
		default_hide_option = yes
		hidden_effect = {
			remove_country_flag = trader_enclave_diplomacy_engaged
		}
	}
}

# Remove Riggan Trade Relation Flag (HIDDEN)
country_event = {
	id = leviathans.135
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		exists = event_target:traders
	}

	immediate = {
		remove_relation_flag = {
			who = event_target:traders
			flag = riggan_trade
		}
		country_event = { id = leviathans.151 }
	}
}

## Remove XuraCorp Trade Relation Flag (HIDDEN)
country_event = {
	id = leviathans.136
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		exists = event_target:traders
	}

	immediate = {
		remove_relation_flag = {
			who = event_target:traders
			flag = xuracorp_trade
		}
		country_event = { id = leviathans.150 }
	}
}

## Remove Muutagan Trade Relation Flag (HIDDEN)
country_event = {
	id = leviathans.137
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		exists = event_target:traders
	}

	immediate = {
		remove_relation_flag = {
			who = event_target:traders
			flag = muutagan_trade
		}
		country_event = { id = leviathans.152 }
	}
}

# Port
country_event = {
	id = leviathans.101
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		random_owned_ship = {
			solar_system = { save_event_target_as = trader_system }
		}
		from = {
			country_event = { id = leviathans.102 }
		}
	}
}

# Trader Introduction
country_event = {
	id = leviathans.102
	title = leviathans.102.name

	desc = {
		text = leviathans.102a.desc
		trigger = {
			FROM = { has_country_flag = trader_enclave_country_1 }
		}
	}
	desc = {
		text = leviathans.102b.desc
		trigger = {
			FROM = { has_country_flag = trader_enclave_country_2 }
		}
	}
	desc = {
		text = leviathans.102c.desc
		trigger = {
			FROM = { has_country_flag = trader_enclave_country_3 }
		}
	}

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_trader_window"

	picture_event_data = {
		portrait = from
		room = enclave_trader_room
	}

	option = {
		name = SCUM
		trigger = {
			has_valid_civic = civic_fanatic_purifiers
		}
		custom_gui = "enclave_trader_option"
	}

	option = {
		name = TASTY
		trigger = {
			has_valid_civic = civic_hive_devouring_swarm
		}
		custom_gui = "enclave_trader_option"
	}

	option = {
		name = EXTERMINATE
		trigger = {
			has_valid_civic = civic_machine_terminator
		}
		custom_gui = "enclave_trader_option"
	}

	option = {
		name = leviathans.502.a
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
		}
		custom_gui = "enclave_trader_option"
	}
}

# Trader Destroyed (HIDDEN)
country_event = {
	id = leviathans.140
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		is_country_type = enclave
		has_country_flag = trader_enclave_country
		FROMFROM = {
			is_ship_size = enclave_station
		}
	}

	immediate = {
		FROMFROM = {
			solar_system = { save_event_target_as = trader_system }
		}
		FROM = {
			country_event = { id = leviathans.141 }
			save_event_target_as = trader_destroyer
		}
		every_country = {
			limit = {
				is_country_type = default
				has_communications = ROOT
				NOT = { is_country = event_target:trader_destroyer }
			}
			if = {
				limit = {
					ROOT = { has_country_flag = trader_enclave_country_1 }
				}
				country_event = { id = leviathans.142 }
			}
			if = {
				limit = {
					ROOT = { has_country_flag = trader_enclave_country_2 }
				}
				country_event = { id = leviathans.143 }
			}
			if = {
				limit = {
					ROOT = { has_country_flag = trader_enclave_country_3 }
				}
				country_event = { id = leviathans.144 }
			}
		}
		random_playable_country = {
			if = {
				limit = {
					ROOT = { has_country_flag = trader_enclave_country_1 }
				}
				observer_event = { id = observer.8 }
			}
			if = {
				limit = {
					ROOT = { has_country_flag = trader_enclave_country_2 }
				}
				observer_event = { id = observer.9 }
			}
			if = {
				limit = {
					ROOT = { has_country_flag = trader_enclave_country_3 }
				}
				observer_event = { id = observer.10 }
			}
		}
	}
}

# Any Trader Destroyed (Destroyer)
country_event = {
	id = leviathans.141
	title = "leviathans.141"
	desc = "leviathans.141.desc"
	picture = GFX_evt_space_debris
	location = event_target:trader_system
	show_sound = event_ship_bridge

	is_triggered_only = yes

	immediate = {
		set_country_flag = destroyed_trader
		every_country = {
			limit = {
				is_country_type = default
				NOR = {
					is_same_value = root
					has_valid_civic = civic_fanatic_purifiers
					has_valid_civic = civic_hive_devouring_swarm
					has_valid_civic = civic_machine_terminator
				}
			}
			add_opinion_modifier = {
				who = root
				modifier = opinion_destroyed_trader
			}
		}
		if = {
			limit = { FROM = { has_country_flag = trader_enclave_country_1 } }
			remove_xuracorp_trades = yes
			remove_relation_flag = {
				who = FROM
				flag = xuracorp_trade
			}
		}
		else_if = {
			limit = { FROM = { has_country_flag = trader_enclave_country_2 } }
			remove_riggan_trades = yes
			remove_relation_flag = {
				who = FROM
				flag = riggan_trade
			}
		}
		else_if = {
			limit = { FROM = { has_country_flag = trader_enclave_country_3 } }
			remove_muutagan_trades = yes
			remove_relation_flag = {
				who = FROM
				flag = muutagan_trade
			}
		}
	}

	option = {
		name = EXCELLENT
		add_resource = {
			minerals = 2000
			energy = 2000
		}
	}
}

# XuraCorp Destroyed
country_event = {
	id = leviathans.142
	title = "leviathans.141"
	desc = {
		text = leviathans.142.a.desc
		trigger = {
			NOT = {
				has_relation_flag = {
					who = FROM
					flag = xuracorp_trade
				}
			}
			has_communications = event_target:trader_destroyer
		}
	}
	desc = {
		text = leviathans.142.b.desc
		trigger = {
			NOT = {
				has_relation_flag = {
					who = FROM
					flag = xuracorp_trade
				}
			}
			NOT = { has_communications = event_target:trader_destroyer }
		}
	}
	desc = {
		text = leviathans.142.c.desc
		trigger = {
			has_relation_flag = {
				who = FROM
				flag = xuracorp_trade
			}
			has_communications = event_target:trader_destroyer
		}
	}
	desc = {
		text = leviathans.142.d.desc
		trigger = {
			has_relation_flag = {
				who = FROM
				flag = xuracorp_trade
			}
			NOT = { has_communications = event_target:trader_destroyer }
		}
	}
	picture = GFX_evt_exploding_ship
	location = event_target:trader_system
	show_sound = event_ship_explosion

	is_triggered_only = yes

	immediate = {
		set_global_flag = xuracorp_destroyed
		remove_xuracorp_trades = yes
		remove_relation_flag = {
			who = FROM
			flag = xuracorp_trade
		}
	}

	option = {
		name = "leviathans.142.a"
	}
}

# Riggans Destroyed
country_event = {
	id = leviathans.143
	title = "leviathans.141"
	desc = {
		text = leviathans.143.a.desc
		trigger = {
			NOT = {
				has_relation_flag = {
					who = FROM
					flag = riggan_trade
				}
			}
			has_communications = event_target:trader_destroyer
		}
	}
	desc = {
		text = leviathans.143.b.desc
		trigger = {
			NOT = {
				has_relation_flag = {
					who = FROM
					flag = riggan_trade
				}
			}
			NOT = { has_communications = event_target:trader_destroyer }
		}
	}
	desc = {
		text = leviathans.143.c.desc
		trigger = {
			has_relation_flag = {
				who = FROM
				flag = riggan_trade
			}
			has_communications = event_target:trader_destroyer
		}
	}
	desc = {
		text = leviathans.143.d.desc
		trigger = {
			has_relation_flag = {
				who = FROM
				flag = riggan_trade
			}
			NOT = { has_communications = event_target:trader_destroyer }
		}
	}
	picture = GFX_evt_exploding_ship
	location = event_target:trader_system
	show_sound = event_ship_explosion

	is_triggered_only = yes

	immediate = {
		set_global_flag = riggans_destroyed
		remove_riggan_trades = yes
		remove_relation_flag = {
			who = FROM
			flag = riggan_trade
		}
	}

	option = {
		name = "leviathans.143.a"
	}
}

# Muutagans Destroyed
country_event = {
	id = leviathans.144
	title = "leviathans.141"
	desc = {
		text = leviathans.144.a.desc
		trigger = {
			NOT = {
				has_relation_flag = {
					who = FROM
					flag = muutagan_trade
				}
			}
			has_communications = event_target:trader_destroyer
		}
	}
	desc = {
		text = leviathans.144.b.desc
		trigger = {
			NOT = {
				has_relation_flag = {
					who = FROM
					flag = muutagan_trade
				}
			}
			NOT = { has_communications = event_target:trader_destroyer }
		}
	}
	desc = {
		text = leviathans.144.c.desc
		trigger = {
			has_relation_flag = {
				who = FROM
				flag = muutagan_trade
			}
			has_communications = event_target:trader_destroyer
		}
	}
	desc = {
		text = leviathans.144.d.desc
		trigger = {
			has_relation_flag = {
				who = FROM
				flag = muutagan_trade
			}
			NOT = { has_communications = event_target:trader_destroyer }
		}
	}
	picture = GFX_evt_exploding_ship
	location = event_target:trader_system
	show_sound = event_ship_explosion

	is_triggered_only = yes

	immediate = {
		set_global_flag = muutagans_destroyed
		remove_muutagan_trades = yes
		remove_relation_flag = {
			who = FROM
			flag = muutagan_trade
		}
	}

	option = {
		name = "leviathans.144.a"
	}
}

# Continue Trade? (XuraCorp)
country_event = {
	id = leviathans.150
	title = leviathans.100.name
	desc = leviathans.150.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_trader_window"

	picture_event_data = {
		portrait = event_target:traders
		room = enclave_trader_room
	}

	trigger = {
		NOR = {
			has_global_flag = xuracorp_destroyed
			has_country_flag = attacked_xuracorp
		}
	}


	option = {
		name = leviathans.150.a
		custom_gui = "enclave_trader_option"
		hidden_effect = {
			country_event = { id = leviathans.131 }
		}
	}
	option = {
		name = leviathans.150.b
		custom_gui = "enclave_trader_option"
	}
}

# Continue Trade? (Riggans)
country_event = {
	id = leviathans.151
	title = leviathans.103.name
	desc = leviathans.151.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_trader_window"

	picture_event_data = {
		portrait = event_target:traders
		room = enclave_trader_room
	}

	trigger = {
		NOR = {
			has_global_flag = riggans_destroyed
			has_country_flag = attacked_riggans
		}
	}

	option = {
		name = leviathans.151.a
		custom_gui = "enclave_trader_option"
		hidden_effect = {
			country_event = { id = leviathans.130 }
		}
	}
	option = {
		name = leviathans.151.b
		custom_gui = "enclave_trader_option"
	}
}

# Continue Trade? (Muutagans)
country_event = {
	id = leviathans.152
	title = leviathans.104.name
	desc = leviathans.152.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_trader_window"

	picture_event_data = {
		portrait = event_target:traders
		room = enclave_trader_room
	}

	trigger = {
		NOR = {
			has_global_flag = muutagans_destroyed
			has_country_flag = attacked_muutagans
		}
	}


	option = {
		name = leviathans.152.a
		custom_gui = "enclave_trader_option"
		hidden_effect = {
			country_event = { id = leviathans.132 }
		}
	}
	option = {
		name = leviathans.152.b
		custom_gui = "enclave_trader_option"
	}
}

# Attacked XuraCorp (HIDDEN)
country_event = {
	id = leviathans.155
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		is_country_type = default
		FROM = { has_country_flag = trader_enclave_country_1 }
	}

	immediate = {
		FROM = {
			save_event_target_as = traders
			add_trust = {
				who = ROOT
				amount = -100
			}
		}
		set_country_flag = attacked_xuracorp
		if = {
			limit = {
				has_active_xuracorp_trade = yes
			}
			remove_xuracorp_trades = yes
			remove_relation_flag = {
				who = FROM
				flag = xuracorp_trade
			}
			country_event = { id = leviathans.156 }
		}
	}
}

# Attacked XuraCorp - Trade Agreement Terminated
country_event = {
	id = leviathans.156
	title = leviathans.100.name
	desc = leviathans.156.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_trader_window"

	picture_event_data = {
		portrait = event_target:traders
		room = enclave_trader_room
	}

	option = {
		name = leviathans.156.a
		custom_gui = "enclave_trader_option"
	}
}

# Attacked XuraCorp - Refuses Communications
country_event = {
	id = leviathans.157
	title = leviathans.100.name
	desc = leviathans.157a.desc
	desc = leviathans.157b.desc
	desc = leviathans.157c.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_trader_window"
	force_open = yes

	picture_event_data = {
		portrait = event_target:traders
		room = enclave_trader_room
	}

	trigger = {
		FROM = {
			is_country_type = enclave
			has_country_flag = trader_enclave_country_1
		}
		has_country_flag = attacked_xuracorp
		NOT = { has_country_flag = trader_enclave_diplomacy_engaged }
	}

	immediate = {
		set_country_flag = trader_enclave_diplomacy_engaged
		FROM = { save_event_target_as = traders }
	}

	after = {
		hidden_effect = {
			remove_country_flag = trader_enclave_diplomacy_engaged
		}
	}

	option = {
		name = SCUM
		trigger = {
			has_valid_civic = civic_fanatic_purifiers
		}
		custom_gui = "enclave_trader_option"
	}

	option = {
		name = TASTY
		trigger = {
			has_valid_civic = civic_hive_devouring_swarm
		}
		custom_gui = "enclave_trader_option"
	}

	option = {
		name = EXTERMINATE
		trigger = {
			has_valid_civic = civic_machine_terminator
		}
		custom_gui = "enclave_trader_option"
	}

	option = {
		name = leviathans.156.a
		custom_gui = "enclave_trader_option"
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
		}
		default_hide_option = yes
	}
}

# Attacked Riggans (HIDDEN)
country_event = {
	id = leviathans.158
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		is_country_type = default
		FROM = { has_country_flag = trader_enclave_country_2 }
	}

	immediate = {
		FROM = {
			save_event_target_as = traders
			add_trust = {
				who = ROOT
				amount = -100
			}
		}
		set_country_flag = attacked_riggans
		if = {
			limit = {
				has_active_riggan_trade = yes
			}
			remove_riggan_trades = yes
			remove_relation_flag = {
				who = FROM
				flag = riggan_trade
			}
			country_event = { id = leviathans.159}
		}
	}
}

# Attacked Riggans - Trade Agreement Terminated
country_event = {
	id = leviathans.159
	title = leviathans.103.name
	desc = leviathans.159.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_trader_window"

	picture_event_data = {
		portrait = event_target:traders
		room = enclave_trader_room
	}

	option = {
		name = leviathans.156.a
		custom_gui = "enclave_trader_option"
	}
}

# Attacked Riggans - Refuses Communications
country_event = {
	id = leviathans.160
	title = leviathans.103.name
	desc = leviathans.160a.desc
	desc = leviathans.160b.desc
	desc = leviathans.160c.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_trader_window"
	force_open = yes

	picture_event_data = {
		portrait = event_target:traders
		room = enclave_trader_room
	}

	trigger = {
		FROM = {
			is_country_type = enclave
			has_country_flag = trader_enclave_country_2
		}
		has_country_flag = attacked_riggans
		NOT = { has_country_flag = trader_enclave_diplomacy_engaged }
	}

	immediate = {
		set_country_flag = trader_enclave_diplomacy_engaged
		FROM = { save_event_target_as = traders }
	}

	after = {
		hidden_effect = {
			remove_country_flag = trader_enclave_diplomacy_engaged
		}
	}

	option = {
		name = SCUM
		trigger = {
			has_valid_civic = civic_fanatic_purifiers
		}
		custom_gui = "enclave_trader_option"
	}

	option = {
		name = TASTY
		trigger = {
			has_valid_civic = civic_hive_devouring_swarm
		}
		custom_gui = "enclave_trader_option"
	}

	option = {
		name = EXTERMINATE
		trigger = {
			has_valid_civic = civic_machine_terminator
		}
		custom_gui = "enclave_trader_option"
	}

	option = {
		name = leviathans.156.a
		custom_gui = "enclave_trader_option"
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
		}
		default_hide_option = yes
	}
}

# Attacked Muutagans (HIDDEN)
country_event = {
	id = leviathans.161
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		is_country_type = default
		FROM = { has_country_flag = trader_enclave_country_3 }
	}

	immediate = {
		FROM = {
			save_event_target_as = traders
			add_trust = {
				who = ROOT
				amount = -100
			}
		}
		set_country_flag = attacked_muutagans
		if = {
			limit = {
				has_active_muutagan_trade = yes
			}
			remove_muutagan_trades = yes
			remove_relation_flag = {
				who = FROM
				flag = muutagan_trade
			}
			country_event = { id = leviathans.162 }
		}
	}
}

# Attacked Muutagans - Trade Agreement Terminated
country_event = {
	id = leviathans.162
	title = leviathans.104.name
	desc = leviathans.162.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_trader_window"

	picture_event_data = {
		portrait = event_target:traders
		room = enclave_trader_room
	}

	option = {
		name = leviathans.156.a
		custom_gui = "enclave_trader_option"
	}
}

# Attacked Muutagans - Refuses Communications
country_event = {
	id = leviathans.163
	title = leviathans.104.name
	desc = leviathans.163a.desc
	desc = leviathans.163b.desc
	desc = leviathans.163c.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_trader_window"
	force_open = yes

	picture_event_data = {
		portrait = event_target:traders
		room = enclave_trader_room
	}

	trigger = {
		FROM = {
			is_country_type = enclave
			has_country_flag = trader_enclave_country_3
		}
		has_country_flag = attacked_muutagans
		NOT = { has_country_flag = trader_enclave_diplomacy_engaged }
	}

	immediate = {
		set_country_flag = trader_enclave_diplomacy_engaged
		FROM = { save_event_target_as = traders }
	}

	after = {
		hidden_effect = {
			remove_country_flag = trader_enclave_diplomacy_engaged
		}
	}

	option = {
		name = SCUM
		trigger = {
			has_valid_civic = civic_fanatic_purifiers
		}
		custom_gui = "enclave_trader_option"
	}

	option = {
		name = TASTY
		trigger = {
			has_valid_civic = civic_hive_devouring_swarm
		}
		custom_gui = "enclave_trader_option"
	}

	option = {
		name = EXTERMINATE
		trigger = {
			has_valid_civic = civic_machine_terminator
		}
		custom_gui = "enclave_trader_option"
	}

	option = {
		name = leviathans.156.a
		custom_gui = "enclave_trader_option"
		trigger = { NOR = { has_valid_civic = civic_fanatic_purifiers has_valid_civic = civic_hive_devouring_swarm has_valid_civic = civic_machine_terminator } }
		default_hide_option = yes
	}
}

# No More Energy - Trades Canceled
event = {
	id = leviathans.170
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		any_country = {
			is_country_type = default
			resource_stockpile_compare = { resource = energy value <= 0 }
			OR = {
				has_active_xuracorp_trade = yes
				has_active_riggan_trade = yes
				has_active_muutagan_trade = yes
			}
		}
	}

	immediate = {
		every_country = {
			limit = {
				is_country_type = default
				resource_stockpile_compare = { resource = energy value <= 0 }
				OR = {
					has_active_xuracorp_trade = yes
					has_active_riggan_trade = yes
					has_active_muutagan_trade = yes
				}
			}
			country_event = { id = leviathans.171 }
		}
	}
}

# No More Energy - Trades Canceled Notification
country_event = {
	id = leviathans.171
	title = "leviathans.171.name"
	desc = "leviathans.171.desc"
	picture = GFX_evt_mining_operations
	show_sound = event_radio_chatter

	is_triggered_only = yes

	immediate = {
		if = {
			limit = {
				OR = {
					has_modifier = enclave_trade_1_xur
					has_modifier = enclave_trade_2_xur
					has_modifier = enclave_trade_3_xur
					has_modifier = enclave_trade_4_xur
					has_modifier = enclave_trade_5_xur
				}
			}
			switch = {
				trigger = has_modifier
				enclave_trade_1_xur = { remove_modifier = enclave_trade_1_xur }
				enclave_trade_2_xur = { remove_modifier = enclave_trade_2_xur }
				enclave_trade_3_xur = { remove_modifier = enclave_trade_3_xur }
				enclave_trade_4_xur = { remove_modifier = enclave_trade_4_xur }
				enclave_trade_5_xur = { remove_modifier = enclave_trade_5_xur }
			}
			random_country = {
				limit = { has_country_flag = trader_enclave_country_1 }
				add_trust = {
					who = root
					amount = -20
				}
			}
		}
		if = {
			limit = {
				OR = {
					has_modifier = enclave_trade_1_rig
					has_modifier = enclave_trade_2_rig
					has_modifier = enclave_trade_3_rig
					has_modifier = enclave_trade_4_rig
					has_modifier = enclave_trade_5_rig
				}
			}
			switch = {
				trigger = has_modifier
				enclave_trade_1_rig = { remove_modifier = enclave_trade_1_rig }
				enclave_trade_2_rig = { remove_modifier = enclave_trade_2_rig }
				enclave_trade_3_rig = { remove_modifier = enclave_trade_3_rig }
				enclave_trade_4_rig = { remove_modifier = enclave_trade_4_rig }
				enclave_trade_5_rig = { remove_modifier = enclave_trade_5_rig }
			}
			random_country = {
				limit = { has_country_flag = trader_enclave_country_2 }
				add_trust = {
					who = root
					amount = -20
				}
			}
		}
		if = {
			limit = {
				OR = {
					has_modifier = enclave_trade_1_mut
					has_modifier = enclave_trade_2_mut
					has_modifier = enclave_trade_3_mut
					has_modifier = enclave_trade_4_mut
					has_modifier = enclave_trade_5_mut
				}
			}
			switch = {
				trigger = has_modifier
				enclave_trade_1_mut = { remove_modifier = enclave_trade_1_mut }
				enclave_trade_2_mut = { remove_modifier = enclave_trade_2_mut }
				enclave_trade_3_mut = { remove_modifier = enclave_trade_3_mut }
				enclave_trade_4_mut = { remove_modifier = enclave_trade_4_mut }
				enclave_trade_5_mut = { remove_modifier = enclave_trade_5_mut }
			}
			random_country = {
				limit = { has_country_flag = trader_enclave_country_3 }
				add_trust = {
					who = root
					amount = -20
				}
			}
		}
	}

	option = {
		name = leviathans.171.a
		custom_tooltip = enclave_energy_trade_ended
		custom_tooltip = opinion-20
	}
}

# Artists Gatekeeper so the from scope doesn't break or refuse to pass trigger when we keep calling leviathans.300 from both on_custom_diplomacy and leviathans.30x events
country_event = {
	id = leviathans.299
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		from = {
			is_country_type = enclave
			has_country_flag = artist_enclave_country
		}
	}

	immediate = {
		if = {
			limit = {
				NOT = { exists = event_target:artist_enclave_country }
			}
			from = {
				save_global_event_target_as = artist_enclave_country
			}
		}
		country_event = { id = leviathans.300 }
	}
}

# Artists
country_event = {
	id = leviathans.300
	title = leviathans.300.name
	desc = {
		trigger = {
			switch = {
				trigger = has_country_flag
				artist_enclave_diplomacy_continued = { text = leviathans.300.desc.continued }
				recently_purchased_art = { text = leviathans.302.a.reply }
				recently_purchased_ministry = { text = leviathans.316.a.reply }
				recently_purchased_patron = { text = leviathans.304.a.reply }
				recently_purchased_festival = { text = leviathans.303.a.reply }
				default = { text = leviathans.300.desc }
			}
		}
	}
	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_artist_window"
	custom_gui_option = "enclave_artist_option"

	picture_event_data = {
		portrait = event_target:artist_enclave_country
		room = enclave_artist_room
	}

	trigger = {
		OR = {
			OR = {
				has_country_flag = artist_enclave_diplomacy_continued
				NOT = { has_country_flag = artist_enclave_diplomacy_engaged }
			}
			has_country_flag = recently_purchased_art
			has_country_flag = recently_purchased_ministry
			has_country_flag = recently_purchased_patron
			has_country_flag = recently_purchased_festival
		}
		NOT = {	has_country_flag = enclave_artist_ignores }
	}

	immediate = {
		save_event_target_as = my_country
		set_country_flag = artist_enclave_diplomacy_engaged
	}

	option = {
		name = leviathans.300.a
		trigger = {
			check_variable = {
				which = artist_monument_purchased
				value < 5
			}
			NOR = { has_valid_civic = civic_fanatic_purifiers has_valid_civic = civic_hive_devouring_swarm has_valid_civic = civic_machine_terminator }
		}
		hidden_effect = {
			remove_country_flag = artist_enclave_diplomacy_continued
			remove_country_flag = recently_purchased_art
			remove_country_flag = recently_purchased_ministry
			remove_country_flag = recently_purchased_patron
			remove_country_flag = recently_purchased_festival
			country_event = { id = leviathans.302 }
		}
	}

	option = {
		name = leviathans.300.a
		response_text = leviathans.300.a.reply
		is_dialog_only = yes
		trigger = {
			check_variable = {
				which = artist_monument_purchased
				value = 5
			}
			NOR = { has_valid_civic = civic_fanatic_purifiers has_valid_civic = civic_hive_devouring_swarm has_valid_civic = civic_machine_terminator }
		}
	}
	option = {
		name = leviathans.300.b
		trigger = {
			NOT = { has_modifier = enclave_artist_patron }
			NOR = { has_valid_civic = civic_fanatic_purifiers has_valid_civic = civic_hive_devouring_swarm has_valid_civic = civic_machine_terminator }
		}
		hidden_effect = {
			country_event = { id = leviathans.304 }
		}
	}
	#option = {
	#	name = leviathans.300.b.stop
	#	response_text = leviathans.300.b.reply
	#	trigger = {
	#		has_modifier = enclave_artist_patron
	#		NOR = { has_valid_civic = civic_fanatic_purifiers has_valid_civic = #civic_hive_devouring_swarm has_valid_civic = civic_machine_terminator }#
	#	}#
	#	c#ustom_tooltip = opinion-5#
	#	c#ustom_tooltip = leviathans.300.b.stop.tooltip#
	#	r#emove_modifier = enclave_artist_patron#
	#	h#idden_effect = {#
	#	#	remove_countr#y_flag = artist_enclave_diplomacy_engaged#
	#	#	remove_countr#y_flag = artist_patron#
	#	#	set_country_f#lag = enclave_stopped_#patronage#
	#	#	event_target:#artist_enclave_country# = {#
	#	#		add_trust# = {#
	#	#			who =# roo#t#
	#	#			amoun#t = #-5#
	#	#		}#
	#		}#
	#	}
	#}
	option = {
		name = leviathans.300.c
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
				has_country_flag = artist_festival_purchased
				has_ethic = ethic_gestalt_consciousness
			}
		}
		allow = {
			custom_tooltip = {
				text = leviathans.300.c.allow
				NOT = {
					has_country_flag = artist_festival_purchased
				}
				event_target:artist_enclave_country = {
					trust = {
						who = root
						value >= 50
					}
				}
			}
		}
		hidden_effect = {
			remove_country_flag = artist_enclave_diplomacy_engaged
			remove_country_flag = artist_enclave_diplomacy_continued
			remove_country_flag = recently_purchased_art
			remove_country_flag = recently_purchased_ministry
			remove_country_flag = recently_purchased_patron
			remove_country_flag = recently_purchased_festival
			country_event = { id = leviathans.303 }
		}
	}
	option = {
		name = leviathans.300.c
		trigger = {
			has_country_flag = artist_festival_purchased
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_authority = auth_hive_mind
			}
		}
		allow = {
			custom_tooltip = {
				text = leviathans.300.c.outofstock
				NOT = {
					has_country_flag = artist_festival_purchased
				}
			}
		}
		hidden_effect = {
			remove_country_flag = artist_enclave_diplomacy_engaged
			remove_country_flag = artist_enclave_diplomacy_continued
			remove_country_flag = recently_purchased_art
			remove_country_flag = recently_purchased_ministry
			remove_country_flag = recently_purchased_patron
			remove_country_flag = recently_purchased_festival
			country_event = { id = leviathans.303 }
		}
	}
	option = {
		name = leviathans.300.d
		trigger = { NOR = { has_valid_civic = civic_fanatic_purifiers has_valid_civic = civic_hive_devouring_swarm has_valid_civic = civic_machine_terminator } }
		is_dialog_only = yes
		response_text = leviathans.300.d.reply
	}
	# For those who have declined offer to build ministry of culture
	option = {
		name = leviathans.300.f
		trigger = {
			has_country_flag = enclave_artist_patron_event_1
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
				has_country_flag = artist_building_patron
			}
			# former .316 trigger
			exists = event_target:artist_enclave_country
			has_modifier = enclave_artist_patron
			has_country_flag = artist_patron
			NOR = {
				has_country_flag = enclave_stopped_patronage
				has_country_flag = enclave_artist_ignores
				#has_country_flag = artist_building_patron
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.316 }
		}
	}
	option = { # Art College
		name = leviathans.300.g
		trigger = {
			NOR = { has_valid_civic = civic_fanatic_purifiers has_valid_civic = civic_hive_devouring_swarm has_valid_civic = civic_machine_terminator }
			NOT = {
				event_target:artist_enclave_country = {
					has_country_flag = art_college@root
				}
			}
			any_system_within_border = {
				has_star_flag = enclave
				any_fleet_in_system = {
					exists = owner
					owner = {
						is_same_value = event_target:artist_enclave_country
					}
				}
			}
		}
		allow = {
			custom_tooltip = {
				fail_text = leviathans.300.g.opinion
				event_target:artist_enclave_country = {
					trust = {
						who = root
						value >= 50
					}
				}
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.340 }
		}
	}
	option = {
		name = GOODBYE
		trigger = { NOR = { has_valid_civic = civic_fanatic_purifiers has_valid_civic = civic_hive_devouring_swarm has_valid_civic = civic_machine_terminator } }
		default_hide_option = yes
		hidden_effect = {
			remove_country_flag = artist_enclave_diplomacy_engaged
			remove_country_flag = artist_enclave_diplomacy_continued
			remove_country_flag = recently_purchased_art
			remove_country_flag = recently_purchased_ministry
			remove_country_flag = recently_purchased_patron
			remove_country_flag = recently_purchased_festival
		}
	}

	option = {
		name = SCUM
		trigger = { has_valid_civic = civic_fanatic_purifiers }
		hidden_effect = {
			remove_country_flag = artist_enclave_diplomacy_engaged
			remove_country_flag = artist_enclave_diplomacy_continued
			remove_country_flag = recently_purchased_art
			remove_country_flag = recently_purchased_ministry
			remove_country_flag = recently_purchased_patron
			remove_country_flag = recently_purchased_festival
		}
	}

	option = {
		name = TASTY
		trigger = { has_valid_civic = civic_hive_devouring_swarm }
		hidden_effect = {
			remove_country_flag = artist_enclave_diplomacy_engaged
			remove_country_flag = artist_enclave_diplomacy_continued
			remove_country_flag = recently_purchased_art
			remove_country_flag = recently_purchased_ministry
			remove_country_flag = recently_purchased_patron
			remove_country_flag = recently_purchased_festival
		}
	}

	option = {
		name = EXTERMINATE
		trigger = {
			has_valid_civic = civic_machine_terminator
		}
		hidden_effect = {
			remove_country_flag = artist_enclave_diplomacy_engaged
			remove_country_flag = artist_enclave_diplomacy_continued
			remove_country_flag = recently_purchased_art
			remove_country_flag = recently_purchased_ministry
			remove_country_flag = recently_purchased_patron
			remove_country_flag = recently_purchased_festival
		}
	}

	#after = {
	#	hidden_effect = {
	#		remove_country_flag = artist_enclave_diplomacy_engaged
	#		remove_country_flag = artist_enclave_diplomacy_continued
	#		remove_country_flag = recently_purchased_art
	#		remove_country_flag = recently_purchased_ministry
	#		remove_country_flag = recently_purchased_patron
	#		remove_country_flag = recently_purchased_festival
	#	}
	#}
}

# Port
country_event = {
	id = leviathans.301
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		from = {
			if = {
				limit = {
					NOT = { has_country_flag = enclave_artist_ignores }
				}
				country_event = { id = leviathans.315 }
			}
			else = {
				country_event = { id = leviathans.313 }
			}
		}
	}
}

# Artist Introduction
country_event = {
	id = leviathans.315
	title = leviathans.300.name
	desc = leviathans.315.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_artist_window"

	picture_event_data = {
		portrait = from
		room = enclave_artist_room
	}

	option = {
		name = INTERESTING
		custom_gui = "enclave_artist_option"
		trigger = {
			NOR = { has_valid_civic = civic_fanatic_purifiers has_valid_civic = civic_hive_devouring_swarm has_valid_civic = civic_machine_terminator }
		}
	}

	option = {
		name = SCUM
		custom_gui = "enclave_artist_option"
		trigger = {
			has_valid_civic = civic_fanatic_purifiers
		}
	}

	option = {
		name = TASTY
		custom_gui = "enclave_artist_option"
		trigger = {
			has_valid_civic = civic_hive_devouring_swarm
		}
	}

	option = {
		name = EXTERMINATE
		custom_gui = "enclave_artist_option"
		trigger = {
			has_valid_civic = civic_machine_terminator
		}
	}
}

#Trying to buy an Art Piece
country_event = {
	id = leviathans.302
	title = leviathans.300.name
	desc = leviathans.302.desc
	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_artist_window"
	custom_gui_option = "enclave_artist_option"

	picture_event_data = {
		portrait = event_target:artist_enclave_country
		room = enclave_artist_room
	}

	trigger = {
		has_country_flag = artist_enclave_diplomacy_engaged
	}

	option = {
		name = DEAL
		add_resource = { energy = -600 }
		custom_tooltip = opinion10
		custom_tooltip = leviathans.302.a.tooltip
		allow = {
			resource_stockpile_compare = { resource = energy value >= 600 }
		}
		hidden_effect = {
			event_target:artist_enclave_country = {
				add_trust = {
					who = root
					amount = 10
				}
			}
			set_country_flag = recently_purchased_art
			if = {
				limit = {
					NOT = { has_country_flag = artist_monument_collector }
				}
				set_country_flag = artist_monument_collector
				set_variable = {
					which = artist_monument_purchased
					value = 1
				}
			}
			else_if = {
				limit = {
					has_country_flag = artist_monument_collector
				}
				change_variable = {
					which = artist_monument_purchased
					value = 1
				}
			}
		}
	}
	option = {
		name = TOOPOOR
		trigger = {
			resource_stockpile_compare = { resource = energy value < 600 }
		}
		hidden_effect = {
			set_country_flag = artist_enclave_diplomacy_continued
		}
	}
	option = {
		name = NODEAL
		default_hide_option = yes
		trigger = {
			NOT = { resource_stockpile_compare = { resource = energy value < 600 } }
		}
		hidden_effect = {
			set_country_flag = artist_enclave_diplomacy_continued
		}
	}
	after = {
		hidden_effect = {
			remove_country_flag = artist_enclave_diplomacy_engaged
			country_event = { id = leviathans.300 }
		}
	}
}

# Option to buy ministry of culture
country_event = {
	id = leviathans.316
	title = leviathans.316.name
	desc = leviathans.316.desc
	diplomatic = yes
	custom_gui = "enclave_artist_window"
	custom_gui_option = "enclave_artist_option"

	picture_event_data = {
		portrait = event_target:artist_enclave_country
		room = enclave_artist_room
	}

	is_triggered_only = yes

	# only fired by event option, see leviathans.300.f
	#trigger = {
	#	exists = event_target:artist_enclave_country
	#	has_modifier = enclave_artist_patron
	#	has_country_flag = artist_patron
	#	NOT = {
	#		has_country_flag = enclave_stopped_patronage
	#		has_country_flag = enclave_artist_ignores
	#		has_country_flag = artist_building_patron
	#	}
	#}

	option = {
		name = DEAL
		IF = {
			limit = { NOT = { has_ethic = ethic_gestalt_consciousness } }
			custom_tooltip = leviathans.322.a.tooltip
		}
		else_if  = { 
			limit = { is_machine_empire = no }
			custom_tooltip = leviathans.322.a.tooltip.hive
		}
		else_if = {
			limit = { is_machine_empire = yes }
			custom_tooltip = leviathans.322.a.tooltip.machine
		}
		#response_text = leviathans.316.a.reply
		allow = {
			resource_stockpile_compare = { resource = energy value >= 2000 }
		}
		add_resource = { energy = -2000 }
		hidden_effect = {
			set_country_flag = artist_building_patron
			set_country_flag = recently_purchased_ministry
		}
	}
	option = {
		name = TOOPOOR
		trigger = {
			resource_stockpile_compare = { resource = energy value < 2000 }
		}
		hidden_effect = {
			set_country_flag = artist_enclave_diplomacy_continued
		}
	}
	option = {
		name = NODEAL
		trigger = {
			NOT = { resource_stockpile_compare = { resource = energy value < 2000 } }
		}
		hidden_effect = {
			set_country_flag = artist_enclave_diplomacy_continued
		}
	}

	after = {
		hidden_effect = {
			remove_country_flag = artist_enclave_diplomacy_engaged
			country_event = { id = leviathans.300 }
		}
	}
}

#Trying to hire Artist for a festival
country_event = {
	id = leviathans.303
	title = leviathans.300.name
	desc = leviathans.303.desc
	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_artist_window"
	custom_gui_option = "enclave_artist_option"

	picture_event_data = {
		portrait = event_target:artist_enclave_country
		room = enclave_artist_room
	}

	trigger = {
		event_target:artist_enclave_country = {
			trust = {
				who = root
				value >= 50
			}
		}
	}

	option = {
		name = DEAL
		allow = {
			resource_stockpile_compare = { resource = energy value >= 1000 }
		}
		add_resource = { energy = -1000 }
		custom_tooltip = opinion15
		add_modifier = {
			modifier = enclave_artist_festival
			days = 1800
		}
		hidden_effect = {
			event_target:artist_enclave_country = {
				add_trust = {
					who = root
					amount = 15
				}
			}
			set_timed_country_flag = { flag = artist_festival_purchased days = 7200 }
			country_event = { id = leviathans.314 days = 1800 }
			set_country_flag = recently_purchased_festival
			country_event = { id = leviathans.309 }
		}
	}
	option = {
		name = TOOPOOR
		trigger = {
			resource_stockpile_compare = { resource = energy value < 1000 }
		}
		hidden_effect = {
			set_country_flag = artist_enclave_diplomacy_continued
		}
	}
	option = {
		name = NODEAL
		default_hide_option = yes
		hidden_effect = {
			set_country_flag = artist_enclave_diplomacy_continued
		}
	}
	after = {
		hidden_effect = {
			remove_country_flag = artist_enclave_diplomacy_engaged
			country_event = { id = leviathans.300 }
		}
	}
}
#Trying to become a patron
country_event = {
	id = leviathans.304
	base = leviathans.300

	desc_clear = yes
	desc = leviathans.304.desc

	trigger = {
		has_country_flag = artist_enclave_diplomacy_engaged
	}

	#option = {
	#	name = DEAL
	#	custom_tooltip = leviathans.304.a.tooltip
	#	add_modifier = {
	#		modifier = enclave_artist_patron
	#		days = 3600
	#	}
	#	allow = {
	#		custom_tooltip = {
	#			text = guardian.deal.tooltip
	#			OR = {
	#				has_monthly_income = { resource = energy value >= 25 }
	#				resource_stockpile_compare = { resource = energy value >= 25 }
	#			}
	#			OR = {
	#				has_monthly_income = { resource = minerals value >= 25 }
	#				resource_stockpile_compare = { resource = minerals value >= 25 }
	#			}
	#			OR = {
	#				has_monthly_income = { resource = influence value >= 1 }
	#				resource_stockpile_compare = { resource = influence value >= 1 }
	#			}
	#		}
	#	}
	#	hidden_effect = {
	#		if = {
	#			limit = {
	#				has_country_flag = enclave_stopped_patronage
	#			}
	#			remove_country_flag = enclave_stopped_patronage
	#		}
	#		set_country_flag = artist_patron
	#		set_country_flag = recently_purchased_patron
	#		country_event = { id = leviathans.306 days = 30 } #check if still patron in a month
	#		country_event = { id = leviathans.320 } #trigger patron followup events
	#		country_event = { id = leviathans.308 days = 359 }
	#	}
	#}

	option = {
		name = DEAL
		#custom_tooltip = leviathans.304.a.tooltip
		trigger = {
			num_pops < 61
		}
		allow = {
			resource_stockpile_compare = { resource = energy value >= 1000 }
			NOT = { has_modifier = enclave_artist_patron }
		}
		add_resource = { energy = -1000 }
		add_modifier = {
			modifier = enclave_artist_patron
			days = 3600
		}
		custom_tooltip = opinion20
		hidden_effect = {
			event_target:artist_enclave_country = {
				add_trust = {
					who = root
					amount = 20
				}
			}
			if = {
				limit = {
					has_country_flag = enclave_stopped_patronage
				}
				remove_country_flag = enclave_stopped_patronage
			}
			set_country_flag = artist_patron
			set_country_flag = recently_purchased_patron
			#country_event = { id = leviathans.306 days = 30 } #check if still patron in a month
			country_event = { id = leviathans.320 } #trigger patron followup events
			country_event = { id = leviathans.308 days = 360 }
			country_event = { id = leviathans.319 days = 3600 } #patronage renewal
		}
	}

	option = {
		name = DEAL
		#custom_tooltip = leviathans.304.a.tooltip
		trigger = {
			num_pops > 60
			num_pops < 121
		}
		allow = {
			resource_stockpile_compare = { resource = energy value >= 2000 }
			NOT = { has_modifier = enclave_artist_patron }
		}
		add_resource = { energy = -2000 }
		add_modifier = {
			modifier = enclave_artist_patron
			days = 3600
		}
		custom_tooltip = opinion20
		hidden_effect = {
			event_target:artist_enclave_country = {
				add_trust = {
					who = root
					amount = 20
				}
			}
			if = {
				limit = {
					has_country_flag = enclave_stopped_patronage
				}
				remove_country_flag = enclave_stopped_patronage
			}
			set_country_flag = artist_patron
			set_country_flag = recently_purchased_patron
			#country_event = { id = leviathans.306 days = 30 } #check if still patron in a month
			country_event = { id = leviathans.320 } #trigger patron followup events
			country_event = { id = leviathans.308 days = 360 }
			country_event = { id = leviathans.319 days = 3600 } #patronage renewal
		}
	}

	option = {
		name = DEAL
		#custom_tooltip = leviathans.304.a.tooltip
		trigger = {
			num_pops > 120
			num_pops < 181
		}
		allow = {
			resource_stockpile_compare = { resource = energy value >= 3000 }
			NOT = { has_modifier = enclave_artist_patron }
		}
		add_resource = { energy = -3000 }
		add_modifier = {
			modifier = enclave_artist_patron
			days = 3600
		}
		custom_tooltip = opinion20
		hidden_effect = {
			event_target:artist_enclave_country = {
				add_trust = {
					who = root
					amount = 20
				}
			}
			if = {
				limit = {
					has_country_flag = enclave_stopped_patronage
				}
				remove_country_flag = enclave_stopped_patronage
			}
			set_country_flag = artist_patron
			set_country_flag = recently_purchased_patron
			#country_event = { id = leviathans.306 days = 30 } #check if still patron in a month
			country_event = { id = leviathans.320 } #trigger patron followup events
			country_event = { id = leviathans.308 days = 360 }
			country_event = { id = leviathans.319 days = 3600 } #patronage renewal
		}
	}

	option = {
		name = DEAL
		#custom_tooltip = leviathans.304.a.tooltip
		trigger = {
			num_pops > 180
			num_pops < 241
		}
		allow = {
			resource_stockpile_compare = { resource = energy value >= 4000 }
			NOT = { has_modifier = enclave_artist_patron }
		}
		add_resource = { energy = -4000 }
		add_modifier = {
			modifier = enclave_artist_patron
			days = 3600
		}
		custom_tooltip = opinion20
		hidden_effect = {
			event_target:artist_enclave_country = {
				add_trust = {
					who = root
					amount = 20
				}
			}
			if = {
				limit = {
					has_country_flag = enclave_stopped_patronage
				}
				remove_country_flag = enclave_stopped_patronage
			}
			set_country_flag = artist_patron
			set_country_flag = recently_purchased_patron
			#country_event = { id = leviathans.306 days = 30 } #check if still patron in a month
			country_event = { id = leviathans.320 } #trigger patron followup events
			country_event = { id = leviathans.308 days = 360 }
			country_event = { id = leviathans.319 days = 3600 } #patronage renewal
		}
	}

	option = {
		name = DEAL
		#custom_tooltip = leviathans.304.a.tooltip
		trigger = { num_pops > 240 }
		allow = {
			resource_stockpile_compare = { resource = energy value >= 5000 }
			NOT = { has_modifier = enclave_artist_patron }
		}
		add_resource = { energy = -5000 }
		add_modifier = {
			modifier = enclave_artist_patron
			days = 3600
		}
		custom_tooltip = opinion20
		hidden_effect = {
			event_target:artist_enclave_country = {
				add_trust = {
					who = root
					amount = 20
				}
			}
			if = {
				limit = {
					has_country_flag = enclave_stopped_patronage
				}
				remove_country_flag = enclave_stopped_patronage
			}
			set_country_flag = artist_patron
			set_country_flag = recently_purchased_patron
			#country_event = { id = leviathans.306 days = 30 } #check if still patron in a month
			country_event = { id = leviathans.320 } #trigger patron followup events
			country_event = { id = leviathans.308 days = 360 }
			country_event = { id = leviathans.319 days = 3600 } #patronage renewal
		}
	}

	option = {
		name = NODEAL
		default_hide_option = yes
		hidden_effect = {
			set_country_flag = artist_enclave_diplomacy_continued
		}
	}

	after = {
		hidden_effect = {
			remove_country_flag = artist_enclave_diplomacy_engaged
			country_event = { id = leviathans.300 }
		}
	}
}
#building stuff
planet_event = {
	id = leviathans.305
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		last_building_changed = building_artist_patron
		always = no
	}

	immediate = {
		owner = {
			change_variable = {
				which = artist_monuments_built
				value = -1
			}
		}
	}
}

##Patron modifier checks
#country_event = {
#	id = leviathans.306
#	hide_window = yes
#	is_triggered_only = yes
#
#	trigger = {
#		has_modifier = enclave_artist_patron
#		has_country_flag = artist_patron
#		NOT = { has_country_flag = enclave_stopped_patronage }
#	}
#
#	immediate = {
#		if = {
#			limit = {
#				OR = {
#					has_monthly_income = { resource = energy value >= 25 }
#					resource_stockpile_compare = { resource = energy value >= 25 }
#				}
#				OR = {
#					has_monthly_income = { resource = minerals value >= 25 }
#					resource_stockpile_compare = { resource = minerals value >= 25 }
#				}
#				OR = {
#					has_monthly_income = { resource = influence value >= 1 }
#					resource_stockpile_compare = { resource = influence value >= 1 }
#				}
#			}
#			event_target:artist_enclave_country = {
#				add_trust = {
#					who = root
#					amount = 1
#				}
#			}
#			country_event = { id = leviathans.306 days = 30 }
#		#	else = {
#		#		event_target:artist_enclave_country = {
#		#			add_trust = {
#		#				who = root
#		#				amount = -5
#		#			}
#		#		}
#		#		remove_modifier = enclave_artist_patron
#		#		remove_country_flag = artist_patron
#		#		country_event = { id = leviathans.307 }
#		#	}
#		#}
#	}
#}
#Patronage ended because not enough resources
#country_event = {
#	id = leviathans.307
#	title = leviathans.300.name
#	desc = leviathans.307.desc
#	picture = GFX_evt_space_station
#	show_sound = event_planetary_riot
#	location = event_target:this_planet
#
#	is_triggered_only = yes
#
#	immediate = {
#		random_galaxy_planet = {
#			limit = {
#				has_planet_flag = guardians_artists_planet
#			}
#			save_event_target_as = this_planet
#		}
#	}
#	option = {
#		name = UNFORTUNATE
#		custom_tooltip = leviathans.307.a.tooltip
#	}
#}

# Patronage year counter for achievement
country_event = {
	id = leviathans.308
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		if = {
			limit = {
				has_modifier = enclave_artist_patron
				check_variable = {
					which = patronage_duration
					value = 9
				}
			}
			set_country_flag = 10yr_patronage
		}
		else_if = {
			limit = {
				NOT = { has_modifier = enclave_artist_patron }
			}
			set_variable = {
				which = patronage_duration
				value = 0
			}
		}
		else_if = {
			limit = { has_modifier = enclave_artist_patron }
			if = {
				limit = { check_variable = { which = patronage_duration value < 1 } }
				set_variable = {
					which = patronage_duration
					value = 1
				}
			}
			else = {
				change_variable = {
					which = patronage_duration
					value = 1
				}
			}
			country_event = { id = leviathans.308 days = 360 }
		}
	}
}

#Festival Event Trigger
country_event = {
	id = leviathans.309
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		random_list = {
			10 = {
				modifier = {
					factor = 1.5
					OR = {
						has_ethic = ethic_fanatic_materialist
						has_ethic = ethic_materialist
					}
				}
				country_event = { id = leviathans.310 days = 250 random = 25 }
			}
			10 = {
				modifier = {
					factor = 1.5
					OR = {
						has_ethic = ethic_fanatic_xenophile
						has_ethic = ethic_xenophile
						has_ethic = ethic_fanatic_pacifist
						has_ethic = ethic_pacifist
					}
				}
				country_event = { id = leviathans.311 days = 150 random = 25 }
			}
			5 = {
				modifier = {
					factor = 1.5
					OR = {
						has_ethic = ethic_fanatic_xenophobe
						has_ethic = ethic_xenophobe
						has_ethic = ethic_fanatic_materialist
						has_ethic = ethic_materialist
					}
				}
				country_event = { id = leviathans.312 days = 300 random = 50 }
			}
			75 = { }
		}
	}
}

#Artist Festival events
#People get trampled
country_event = {
	id = leviathans.310
	title = leviathans.310.name
	desc = leviathans.310.desc
	picture = GFX_evt_alien_ruins
	show_sound = event_planetary_riot
	location = event_target:this_planet

	is_triggered_only = yes

	trigger = {
		has_modifier = enclave_artist_festival
	}

	immediate = {
		random_owned_planet = {
			save_event_target_as = this_planet
		}
	}
	option = {
		name = UNFORTUNATE
		add_modifier = {
			modifier = enclave_artist_festival_outrage
			days = 720
		}
	}
	option = {
		name = leviathans.310.b
		add_resource = { influence = -100 }
	}

	after = {
		event_target:this_planet = {
			random_owned_pop = {
				kill_pop = yes
			}
		}
	}
}
#Artists want to move in
country_event = {
	id = leviathans.311
	title = leviathans.311.name
	desc = leviathans.311.desc
	picture = GFX_evt_metropolis
	show_sound = event_celebration
	location = event_target:this_planet

	is_triggered_only = yes

	trigger = {
		has_modifier = enclave_artist_festival
		NOR = {
			has_country_flag = enclave_artist_ignores
			has_authority = auth_hive_mind
		}
	}

	immediate = {
		random_owned_planet = {
			weights = {
				base = 1
				modifier = {
					add = 5
					free_housing > 0
				}
				modifier = {
					add = 10
					free_housing > 1
				}
			}
			save_event_target_as = this_planet
		}
		random_country = {
			limit = {
				has_country_flag = artist_enclave_country
			}
			species = {
				save_event_target_as = artist_species
			}
		}
	}
	option = {
		name = leviathans.311.a
		event_target:this_planet = {
			create_pop = {
				species = event_target:artist_species
				ethos = {
					ethic = "ethic_xenophile"
				}
			}
			create_pop = {
				species = event_target:artist_species
				ethos = {
					ethic = "ethic_xenophile"
				}
			}
			every_owned_pop = {
				limit = { is_same_species = event_target:artist_species }
				modify_species = {
					ideal_planet_class = event_target:this_planet
				}
			}
		}
	}
	option = {
		name = leviathans.311.b
	}
}
#The artists flee and steal your stuff
country_event = {
	id = leviathans.312
	title = leviathans.312.name
	desc = leviathans.312.desc
	picture = GFX_evt_metropolis
	show_sound = event_planetary_riot
	location = event_target:location

	is_triggered_only = yes

	trigger = {
		has_modifier = enclave_artist_festival
	}

	immediate = {
		set_timed_country_flag = { flag = enclave_artist_ignores days = 3600 }
		random_galaxy_planet = {
			limit = {
				has_planet_flag = guardians_artists_planet
			}
			save_event_target_as = location
		}
	}

	option = {
		name = leviathans.312.a
		remove_modifier = enclave_artist_festival
		add_resource = { energy = -1000 }
		hidden_effect = {
			remove_country_flag = artist_festival_purchased
		}
	}
}
#Artists don't answer your calls after stealing your stuff or being attacked
country_event = {
	id = leviathans.313
	title = leviathans.300.name
	desc = leviathans.313.desc
	desc = {
		trigger = {
			switch = {
				trigger = has_country_flag
				enclave_artist_encountered = { text = leviathans.313.desc }
				default = { text = leviathans.313.desc.unknown }
			}
		}
	}
	picture = GFX_evt_space_station
	show_sound = event_radio_chatter
	location = event_target:location

	is_triggered_only = yes

	trigger = {
		from = {
			AND = {
				is_country_type = enclave
				has_country_flag = artist_enclave_country
			}
		}
		has_country_flag = enclave_artist_ignores
		NOT = {
			has_country_flag = artist_enclave_diplomacy_engaged
		}
	}

	immediate = {
		random_galaxy_planet = {
			limit = {
				has_planet_flag = guardians_artists_planet
			}
			save_event_target_as = location
		}
		set_country_flag = artist_enclave_diplomacy_engaged
	}

	option = {
		name = SCUM
		custom_gui = "enclave_artist_option"
		trigger = {
			has_valid_civic = civic_fanatic_purifiers
		}
	}

	option = {
		name = TASTY
		custom_gui = "enclave_artist_option"
		trigger = {
			has_valid_civic = civic_hive_devouring_swarm
		}
	}

	option = {
		name = EXTERMINATE
		custom_gui = "enclave_artist_option"
		trigger = {
			has_valid_civic = civic_machine_terminator
		}
	}

	option = {
		name = leviathans.313.a
		default_hide_option = yes
		trigger = {
			has_country_flag = enclave_artist_encountered
			NOR = { has_valid_civic = civic_fanatic_purifiers has_valid_civic = civic_hive_devouring_swarm has_valid_civic = civic_machine_terminator }
		}
		hidden_effect = {
			remove_country_flag = artist_enclave_diplomacy_engaged
		}
	}
	option = {
		name = PECULIAR
		trigger = {
			NOT = { has_country_flag = enclave_artist_encountered }
			NOR = { has_valid_civic = civic_fanatic_purifiers has_valid_civic = civic_hive_devouring_swarm has_valid_civic = civic_machine_terminator }
		}
		hidden_effect = {
			remove_country_flag = artist_enclave_diplomacy_engaged
		}
	}
}
#Festival ends stuff
country_event = {
	id = leviathans.314
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		has_country_flag = artist_festival_purchased
	}

	immediate = {
		remove_country_flag = artist_festival_purchased
	}
}

#Patronage renewal
country_event = {
	id = leviathans.319
	title = leviathans.300.name
	desc = leviathans.319.desc
	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_artist_window"
	custom_gui_option = "enclave_artist_option"

	picture_event_data = {
		portrait = event_target:artist_enclave_country
		room = enclave_artist_room
	}

	option = {
		name = DEAL
		trigger = {
			num_pops < 61
		}
		#custom_tooltip = leviathans.304.a.tooltip
		allow = {
			resource_stockpile_compare = { resource = energy value >= 1000 }
			NOT = { has_modifier = enclave_artist_patron }
		}
		add_resource = { energy = -1000 }
		add_modifier = {
			modifier = enclave_artist_patron
			days = 3600
		}
		custom_tooltip = opinion20
		event_target:artist_enclave_country = {
			add_trust = {
				who = root
				amount = 20
			}
		}
		hidden_effect = {
			event_target:artist_enclave_country = {
				add_trust = {
					who = root
					amount = 20
				}
			}
			hidden_effect = {
				if = {
					limit = {
						has_country_flag = enclave_stopped_patronage
					}
					remove_country_flag = enclave_stopped_patronage
				}
				set_country_flag = artist_patron
				set_country_flag = recently_purchased_patron
				#country_event = { id = leviathans.306 days = 30 } #check if still patron in a month
				country_event = { id = leviathans.320 } #trigger patron followup events
				country_event = { id = leviathans.308 days = 359 }
				country_event = { id = leviathans.319 days = 3600 } #patronage renewal
			}
		}
	}

	option = {
		name = DEAL
		trigger = {
			num_pops > 60
			num_pops < 121
		}
		#custom_tooltip = leviathans.304.a.tooltip
		allow = {
			resource_stockpile_compare = { resource = energy value >= 2000 }
			NOT = { has_modifier = enclave_artist_patron }
		}
		add_resource = { energy = -2000 }
		add_modifier = {
			modifier = enclave_artist_patron
			days = 3600
		}
		custom_tooltip = opinion20
		event_target:artist_enclave_country = {
			add_trust = {
				who = root
				amount = 20
			}
		}
		hidden_effect = {
			event_target:artist_enclave_country = {
				add_trust = {
					who = root
					amount = 20
				}
			}
			hidden_effect = {
				if = {
					limit = {
						has_country_flag = enclave_stopped_patronage
					}
					remove_country_flag = enclave_stopped_patronage
				}
				set_country_flag = artist_patron
				set_country_flag = recently_purchased_patron
				#country_event = { id = leviathans.306 days = 30 } #check if still patron in a month
				country_event = { id = leviathans.320 } #trigger patron followup events
				country_event = { id = leviathans.308 days = 359 }
				country_event = { id = leviathans.319 days = 3600 } #patronage renewal
			}
		}
	}

	option = {
		name = DEAL
		trigger = {
			num_pops > 120
			num_pops < 181
		}
		#custom_tooltip = leviathans.304.a.tooltip
		allow = {
			resource_stockpile_compare = { resource = energy value >= 3000 }
			NOT = { has_modifier = enclave_artist_patron }
		}
		add_resource = { energy = -3000 }
		add_modifier = {
			modifier = enclave_artist_patron
			days = 3600
		}
		custom_tooltip = opinion20
		event_target:artist_enclave_country = {
			add_trust = {
				who = root
				amount = 20
			}
		}
		hidden_effect = {
			event_target:artist_enclave_country = {
				add_trust = {
					who = root
					amount = 20
				}
			}
			hidden_effect = {
				if = {
					limit = {
						has_country_flag = enclave_stopped_patronage
					}
					remove_country_flag = enclave_stopped_patronage
				}
				set_country_flag = artist_patron
				set_country_flag = recently_purchased_patron
				#country_event = { id = leviathans.306 days = 30 } #check if still patron in a month
				country_event = { id = leviathans.320 } #trigger patron followup events
				country_event = { id = leviathans.308 days = 359 }
				country_event = { id = leviathans.319 days = 3600 } #patronage renewal
			}
		}
	}

	option = {
		name = DEAL
		trigger = {
			num_pops > 180
			num_pops < 241
		}
		#custom_tooltip = leviathans.304.a.tooltip
		allow = {
			resource_stockpile_compare = { resource = energy value >= 4000 }
			NOT = { has_modifier = enclave_artist_patron }
		}
		add_resource = { energy = -4000 }
		add_modifier = {
			modifier = enclave_artist_patron
			days = 3600
		}
		custom_tooltip = opinion20
		event_target:artist_enclave_country = {
			add_trust = {
				who = root
				amount = 20
			}
		}
		hidden_effect = {
			event_target:artist_enclave_country = {
				add_trust = {
					who = root
					amount = 20
				}
			}
			hidden_effect = {
				if = {
					limit = {
						has_country_flag = enclave_stopped_patronage
					}
					remove_country_flag = enclave_stopped_patronage
				}
				set_country_flag = artist_patron
				set_country_flag = recently_purchased_patron
				#country_event = { id = leviathans.306 days = 30 } #check if still patron in a month
				country_event = { id = leviathans.320 } #trigger patron followup events
				country_event = { id = leviathans.308 days = 359 }
				country_event = { id = leviathans.319 days = 3600 } #patronage renewal
			}
		}
	}

	option = {
		name = DEAL
		trigger = {
			num_pops > 240
		}
		#custom_tooltip = leviathans.304.a.tooltip
		allow = {
			resource_stockpile_compare = { resource = energy value >= 5000 }
			NOT = { has_modifier = enclave_artist_patron }
		}
		add_resource = { energy = -5000 }
		add_modifier = {
			modifier = enclave_artist_patron
			days = 3600
		}
		custom_tooltip = opinion20
		event_target:artist_enclave_country = {
			add_trust = {
				who = root
				amount = 20
			}
		}
		hidden_effect = {
			event_target:artist_enclave_country = {
				add_trust = {
					who = root
					amount = 20
				}
			}
			hidden_effect = {
				if = {
					limit = {
						has_country_flag = enclave_stopped_patronage
					}
					remove_country_flag = enclave_stopped_patronage
				}
				set_country_flag = artist_patron
				set_country_flag = recently_purchased_patron
				#country_event = { id = leviathans.306 days = 30 } #check if still patron in a month
				country_event = { id = leviathans.320 } #trigger patron followup events
				country_event = { id = leviathans.308 days = 359 }
				country_event = { id = leviathans.319 days = 3600 } #patronage renewal
			}
		}
	}


	option = {
		name = NODEAL
		default_hide_option = yes
	}
}

#Patron Event Trigger
country_event = {
	id = leviathans.320
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		exists = event_target:artist_enclave_country
		has_modifier = enclave_artist_patron
		has_country_flag = artist_patron
		NOR = {
			has_country_flag = enclave_stopped_patronage
			has_country_flag = enclave_artist_ignores
		}
	}

	immediate = {
		random_list = {
			20 = {
				modifier = {
					factor = 2
					NOT = { has_country_flag = enclave_artist_patron_events }
				}
				modifier = {
					factor = 2
					check_variable = {
						which = artist_newsletter
						value < 5
					}
				}
				modifier = {
					factor = 0
					OR = {
						NOT = { has_country_flag = artist_patron }
						check_variable = {
							which = artist_newsletter
							value > 4
						}
					}
				}
				country_event = { id = leviathans.321 days = 500 random = 1000 }
			}
			20 = {
				modifier = {
					factor = 0
					OR = {
						has_country_flag = enclave_artist_patron_event_1
						NOT = { has_country_flag = artist_patron }
					}
				}
				country_event = { id = leviathans.322 days = 500 random = 1000 }
			}
			20 = {
				modifier = {
					factor = 0
					OR = {
						has_country_flag = enclave_artist_patron_event_2
						NOT = { has_country_flag = artist_patron }
					}
				}
				country_event = { id = leviathans.323 days = 500 random = 1000 }
			}
			20 = {
				modifier = {
					factor = 0
					OR = {
						has_country_flag = enclave_artist_patron_event_3
						NOT = { has_country_flag = artist_patron }
					}
				}
				country_event = { id = leviathans.324 days = 500 random = 1000 }
			}
			20 = {
				modifier = {
					factor = 0.20
					NOT = { has_country_flag = enclave_artist_patron_events }
				}
				modifier = {
					factor = 1.10
					has_country_flag = enclave_artist_patron_event_1
				}
				modifier = {
					factor = 1.10
					has_country_flag = enclave_artist_patron_event_2
				}
				modifier = {
					factor = 1.10
					has_country_flag = enclave_artist_patron_event_3
				}
				#DO NOTHING
			}
		}
	}
}
#Patron Newsletter
country_event = {
	id = leviathans.321
	title = leviathans.321.name
	desc = {
		trigger = {
			text = "leviathans.321.desc"
			success_text = {
				text = "leviathans.321.desc.a"
				check_variable = {
					which = artist_newsletter
					value = 1
				}
			}
			success_text = {
				text = "leviathans.321.desc.b"
				check_variable = {
					which = artist_newsletter
					value = 2
				}
			}
			success_text = {
				text = "leviathans.321.desc.c"
				check_variable = {
					which = artist_newsletter
					value = 3
				}
			}
			success_text = {
				text = "leviathans.321.desc.d"
				check_variable = {
					which = artist_newsletter
					value = 4
				}
			}
		}
	}
	diplomatic = yes
	custom_gui = "enclave_artist_window"
	custom_gui_option = "enclave_artist_option"

	picture_event_data = {
		portrait = event_target:artist_enclave_country
		room = enclave_artist_room
	}

	is_triggered_only = yes

	trigger = {
		exists = event_target:artist_enclave_country
		has_modifier = enclave_artist_patron
		has_country_flag = artist_patron
		NOR = {
			has_country_flag = enclave_stopped_patronage
			has_country_flag = enclave_artist_ignores
		}
		check_variable = {
			which = artist_newsletter
			value < 4
		}
	}

	immediate = {
		set_country_flag = enclave_artist_patron_events
		if = {
			limit = {
				check_variable = {
					which = artist_newsletter
					value < 1
				}
			}
			set_variable = {
				which = artist_newsletter
				value = 1
			}
		}
		else = {
			change_variable = {
				which = artist_newsletter
				value = 1
			}
		}
		random_system = {
			limit = {
				any_system_planet = {
					has_planet_flag = guardians_artists_planet
				}
				root = {
					intel_level = {
						level > none
						system = prev
					}
				}
			}
			save_event_target_as = this_planet
		}
	}

	option = {
		name = leviathans.321.a
		#response_text = leviathans.321.a.reply
		add_resource = {
			energy = -500
			influence = 50
		}
		allow = {
			resource_stockpile_compare = { resource = energy value >= 500 }
		}
	}
	option = {
		name = leviathans.321.c
		#response_text = leviathans.321.c.reply
	}
	option = {
		name = leviathans.321.b
		#response_text = leviathans.321.b.reply
		hidden_effect = {
			set_variable = {
				which = artist_newsletter
				value = 5
			}
		}
	}

	after = {
		hidden_effect = {
			country_event = { id = leviathans.320 days = 60 random = 30 }
		}
	}
}
#Patron commission
country_event = {
	id = leviathans.322
	title = leviathans.322.name
	desc = leviathans.322.desc
	diplomatic = yes
	custom_gui = "enclave_artist_window"
	custom_gui_option = "enclave_artist_option"

	picture_event_data = {
		portrait = event_target:artist_enclave_country
		room = enclave_artist_room
	}

	is_triggered_only = yes

	trigger = {
		exists = event_target:artist_enclave_country
		has_modifier = enclave_artist_patron
		has_country_flag = artist_patron
		NOR = {
			has_country_flag = enclave_stopped_patronage
			has_country_flag = enclave_artist_ignores
			has_country_flag = artist_building_patron
		}
	}

	immediate = {
		set_country_flag = enclave_artist_patron_events
		set_country_flag = enclave_artist_patron_event_1
		random_system = {
			limit = {
				any_system_planet = {
					has_planet_flag = guardians_artists_planet
				}
				root = {
					intel_level = {
						level > none
						system = prev
					}
				}
			}
			save_event_target_as = this_planet
		}
	}
	option = {
		name = DEAL
		IF = {
			limit = { NOT = { has_ethic = ethic_gestalt_consciousness } }
			custom_tooltip = leviathans.322.a.tooltip
		}
		else_if  = { 
			limit = { is_machine_empire = no }
			custom_tooltip = leviathans.322.a.tooltip.hive
		}
		else_if = {
			limit = { is_machine_empire = yes }
			custom_tooltip = leviathans.322.a.tooltip.machine
		}
		allow = {
			resource_stockpile_compare = { resource = energy value >= 2000 }
		}
		hidden_effect = {
			add_resource = { energy = -2000 }
			set_country_flag = artist_building_patron
		}
	}
	option = {
		name = TOOPOOR
		trigger = {
			resource_stockpile_compare = { resource = energy value < 2000 }
		}
	}
	option = {
		name = NODEAL
		trigger = {
			NOT = { resource_stockpile_compare = { resource = energy value < 2000 } }
		}
	}

	after = {
		hidden_effect = {
			country_event = { id = leviathans.320 days = 100 random = 25 }
		}
	}
}
#I became a patron and all I got was this t-shirt
country_event = {
	id = leviathans.323
	title = leviathans.323.name
	desc = leviathans.323.desc
	diplomatic = yes
	custom_gui = "enclave_artist_window"
	custom_gui_option = "enclave_artist_option"

	picture_event_data = {
		portrait = event_target:artist_enclave_country
		room = enclave_artist_room
	}

	is_triggered_only = yes

	trigger = {
		exists = event_target:artist_enclave_country
		has_modifier = enclave_artist_patron
		has_country_flag = artist_patron
		NOR = {
			has_country_flag = enclave_stopped_patronage
			has_country_flag = enclave_artist_ignores
		}
	}

	immediate = {
		set_country_flag = enclave_artist_patron_events
		set_country_flag = enclave_artist_patron_event_2
		random_system = {
			limit = {
				any_system_planet = {
					has_planet_flag = guardians_artists_planet
				}
				root = {
					intel_level = {
						level > none
						system = prev
					}
				}
			}
			save_event_target_as = this_planet
		}
	}
	option = {
		name = leviathans.323.a
		custom_tooltip = opinion10
		#response_text = leviathans.323.a.reply
		hidden_effect = {
			event_target:artist_enclave_country = {
				add_trust = {
					who = root
					amount = 10
				}
			}
			country_event = { id = leviathans.320 days = 100 random = 25 }
		}
	}
	option = {
		name = leviathans.323.b
		add_resource = { energy = 1000 }
		custom_tooltip = opinion-3
		remove_modifier = enclave_artist_patron
		hidden_effect = {
			event_target:artist_enclave_country = {
				add_trust = {
					who = root
					amount = -3
				}
			}
		}
		#response_text = leviathans.323.b.reply
	}
}
#Artist asks if you want some resources
country_event = {
	id = leviathans.324
	title = leviathans.324.name
	desc = leviathans.324.desc
	diplomatic = yes
	custom_gui = "enclave_artist_window"
	custom_gui_option = "enclave_artist_option"

	picture_event_data = {
		portrait = event_target:artist_enclave_country
		room = enclave_artist_room
	}

	is_triggered_only = yes

	trigger = {
		exists = event_target:artist_enclave_country
		has_modifier = enclave_artist_patron
		has_country_flag = artist_patron
		NOR = {
			has_country_flag = enclave_stopped_patronage
			has_country_flag = enclave_artist_ignores
		}
	}

	immediate = {
		set_country_flag = enclave_artist_patron_events
		set_country_flag = enclave_artist_patron_event_3
		random_system = {
			limit = {
				any_system_planet = {
					has_planet_flag = guardians_artists_planet
				}
				root = {
					intel_level = {
						level > none
						system = prev
					}
				}
			}
			save_event_target_as = this_planet
		}
	}
	option = {
		name = leviathans.324.a
		add_resource = { minerals = 500 }
		#response_text = leviathans.324.a.reply
	}
	option = {
		name = leviathans.324.b
		add_resource = { influence = 50 }
		#response_text = leviathans.324.b.reply
	}

	after = {
		hidden_effect = {
			country_event = { id = leviathans.320 days = 100 random = 25 }
		}
	}
}
country_event = {
	id = leviathans.330
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		from = {
			has_country_flag = artist_enclave_country
		}
	}

	immediate = {
		if = {
			limit = {
				OR = {
					has_modifier = enclave_artist_patron
					has_country_flag = artist_patron
				}
			}
			remove_modifier = enclave_artist_patron
			remove_country_flag = artist_patron
		}
		if = {
			limit = {
				NOT = { has_country_flag = enclave_artist_ignores }
			}
			set_country_flag = enclave_artist_ignores
		}
	}
}
country_event = {
	id = leviathans.331
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		has_country_flag = artist_enclave_country
	}

	immediate = {
		fromfrom = {
			remove_fleet_flag = artist_enclave_station
			solar_system = {
				remove_star_flag = guardians_artists_system
				save_event_target_as = destroyed_station_location
			}
			if = { #Change capital
				limit = {
					is_custom_capital_location = yes
					owner = {
						any_owned_fleet = {
							has_fleet_flag = artist_enclave_station
						}
					}
				}
				owner = {
					random_owned_fleet = {
						limit = { has_fleet_flag = artist_enclave_station }
						save_event_target_as = newCustomCapital
					}
					set_custom_capital_location = event_target:newCustomCapital
				}
				every_playable_country = {
					limit = {
						has_communications = root
						NOT = { is_same_value = root.from }
					}
					country_event = { id = leviathans.332 }
				}
				random_playable_country = {
					observer_event = { id = observer.11 }
				}
			}
			else = {
				every_playable_country = {
					limit = {
						has_communications = root
						NOT = { is_same_value = root.from }
					}
					country_event = { id = leviathans.333 }
				}
				random_playable_country = {
					observer_event = { id = observer.12 }
				}
			}
		}
	}
}
# An artist station has been destroyed
country_event = {
	id = leviathans.332
	title = leviathans.300.name
	desc = leviathans.332.desc
	picture = GFX_evt_exploding_ship
	show_sound = event_structural_collapse
	location = event_target:destroyed_station_location

	is_triggered_only = yes

	option = {
		name = WORRYING
		trigger = {
			NOT = { has_country_flag = enclave_artist_ignores }
		}
	}
	option = {
		name = OK
		trigger = {
			has_country_flag = enclave_artist_ignores
		}
	}
}
# All artist stations have been destroyed
country_event = {
	id = leviathans.333
	title = leviathans.300.name
	desc = leviathans.333.desc
	picture = GFX_evt_exploding_ship
	show_sound = event_super_explosion
	location = event_target:destroyed_station_location

	is_triggered_only = yes

	immediate = {
		if = {
			limit = {
				OR = {
					has_modifier = enclave_artist_patron
					has_country_flag = artist_patron
				}
			}
			remove_modifier = enclave_artist_patron
			remove_country_flag = artist_patron
		}
		if = {
			limit = {
				OR = {
					has_modifier = enclave_artist_festival
					has_country_flag = artist_festival_purchased
				}
			}
			remove_modifier = enclave_artist_festival
			remove_country_flag = artist_festival_purchased
		}
	}

	option = {
		name = TERRIBLE
		custom_tooltip = leviathans.307.a.tooltip
		trigger = {
			NOT = { has_country_flag = enclave_artist_ignores }
		}
	}
	option = {
		name = OK
		custom_tooltip = leviathans.307.a.tooltip
		trigger = {
			has_country_flag = enclave_artist_ignores
		}
	}
}
# You destroyed an artist station
country_event = {
	id = leviathans.334
	title = leviathans.300.name
	desc = {
		trigger = {
			switch = {
				trigger = has_country_flag
				enclave_artist_encountered = { text = leviathans.334.desc }
				default = { text = leviathans.334.desc.unknown }
			}
		}
	}
	picture = GFX_evt_exploding_ship
	show_sound = event_structural_collapse
	location = fromfrom

	is_triggered_only = yes

	immediate = {
		set_country_flag = destroyed_artist
		fromfrom = {
			solar_system = {
				save_event_target_as = station_system
			}
		}
	}

	trigger = {
		from = {
			has_country_flag = artist_enclave_country
		}
	}

	option = {
		name = EXCELLENT
		add_resource = {
			energy = 2000
			minerals = 2000
		}
	}
}

# Art College
country_event = {
	id = leviathans.340
	title = leviathans.340.name
	desc = leviathans.340.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_artist_window"
	custom_gui_option = "enclave_artist_option"

	picture_event_data = {
		portrait = event_target:artist_enclave_country
		room = enclave_artist_room
	}

	immediate = {
		set_country_flag = artist_enclave_diplomacy_engaged
		random_system_within_border = {
			limit = {
				any_fleet_in_system = {
					exists = owner
					owner = {
						is_same_value = event_target:artist_enclave_country
					}
				}
			}
			save_event_target_as = artist_system
		}
		event_target:artist_enclave_country = {
			set_country_flag = art_college@root
		}
	}

	after = {
		hidden_effect = {
			remove_country_flag = artist_enclave_diplomacy_engaged
			country_event = { id = leviathans.300 }
		}
	}

	option = { # Back
		name = leviathans.340.a
		hidden_effect = {
			set_country_flag = artist_enclave_diplomacy_continued
		}
	}
}

# Curator Main Menu (Initial)
country_event = {
	id = leviathans.500
	title = leviathans.500.name
	desc = leviathans.500a.desc
	desc = leviathans.500b.desc
	desc = leviathans.500c.desc
	desc = leviathans.500d.desc
	desc = leviathans.500e.desc
	desc = leviathans.500f.desc
	desc = leviathans.500g.desc
	desc = leviathans.500h.desc
	desc = leviathans.500i.desc
	desc = leviathans.500j.desc
	desc = leviathans.500k.desc
	desc = leviathans.500l.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_curator_window"
	force_open = yes

	picture_event_data = {
		portrait = from
		room = enclave_curator_room
	}

	trigger = {
		from = {
			is_country_type = enclave
			has_country_flag = curator_enclave_country
		}
		NOT = { has_country_flag = curator_enclave_diplomacy_engaged }
		NOT = { has_country_flag = attacked_curators }
	}

	immediate = {
		set_country_flag = curator_enclave_diplomacy_engaged
		FROM = { save_event_target_as = curators }
	}

	after = {
		hidden_effect = {
			remove_country_flag = curator_enclave_diplomacy_engaged
		}
	}

	option = {
		name = SCUM
		trigger = { has_valid_civic = civic_fanatic_purifiers }
		custom_gui = "enclave_curator_option"
		hidden_effect = {
			remove_country_flag = curator_enclave_diplomacy_engaged
		}
	}

	option = {
		name = TASTY
		trigger = { has_valid_civic = civic_hive_devouring_swarm }
		custom_gui = "enclave_curator_option"
		hidden_effect = {
			remove_country_flag = curator_enclave_diplomacy_engaged
		}
	}

	option = {
		name = EXTERMINATE
		trigger = { has_valid_civic = civic_machine_terminator }
		custom_gui = "enclave_curator_option"
		hidden_effect = {
			remove_country_flag = curator_enclave_diplomacy_engaged
		}
	}

	option = { # Research
		name = leviathans.500.b
		custom_gui = "enclave_curator_option"
		trigger = { NOR = { has_valid_civic = civic_fanatic_purifiers has_valid_civic = civic_hive_devouring_swarm has_valid_civic = civic_machine_terminator } }
		allow = {
			custom_tooltip = {
				fail_text = leviathans.500.b.alreadyaided
				NOT = { has_modifier = curator_insight }
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.507 }
		}
	}

	option = { # Guardians
		name = leviathans.500.c
		custom_gui = "enclave_curator_option"
		trigger = { NOR = { has_valid_civic = civic_fanatic_purifiers has_valid_civic = civic_hive_devouring_swarm has_valid_civic = civic_machine_terminator } }
		hidden_effect = {
			country_event = { id = leviathans.508 }
		}
	}

	option = { # Hire Scientist
		name = leviathans.500.d
		custom_gui = "enclave_curator_option"
		trigger = { NOR = { has_valid_civic = civic_fanatic_purifiers has_valid_civic = civic_hive_devouring_swarm has_valid_civic = civic_machine_terminator } }
		allow = {
			custom_tooltip = {
				fail_text = leviathans.500.d.opinion
				event_target:curators = {
					trust = {
						who = root
						value >= 50
					}
				}
			}
			custom_tooltip = {
				fail_text = leviathans.500.d.alreadyrecruited
				NOT = {
					any_owned_leader = { has_trait = leader_trait_curator }
				}
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.590 }
		}
	}

	option = { # Sell Intel
		name = leviathans.500.h
		custom_gui = "enclave_curator_option"
		trigger = {
			is_homicidal = no
			any_country = {
				valid_curators_intel_trade_target = yes
			}
		}
		allow = {
			custom_tooltip = {
				fail_text = leviathans.500.d.opinion
				event_target:curators = {
					trust = {
						who = root
						value >= 50
					}
				}
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.599 }
		}
	}

	option = { # Think Tank
		name = leviathans.500.f
		custom_gui = "enclave_curator_option"
		trigger = {
			NOR = { has_valid_civic = civic_fanatic_purifiers has_valid_civic = civic_hive_devouring_swarm has_valid_civic = civic_machine_terminator }
			NOT = {
				event_target:curators = { has_country_flag = think_tank@root }
			}
			any_system_within_border = {
				has_star_flag = enclave
				any_fleet_in_system = {
					exists = owner
					owner = {
						is_same_value = event_target:curators
					}
				}
			}
		}
		allow = {
			custom_tooltip = {
				fail_text = leviathans.500.d.opinion
				event_target:curators = {
					trust = {
						who = root
						value >= 50
					}
				}
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.511 }
		}
	}
# Available after finishing Infinity Sphere chain
	option = {
		name = leviathans.500.g
		custom_gui = "enclave_curator_option"
		trigger = {
			has_country_flag = pantagruel
			has_country_flag = asked_about_infinity_machine
			NOT = { has_country_flag = offered_information }
		}
		hidden_effect = {
			country_event = { id = leviathans.4000 }
		}
	}

	# L-Cluster clue
	option = {
		name = distar.11500.a
		custom_gui = "enclave_curator_option"
		trigger = {
			has_event_chain = l_cluster_chain
			NOR = {
				is_homicidal = yes
				has_global_flag = l_cluster_opened
				has_completed_event_chain_counter = {
					event_chain = l_cluster_chain
					counter = clues
				}
			}
		}
		allow = {
			custom_tooltip = {
				fail_text = distar.11500.a.tooltip.noclue
				NOT = { has_country_flag = curator_clue_purchased }
			}
		}
		hidden_effect = {
			country_event = { id = distar.11501 }
		}
	}

	option = {
		name = leviathans.500.e
		default_hide_option = yes
		custom_gui = "enclave_curator_option"
		trigger = { NOR = { has_valid_civic = civic_fanatic_purifiers has_valid_civic = civic_hive_devouring_swarm has_valid_civic = civic_machine_terminator } }
		hidden_effect = {
			remove_country_flag = curator_enclave_diplomacy_engaged
		}
	}
}

country_event = {
	id = leviathans.4000
	title = leviathans.4000.name
	desc = leviathans.4000.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_curator_window"

	picture_event_data = {
		portrait = event_target:curators
		room = enclave_curator_room
	}

	immediate = {
		set_country_flag = curator_enclave_diplomacy_engaged
		if = {
			limit = {
					any_country = {
						is_country_type = default
						NOT = {
							is_same_value = root
						}
						OR = {
							is_hostile_to = root
							is_domineering_to = root
							is_unfriendly_to = root
							root = {
								OR = {
									is_hostile_to = prev
									is_domineering_to = prev
									is_unfriendly_to = prev
								}
							}
						}
					}
			}
			random_country = {
				limit = {
					any_country = {
						is_country_type = default
						NOT = {
							is_same_value = root
						}
						OR = {
							is_hostile_to = root
							is_domineering_to = root
							is_unfriendly_to = root
							root = {
								OR = {
									is_hostile_to = prev
									is_domineering_to = prev
									is_unfriendly_to = prev
								}
							}
						}
					}
				}
				save_event_target_as = unfriends
			}
		}
		else = {
			random_country = {
				limit = {
					is_country_type = default
					NOT = {
						is_same_value = root
					}
					has_communications = root
				}
				save_event_target_as = unfriends
			}
		}
	}

	after = {
		hidden_effect = {
			remove_country_flag = curator_enclave_diplomacy_engaged
		}
	}

	option = {
		name = leviathans.4000.a
		response_text = leviathans.4000.a.reply
		set_country_flag = offered_information
		custom_gui = "enclave_curator_option"
		add_monthly_resource_mult = {
			resource = engineering_research
			value = @tier4researchreward
			min = @tier4researchmin
			max = @tier4researchmax
		}
	}

	option = {
		name = leviathans.4000.b
		response_text = leviathans.4000.b.reply
		custom_gui = "enclave_curator_option"
		set_country_flag = offered_information
	}

	option = {
		name = leviathans.500.e
		default_hide_option = yes
		custom_gui = "enclave_curator_option"
		hidden_effect = {
			remove_country_flag = curator_enclave_diplomacy_engaged
		}
	}
}

# Curator Main Menu
country_event = {
	id = leviathans.505
	title = leviathans.500.name
	desc = leviathans.500a.desc
	desc = leviathans.500b.desc
	desc = leviathans.500c.desc
	desc = leviathans.500d.desc
	desc = leviathans.500e.desc
	desc = leviathans.500f.desc
	desc = leviathans.500g.desc
	desc = leviathans.500h.desc
	desc = leviathans.500i.desc
	desc = leviathans.500j.desc
	desc = leviathans.500k.desc
	desc = leviathans.500l.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_curator_window"

	picture_event_data = {
		portrait = event_target:curators
		room = enclave_curator_room
	}

	trigger = {
		NOT = { has_country_flag = curator_enclave_diplomacy_engaged }
	}

	immediate = {
		set_country_flag = curator_enclave_diplomacy_engaged
	}

	after = {
		hidden_effect = {
			remove_country_flag = curator_enclave_diplomacy_engaged
		}
	}

	option = { # Research
		name = leviathans.500.b
		custom_gui = "enclave_curator_option"
		allow = {
			custom_tooltip = {
				fail_text = leviathans.500.b.alreadyaided
				NOT = { has_modifier = curator_insight }
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.507 }
		}
	}

	option = { # Guardians
		name = leviathans.500.c
		custom_gui = "enclave_curator_option"
		hidden_effect = {
			country_event = { id = leviathans.508 }
		}
	}

	option = { # Hire Scientist
		name = leviathans.500.d
		custom_gui = "enclave_curator_option"

		allow = {
			custom_tooltip = {
				fail_text = leviathans.500.d.opinion
				event_target:curators = {
					trust = {
						who = root
						value >= 50
					}
				}
			}
			custom_tooltip = {
				fail_text = leviathans.500.d.alreadyrecruited
				NOT = {
					any_owned_leader = { has_trait = leader_trait_curator }
				}
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.590 }
		}
	}

	option = { # Sell Intel
		name = leviathans.500.h
		custom_gui = "enclave_curator_option"
		allow = {
			custom_tooltip = {
				fail_text = leviathans.500.d.opinion
				event_target:curators = {
					trust = {
						who = root
						value >= 50
					}
				}
			}
		}
		trigger = {
			any_country = {
				valid_curators_intel_trade_target = yes
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.599 }
		}
	}

	option = { # Think Tank
		name = leviathans.500.f
		custom_gui = "enclave_curator_option"
		trigger = {
			any_system_within_border = {
				has_star_flag = enclave
				any_fleet_in_system = {
					exists = owner
					owner = {
						is_same_value = event_target:curators
					}
				}
			}
		}
		allow = {
			custom_tooltip = {
				fail_text = leviathans.500.d.opinion
				event_target:curators = {
					trust = {
						who = root
						value >= 50
					}
				}
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.511 }
		}
	}

	option = {
		name = leviathans.500.g
		custom_gui = "enclave_curator_option"
		trigger = {
			has_country_flag = pantagruel
			has_country_flag = asked_about_infinity_machine
			NOT = { has_country_flag = offered_information }
		}
		hidden_effect = {
			country_event = { id = leviathans.4000 }
		}
	}

	option = {
		name = distar.11500.a
		custom_gui = "enclave_curator_option"
		trigger = {
			has_event_chain = l_cluster_chain
			NOR = {
				is_homicidal = yes
				has_global_flag = l_cluster_opened
				has_completed_event_chain_counter = {
					event_chain = l_cluster_chain
					counter = clues
				}
			}
		}
		allow = {
			custom_tooltip = {
				fail_text = distar.11500.a.tooltip.noclue
				NOT = { has_country_flag = curator_clue_purchased }
			}
		}
		hidden_effect = {
			country_event = { id = distar.11501 }
		}
	}

	option = {
		name = leviathans.500.e
		default_hide_option = yes
		custom_gui = "enclave_curator_option"
		hidden_effect = {
			remove_country_flag = curator_enclave_diplomacy_engaged
		}
	}
}

# Curator Research Aid Menu
country_event = {
	id = leviathans.507
	title = leviathans.507.name
	desc = leviathans.507.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_curator_window"

	picture_event_data = {
		portrait = event_target:curators
		room = enclave_curator_room
	}

	immediate = {
		set_country_flag = curator_enclave_diplomacy_engaged
	}

	after = {
		hidden_effect = {
			remove_country_flag = curator_enclave_diplomacy_engaged
		}
	}

	option = {
		name = leviathans.507.a
		response_text = leviathans.507.a.reply
		custom_gui = "enclave_curator_option"
		trigger = { num_pops < 61 }
		allow = {
			resource_stockpile_compare = { resource = energy value >= 1000 }
			hidden_trigger = {
				NOT = { has_country_flag = attacked_curators }
			}
		}
		add_resource = { energy = -1000 }
		custom_tooltip = opinion20
		add_modifier = {
			modifier = curator_insight
			days = 3600
		}
		hidden_effect = {
			event_target:curators = {
				add_trust = {
					who = root
					amount = 20
				}
			}
			set_relation_flag = {
				who = event_target:curators
				flag = curator_trade
			}
			country_event = { id = leviathans.509 days = 3600 }
		}
	}

	option = {
		name = leviathans.507.a
		response_text = leviathans.507.a.reply
		custom_gui = "enclave_curator_option"
		trigger = {
			num_pops > 60
			num_pops < 121
		}
		allow = {
			resource_stockpile_compare = { resource = energy value >= 2000 }
			hidden_trigger = {
				NOT = { has_country_flag = attacked_curators }
			}
		}
		add_resource = { energy = -2000 }
		add_modifier = {
			modifier = curator_insight
			days = 3600
		}
		custom_tooltip = opinion20
		hidden_effect = {
			event_target:curators = {
				add_trust = {
					who = root
					amount = 20
				}
			}
			set_relation_flag = {
				who = event_target:curators
				flag = curator_trade
			}
			country_event = { id = leviathans.509 days = 3600 }
		}
	}

	option = {
		name = leviathans.507.a
		response_text = leviathans.507.a.reply
		custom_gui = "enclave_curator_option"
		trigger = {
			num_pops > 120
			num_pops < 181
		}
		allow = {
			resource_stockpile_compare = { resource = energy value >= 3000 }
			hidden_trigger = {
				NOT = { has_country_flag = attacked_curators }
			}
		}
		add_resource = { energy = -3000 }
		add_modifier = {
			modifier = curator_insight
			days = 3600
		}
		custom_tooltip = opinion20
		hidden_effect = {
			event_target:curators = {
				add_trust = {
					who = root
					amount = 20
				}
			}
			set_relation_flag = {
				who = event_target:curators
				flag = curator_trade
			}
			country_event = { id = leviathans.509 days = 3600 }
		}
	}

	option = {
		name = leviathans.507.a
		response_text = leviathans.507.a.reply
		custom_gui = "enclave_curator_option"
		trigger = {
			num_pops > 180
			num_pops < 241
		}
		allow = {
			resource_stockpile_compare = { resource = energy value >= 4000 }
			hidden_trigger = {
				NOT = { has_country_flag = attacked_curators }
			}
		}
		add_resource = { energy = -4000 }
		add_modifier = {
			modifier = curator_insight
			days = 3600
		}
		custom_tooltip = opinion20
		hidden_effect = {
			event_target:curators = {
				add_trust = {
					who = root
					amount = 20
				}
			}
			set_relation_flag = {
				who = event_target:curators
				flag = curator_trade
			}
			country_event = { id = leviathans.509 days = 3600 }
		}
	}

	option = {
		name = leviathans.507.a
		response_text = leviathans.507.a.reply
		custom_gui = "enclave_curator_option"
		trigger = { num_pops > 240 }
		allow = {
			resource_stockpile_compare = { resource = energy value >= 5000 }
			hidden_trigger = {
				NOT = { has_country_flag = attacked_curators }
			}
		}
		add_resource = { energy = -5000 }
		add_modifier = {
			modifier = curator_insight
			days = 3600
		}
		custom_tooltip = opinion20
		hidden_effect = {
			event_target:curators = {
				add_trust = {
					who = root
					amount = 20
				}
			}
			set_relation_flag = {
				who = event_target:curators
				flag = curator_trade
			}
			country_event = { id = leviathans.509 days = 3600 }
		}
	}
	option = { # Back
		name = leviathans.506.d
		custom_gui = "enclave_curator_option"
		hidden_effect = {
			country_event = { id = leviathans.505 }
		}
	}
	option = { # Sign Off
		name = leviathans.506.e
		custom_gui = "enclave_curator_option"
		default_hide_option = yes
	}
}

# Curator Guardians Menu
country_event = {
	id = leviathans.508
	title = leviathans.508.name
	desc = leviathans.508.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_curator_window"

	picture_event_data = {
		portrait = event_target:curators
		room = enclave_curator_room
	}

	immediate = {
		set_country_flag = curator_enclave_diplomacy_engaged
	}

	after = {
		hidden_effect = {
			remove_country_flag = curator_enclave_diplomacy_engaged
		}
	}

	# "Find" option
	option = {
		name = leviathans.508.a
		response_text = leviathans.508.a.reply
		custom_gui = "enclave_curator_option"
		custom_tooltip = opinion10
		trigger = {
			any_country = {
				is_guardian_country = yes
				NOT = { is_country_type = guardian } #unused I think, but just in case
				NOT = {
					has_communications = root
				}
				num_fleets > 0
				any_owned_fleet = {
					exists = solar_system
					solar_system = {
						has_star_flag = guardian
						is_curator_guardian_poi = no
					}
				}
			}
		}
		allow = {
			resource_stockpile_compare = { resource = energy value >= 300 }
		}
		add_resource = { energy = -300 }
		hidden_effect = {
			event_target:curators = {
				add_trust = {
					who = root
					amount = 10
				}
			}
			capital_scope = {
				closest_system = {
					min_steps = 0
					max_steps = 999
					limit = {
						has_star_flag = guardian
						is_curator_guardian_poi = no
						any_fleet_in_system = {
							exists = owner
							owner = {
								is_guardian_country = yes
								NOT = { is_country_type = guardian }
								NOT = {
									has_communications = root
								}
							}
						}
					}
					random_fleet_in_system = {
						limit = {
							exists = owner
							owner = {
								is_guardian_country = yes
								NOT = { is_country_type = guardian }
								NOT = {
									has_communications = root
								}
							}
						}
						owner = {
							switch = {
								trigger = is_country_type
								guardian_dragon = {
									create_curator_guardian_poi = {
										POI = curator_poi_dragon
									}
								}
								guardian_sphere = {
									create_curator_guardian_poi = {
										POI = curator_poi_technosphere
									}
								}
								guardian_horror = {
									create_curator_guardian_poi = {
										POI = curator_poi_horror
									}
								}
								guardian_stellarite = {
									create_curator_guardian_poi = {
										POI = curator_poi_stellarite
									}
								}
								guardian_hiver = {
									create_curator_guardian_poi = {
										POI = curator_poi_hiver
									}
								}
								guardian_fortress = {
									create_curator_guardian_poi = {
										POI = curator_poi_fortress
									}
								}
								guardian_wraith = {
									create_curator_guardian_poi = {
										POI = curator_poi_wraith
									}
								}
								guardian_dreadnought = {
									create_curator_guardian_poi = {
										POI = curator_poi_dreadnought
									}
								}
								guardian_hatchling = {
									create_curator_guardian_poi = {
										POI = curator_poi_hatchling
									}
								}
								guardian_scavenger_bot = {
									create_curator_guardian_poi = {
										POI = curator_poi_scavenger_bot
									}
								}
								guardian_elderly_tiyanki = {
									create_curator_guardian_poi = {
										POI = curator_poi_tiyanki
									}
								}
								default = {
									log_error = "No option in leviathans.508.a for Leviathan country [This.GetCountryType]"
								}
							}
							break = yes
						}
					}
				}
			}
		}
	}

	# "Poison" options
	# Dragon
	option = {
		name = leviathans.508.b
		custom_gui = "enclave_curator_option"
		trigger = {
			any_country = {
				is_country_type = guardian_dragon
				has_communications = root
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.510 }
		}
	}
	# Enigmatic Fortress
	option = {
		name = leviathans.508.c
		custom_gui = "enclave_curator_option"
		trigger = {
			any_country = {
				is_country_type = guardian_fortress
				has_communications = root
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.515 }
		}
	}
	# Stellarite
	option = {
		name = leviathans.508.d
		custom_gui = "enclave_curator_option"
		trigger = {
			any_country = {
				is_country_type = guardian_stellarite
				has_communications = root
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.520 }
		}
	}
	# Dimensional Horror
	option = {
		name = leviathans.508.e
		custom_gui = "enclave_curator_option"
		trigger = {
			any_country = {
				is_country_type = guardian_horror
				has_communications = root
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.525 }
		}
	}
	# Hiver
	option = {
		name = leviathans.508.f
		custom_gui = "enclave_curator_option"
		trigger = {
			any_country = {
				is_country_type = guardian_hiver
				has_communications = root
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.530 }
		}
	}
	# Technosphere
	option = {
		name = leviathans.508.g
		custom_gui = "enclave_curator_option"
		trigger = {
			any_country = {
				is_country_type = guardian_sphere
				has_communications = root
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.535 }
		}
	}
	# Automated Dreadnought
	option = {
		name = leviathans.508.h
		custom_gui = "enclave_curator_option"
		trigger = {
			any_country = {
				is_country_type = guardian_dreadnought
				has_communications = root
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.540 }
		}
	}
	# Wraith
	option = {
		name = leviathans.508.i
		custom_gui = "enclave_curator_option"
		trigger = {
			any_country = {
				is_country_type = guardian_wraith
				has_communications = root
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.545 }
		}
	}
	# Hatchling
	option = {
		name = leviathans.508.j
		custom_gui = "enclave_curator_option"
		trigger = {
			any_country = {
				is_country_type = guardian_hatchling
				has_communications = root
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.550 }
		}
	}
	# Scavenger Bot
	option = {
		name = leviathans.508.k
		custom_gui = "enclave_curator_option"
		trigger = {
			any_country = {
				is_country_type = guardian_scavenger_bot
				has_communications = root
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.555 }
		}
	}
	# Tiyanki Matriarch
	option = {
		name = leviathans.508.l
		custom_gui = "enclave_curator_option"
		trigger = {
			any_country = {
				is_country_type = guardian_elderly_tiyanki
				has_communications = root
			}
		}
		hidden_effect = {
			country_event = { id = leviathans.556 }
		}
	}
	option = {
		name = leviathans.500.g
		custom_gui = "enclave_curator_option"
		trigger = {
			has_country_flag = pantagruel
			has_country_flag = asked_about_infinity_machine
			NOT = { has_country_flag = offered_information }
		}
		hidden_effect = {
			country_event = { id = leviathans.4000 }
		}
	}
	option = { # Back
		name = leviathans.506.d
		custom_gui = "enclave_curator_option"
		hidden_effect = {
			country_event = { id = leviathans.505 }
		}
	}
	option = { # Sign Off
		name = leviathans.506.e
		default_hide_option = yes
		custom_gui = "enclave_curator_option"
	}
}

# Continue Research Aid?
country_event = {
	id = leviathans.509
	title = leviathans.509.name
	desc = leviathans.509.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_curator_window"

	picture_event_data = {
		portrait = event_target:curators
		room = enclave_curator_room
	}

	trigger = {
		NOT = { has_country_flag = attacked_curators }
		exists = event_target:curators
	}

	immediate = {
		remove_relation_flag = {
			who = event_target:curators
			flag = curator_trade
		}
	}

	option = {
		name = leviathans.509.a
		response_text = leviathans.509.a.reply
		custom_gui = "enclave_curator_option"
		trigger = { num_pops < 61 }
		allow = {
			resource_stockpile_compare = { resource = energy value >= 1000 }
			hidden_trigger = {
				NOT = { has_country_flag = attacked_curators }
			}
		}
		add_resource = { energy = -1000 }
		custom_tooltip = opinion20
		add_modifier = {
			modifier = curator_insight
			days = 3600
		}
		hidden_effect = {
			event_target:curators = {
				add_trust = {
					who = root
					amount = 20
				}
			}
			set_relation_flag = {
				who = event_target:curators
				flag = curator_trade
			}
			country_event = { id = leviathans.509 days = 3600 }
		}
	}

	option = {
		name = leviathans.509.a
		response_text = leviathans.509.a.reply
		custom_gui = "enclave_curator_option"
		trigger = {
			num_pops > 60
			num_pops < 121
		}
		allow = {
			resource_stockpile_compare = { resource = energy value >= 2000 }
			hidden_trigger = {
				NOT = { has_country_flag = attacked_curators }
			}
		}
		add_resource = { energy = -2000 }
		add_modifier = {
			modifier = curator_insight
			days = 3600
		}
		custom_tooltip = opinion20
		hidden_effect = {
			event_target:curators = {
				add_trust = {
					who = root
					amount = 20
				}
			}
			set_relation_flag = {
				who = event_target:curators
				flag = curator_trade
			}
			country_event = { id = leviathans.509 days = 3600 }
		}
	}

	option = {
		name = leviathans.509.a
		response_text = leviathans.509.a.reply
		custom_gui = "enclave_curator_option"
		trigger = {
			num_pops > 120
			num_pops < 181
		}
		allow = {
			resource_stockpile_compare = { resource = energy value >= 3000 }
			hidden_trigger = {
				NOT = { has_country_flag = attacked_curators }
			}
		}
		add_resource = { energy = -3000 }
		add_modifier = {
			modifier = curator_insight
			days = 3600
		}
		custom_tooltip = opinion20
		hidden_effect = {
			event_target:curators = {
				add_trust = {
					who = root
					amount = 20
				}
			}
			set_relation_flag = {
				who = event_target:curators
				flag = curator_trade
			}
			country_event = { id = leviathans.509 days = 3600 }
		}
	}

	option = {
		name = leviathans.509.a
		response_text = leviathans.509.a.reply
		custom_gui = "enclave_curator_option"
		trigger = {
			num_pops > 180
			num_pops < 241
		}
		allow = {
			resource_stockpile_compare = { resource = energy value >= 4000 }
			hidden_trigger = {
				NOT = { has_country_flag = attacked_curators }
			}
		}
		add_resource = { energy = -4000 }
		add_modifier = {
			modifier = curator_insight
			days = 3600
		}
		custom_tooltip = opinion20
		hidden_effect = {
			event_target:curators = {
				add_trust = {
					who = root
					amount = 20
				}
			}
			set_relation_flag = {
				who = event_target:curators
				flag = curator_trade
			}
			country_event = { id = leviathans.509 days = 3600 }
		}
	}

	option = {
		name = leviathans.509.a
		response_text = leviathans.509.a.reply
		custom_gui = "enclave_curator_option"
		trigger = { num_pops > 240 }
		allow = {
			resource_stockpile_compare = { resource = energy value >= 5000 }
			hidden_trigger = {
				NOT = { has_country_flag = attacked_curators }
			}
		}
		add_resource = { energy = -5000 }
		add_modifier = {
			modifier = curator_insight
			days = 3600
		}
		custom_tooltip = opinion20
		hidden_effect = {
			event_target:curators = {
				add_trust = {
					who = root
					amount = 20
				}
			}
			set_relation_flag = {
				who = event_target:curators
				flag = curator_trade
			}
			country_event = { id = leviathans.509 days = 3600 }
		}
	}

	option = { # Sign Off
		name = leviathans.509.e
		custom_gui = "enclave_curator_option"
		default_hide_option = yes
	}
}

# Space Dragon
# Curator Guardians Menu
country_event = {
	id = leviathans.510
	title = leviathans.510.name
	desc = leviathans.510.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_curator_window"

	picture_event_data = {
		portrait = event_target:curators
		room = enclave_curator_room
	}

	immediate = {
		set_country_flag = curator_enclave_diplomacy_engaged
	}

	after = {
		hidden_effect = {
			remove_country_flag = curator_enclave_diplomacy_engaged
		}
	}

	option = {
		name = leviathans.510.a
		response_text = leviathans.510.a.reply
		is_dialog_only = yes
		custom_gui = "enclave_curator_option"
	}
	option = {
		name = leviathans.510.b
		response_text = leviathans.510.b.reply
		trigger = {
			NOT = { has_modifier = draconic_beats }
		}
		custom_gui = "enclave_curator_option"
		allow = {
			resource_stockpile_compare = { resource = energy value >= 1000 }
		}
		add_resource = { energy = -1000 }
		add_modifier = {
			modifier = draconic_beats
			days = -1
		}
		custom_tooltip = opinion20
		hidden_effect = {
			event_target:curators = {
				add_trust = {
					who = root
					amount = 20
				}
			}
		}
	}
	option = { # Can we fight it? (No)
		name = leviathans.506.f
		trigger = { fleet_power < 5000	}
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f1.reply
	}
	option = { # Can we fight it? (Probably not)
		name = leviathans.506.f
		trigger = {
			fleet_power > 5000
			fleet_power < 15000
		}
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f2.reply
	}
	option = { # Can we fight it? (Maybe)
		name = leviathans.506.f
		trigger = {
			fleet_power > 15000
			fleet_power < 30000
		}
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f3.reply
	}
	option = { # Can we fight it? (Yes)
		name = leviathans.506.f
		trigger = { fleet_power > 30000 }
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f4.reply
	}
	option = { # Back
		name = leviathans.506.d
		custom_gui = "enclave_curator_option"
		hidden_effect = {
			country_event = { id = leviathans.505 }
		}
	}
	option = { # Sign Off
		name = leviathans.506.e
		default_hide_option = yes
		custom_gui = "enclave_curator_option"
	}
}

# Curator Think Tank
country_event = {
	id = leviathans.511
	title = leviathans.511.name
	desc = leviathans.511.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_curator_window"

	picture_event_data = {
		portrait = event_target:curators
		room = enclave_curator_room
	}

	immediate = {
		set_country_flag = curator_enclave_diplomacy_engaged
		random_system_within_border = {
			limit = {
				any_fleet_in_system = {
					exists = owner
					owner = {
						is_same_value = event_target:curators
					}
				}
			}
			save_event_target_as = curator_system
		}
		event_target:curators = {
			set_country_flag = think_tank@root
		}
	}

	after = {
		hidden_effect = {
			remove_country_flag = curator_enclave_diplomacy_engaged
		}
	}

	option = { # Back
		name = leviathans.506.d
		custom_gui = "enclave_curator_option"
		hidden_effect = {
			country_event = { id = leviathans.505 }
		}
	}
	option = { # Sign Off
		name = leviathans.506.e
		default_hide_option = yes
		custom_gui = "enclave_curator_option"
	}
}

# Enigmatic Fortress
# Curator Guardians Menu
country_event = {
	id = leviathans.515
	title = leviathans.515.name
	desc = leviathans.515.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_curator_window"

	picture_event_data = {
		portrait = event_target:curators
		room = enclave_curator_room
	}

	immediate = {
		set_country_flag = curator_enclave_diplomacy_engaged
	}

	after = {
		hidden_effect = {
			remove_country_flag = curator_enclave_diplomacy_engaged
		}
	}

	option = {
		name = leviathans.515.a
		response_text = leviathans.515.a.reply
		is_dialog_only = yes
		custom_gui = "enclave_curator_option"
	}
	option = {
		name = leviathans.515.b
		response_text = leviathans.515.b.reply
		custom_gui = "enclave_curator_option"
		trigger = {
			NOT = { has_country_flag = bought_fortress_info_1 }
		}
		allow = {
			resource_stockpile_compare = { resource = energy value >= 200 }
		}
		hidden_effect = { set_country_flag = bought_fortress_info_1 }
		add_resource = { energy = -200 }
	}
	option = {
		name = leviathans.515.c
		response_text = leviathans.515.c.reply
		custom_gui = "enclave_curator_option"
		trigger = {
			NOT = { has_country_flag = bought_fortress_info_2 }
		}
		allow = {
			resource_stockpile_compare = { resource = energy value >= 200 }
		}
		hidden_effect = { set_country_flag = bought_fortress_info_2 }
		add_resource = { energy = -200 }
	}
	option = {
		name = leviathans.515.d
		response_text = leviathans.515.d.reply
		custom_gui = "enclave_curator_option"
		trigger = {
			NOT = { has_country_flag = bought_fortress_info_3 }
		}
		allow = {
			resource_stockpile_compare = { resource = energy value >= 200 }
		}
		hidden_effect = { set_country_flag = bought_fortress_info_3 }
		add_resource = { energy = -200 }
	}
	option = {
		name = leviathans.515.bb
		response_text = leviathans.515.b.reply
		custom_gui = "enclave_curator_option"
		trigger = {
			has_country_flag = bought_fortress_info_1
		}
	}
	option = {
		name = leviathans.515.cc
		response_text = leviathans.515.c.reply
		custom_gui = "enclave_curator_option"
		trigger = {
			has_country_flag = bought_fortress_info_2
		}
	}
	option = {
		name = leviathans.515.dd
		response_text = leviathans.515.d.reply
		custom_gui = "enclave_curator_option"
		trigger = {
			has_country_flag = bought_fortress_info_3
		}
	}
	option = { # Can we fight it? (No)
		name = leviathans.506.f
		trigger = { fleet_power < 5000	}
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f1.reply
	}
	option = { # Can we fight it? (Probably not)
		name = leviathans.506.f
		trigger = {
			fleet_power > 5000
			fleet_power < 15000
		}
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f2.reply
	}
	option = { # Can we fight it? (Maybe)
		name = leviathans.506.f
		trigger = {
			fleet_power > 15000
			fleet_power < 30000
		}
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f3.reply
	}
	option = { # Can we fight it? (Yes)
		name = leviathans.506.f
		trigger = { fleet_power > 30000 }
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f4.reply
	}
	option = { # Back
		name = leviathans.506.d
		custom_gui = "enclave_curator_option"
		hidden_effect = {
			country_event = { id = leviathans.505 }
		}
	}
	option = { # Sign Off
		name = leviathans.506.e
		default_hide_option = yes
		custom_gui = "enclave_curator_option"
	}
}

# Stellarite
# Curator Guardians Menu
country_event = {
	id = leviathans.520
	title = leviathans.520.name
	desc = leviathans.520.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_curator_window"

	picture_event_data = {
		portrait = event_target:curators
		room = enclave_curator_room
	}

	immediate = {
		set_country_flag = curator_enclave_diplomacy_engaged
	}

	after = {
		hidden_effect = {
			remove_country_flag = curator_enclave_diplomacy_engaged
		}
	}

	option = {
		name = leviathans.510.a
		response_text = leviathans.520.a.reply
		is_dialog_only = yes
		custom_gui = "enclave_curator_option"
	}
	option = {
		name = leviathans.510.b
		response_text = leviathans.520.b.reply
		trigger = {
			NOT = { has_modifier = curator_buff_stellarite }
		}
		custom_gui = "enclave_curator_option"
		allow = {
			resource_stockpile_compare = { resource = energy value >= 1000 }
		}
		add_resource = { energy = -1000 }
		add_modifier = {
			modifier = curator_buff_stellarite
			days = -1
		}
		custom_tooltip = opinion20
		hidden_effect = {
			event_target:curators = {
				add_trust = {
					who = root
					amount = 20
				}
			}
		}
	}
	option = { # Can we fight it? (No)
		name = leviathans.506.f
		trigger = { fleet_power < 5000	}
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f1.reply
	}
	option = { # Can we fight it? (Probably not)
		name = leviathans.506.f
		trigger = {
			fleet_power > 5000
			fleet_power < 15000
		}
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f2.reply
	}
	option = { # Can we fight it? (Maybe)
		name = leviathans.506.f
		trigger = {
			fleet_power > 15000
			fleet_power < 30000
		}
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f3.reply
	}
	option = { # Can we fight it? (Yes)
		name = leviathans.506.f
		trigger = { fleet_power > 30000 }
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f4.reply
	}
	option = { # Back
		name = leviathans.506.d
		custom_gui = "enclave_curator_option"
		hidden_effect = {
			country_event = { id = leviathans.505 }
		}
	}
	option = { # Sign Off
		name = leviathans.506.e
		default_hide_option = yes
		custom_gui = "enclave_curator_option"
	}
}

# Dimensional Horror
# Curator Guardians Menu
country_event = {
	id = leviathans.525
	title = leviathans.525.name
	desc = leviathans.525.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_curator_window"

	picture_event_data = {
		portrait = event_target:curators
		room = enclave_curator_room
	}

	immediate = {
		set_country_flag = curator_enclave_diplomacy_engaged
	}

	after = {
		hidden_effect = {
			remove_country_flag = curator_enclave_diplomacy_engaged
		}
	}

	option = {
		name = leviathans.525.a
		response_text = leviathans.525.a.reply
		is_dialog_only = yes
		custom_gui = "enclave_curator_option"
	}
	option = {
		name = leviathans.525.b
		response_text = leviathans.525.b.reply
		trigger = {
			NOT = { has_modifier = dimensional_horror_weak_points }
		}
		custom_gui = "enclave_curator_option"
		allow = {
			resource_stockpile_compare = { resource = energy value >= 1000 }
		}
		add_resource = { energy = -1000 }
		add_modifier = {
			modifier = dimensional_horror_weak_points
			days = -1
		}
		custom_tooltip = opinion20
		hidden_effect = {
			event_target:curators = {
				add_trust = {
					who = root
					amount = 20
				}
			}
		}
	}
	option = { # Can we fight it? (No)
		name = leviathans.506.f
		trigger = { fleet_power < 5000	}
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f1.reply
	}
	option = { # Can we fight it? (Probably not)
		name = leviathans.506.f
		trigger = {
			fleet_power > 5000
			fleet_power < 15000
		}
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f2.reply
	}
	option = { # Can we fight it? (Maybe)
		name = leviathans.506.f
		trigger = {
			fleet_power > 15000
			fleet_power < 30000
		}
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f3.reply
	}
	option = { # Can we fight it? (Yes)
		name = leviathans.506.f
		trigger = { fleet_power > 30000 }
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f4.reply
	}
	option = { # Back
		name = leviathans.506.d
		custom_gui = "enclave_curator_option"
		hidden_effect = {
			country_event = { id = leviathans.505 }
		}
	}
	option = { # Sign Off
		name = leviathans.506.e
		default_hide_option = yes
		custom_gui = "enclave_curator_option"
	}
}

# Hiver
# Curator Guardians Menu
country_event = {
	id = leviathans.530
	title = leviathans.530.name
	desc = leviathans.530.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_curator_window"

	picture_event_data = {
		portrait = event_target:curators
		room = enclave_curator_room
	}

	immediate = {
		set_country_flag = curator_enclave_diplomacy_engaged
	}

	after = {
		hidden_effect = {
			remove_country_flag = curator_enclave_diplomacy_engaged
		}
	}

	option = {
		name = leviathans.530.a
		response_text = leviathans.530.a.reply
		is_dialog_only = yes
		custom_gui = "enclave_curator_option"
	}
	option = {
		name = leviathans.530.b
		response_text = leviathans.530.b.reply
		trigger = {
			NOT = { has_modifier = asteroid_hive_weak_points }
		}
		custom_gui = "enclave_curator_option"
		allow = {
			resource_stockpile_compare = { resource = energy value >= 2000 }
		}
		add_resource = { energy = -2000 }
		add_modifier = {
			modifier = asteroid_hive_weak_points
			days = -1
		}
		custom_tooltip = opinion10
		hidden_effect = {
			event_target:curators = {
				add_trust = {
					who = root
					amount = 10
				}
			}
		}
	}
	option = { # Can we fight it? (No)
		name = leviathans.506.f
		trigger = { fleet_power < 5000	}
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f1.reply
	}
	option = { # Can we fight it? (Probably not)
		name = leviathans.506.f
		trigger = {
			fleet_power > 5000
			fleet_power < 15000
		}
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f2.reply
	}
	option = { # Can we fight it? (Maybe)
		name = leviathans.506.f
		trigger = {
			fleet_power > 15000
			fleet_power < 30000
		}
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f3.reply
	}
	option = { # Can we fight it? (Yes)
		name = leviathans.506.f
		trigger = { fleet_power > 30000 }
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f4.reply
	}
	option = { # Back
		name = leviathans.506.d
		custom_gui = "enclave_curator_option"
		hidden_effect = {
			country_event = { id = leviathans.505 }
		}
	}
	option = { # Sign Off
		name = leviathans.506.e
		default_hide_option = yes
		custom_gui = "enclave_curator_option"
	}
}

# Technosphere
# Curator Guardians Menu
country_event = {
	id = leviathans.535
	title = leviathans.535.name
	desc = leviathans.535.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_curator_window"

	picture_event_data = {
		portrait = event_target:curators
		room = enclave_curator_room
	}

	immediate = {
		set_country_flag = curator_enclave_diplomacy_engaged
		set_country_flag = asked_about_infinity_machine
	}

	after = {
		hidden_effect = {
			remove_country_flag = curator_enclave_diplomacy_engaged
		}
	}

	option = {
		name = leviathans.510.a
		response_text = leviathans.535.a.reply
		is_dialog_only = yes
		custom_gui = "enclave_curator_option"
	}
	option = {
		name = leviathans.510.b
		response_text = leviathans.535.b.reply
		trigger = {
			NOT = { has_modifier = curator_buff_sphere }
		}
		custom_gui = "enclave_curator_option"
		allow = {
			resource_stockpile_compare = { resource = energy value >= 600 }
		}
		add_resource = { energy = -600 }
		add_modifier = {
			modifier = curator_buff_sphere
			days = -1
		}
		custom_tooltip = opinion15
		hidden_effect = {
			event_target:curators = {
				add_trust = {
					who = root
					amount = 15
				}
			}
		}
	}
	option = { # Can we fight it? (No)
		name = leviathans.506.f
		trigger = { fleet_power < 5000	}
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f1.reply
	}
	option = { # Can we fight it? (Probably not)
		name = leviathans.506.f
		trigger = {
			fleet_power > 5000
			fleet_power < 15000
		}
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f2.reply
	}
	option = { # Can we fight it? (Maybe)
		name = leviathans.506.f
		trigger = {
			fleet_power > 15000
			fleet_power < 30000
		}
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f3.reply
	}
	option = { # Can we fight it? (Yes)
		name = leviathans.506.f
		trigger = { fleet_power > 30000 }
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f4.reply
	}
	option = { # Back
		name = leviathans.506.d
		custom_gui = "enclave_curator_option"
		hidden_effect = {
			country_event = { id = leviathans.505 }
		}
	}
	option = { # Sign Off
		name = leviathans.506.e
		default_hide_option = yes
		custom_gui = "enclave_curator_option"
	}
}

# Automated Dreadnought
# Curator Guardians Menu
country_event = {
	id = leviathans.540
	title = leviathans.540.name
	desc = leviathans.540.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_curator_window"

	picture_event_data = {
		portrait = event_target:curators
		room = enclave_curator_room
	}

	immediate = {
		set_country_flag = curator_enclave_diplomacy_engaged
	}

	after = {
		hidden_effect = {
			remove_country_flag = curator_enclave_diplomacy_engaged
		}
	}

	option = {
		name = leviathans.540.a
		response_text = leviathans.540.a.reply
		is_dialog_only = yes
		custom_gui = "enclave_curator_option"
	}
	option = {
		name = leviathans.540.b
		response_text = leviathans.540.b.reply
		trigger = {
			NOT = { has_modifier = automated_dreadnought_weak_points }
		}
		custom_gui = "enclave_curator_option"
		allow = {
			resource_stockpile_compare = { resource = energy value >= 1000 }
		}
		add_resource = { energy = -1000 }
		add_modifier = {
			modifier = automated_dreadnought_weak_points
			days = -1
		}
		custom_tooltip = opinion20
		hidden_effect = {
			event_target:curators = {
				add_trust = {
					who = root
					amount = 20
				}
			}
		}
	}
	option = { # Can we fight it? (No)
		name = leviathans.506.f
		trigger = { fleet_power < 5000	}
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f1.reply
	}
	option = { # Can we fight it? (Probably not)
		name = leviathans.506.f
		trigger = {
			fleet_power > 5000
			fleet_power < 15000
		}
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f2.reply
	}
	option = { # Can we fight it? (Maybe)
		name = leviathans.506.f
		trigger = {
			fleet_power > 15000
			fleet_power < 30000
		}
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f3.reply
	}
	option = { # Can we fight it? (Yes)
		name = leviathans.506.f
		trigger = { fleet_power > 30000 }
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f4.reply
	}
	option = { # Back
		name = leviathans.506.d
		custom_gui = "enclave_curator_option"
		hidden_effect = {
			country_event = { id = leviathans.505 }
		}
	}
	option = { # Sign Off
		name = leviathans.506.e
		default_hide_option = yes
		custom_gui = "enclave_curator_option"
	}
}

# Wraith
# Curator Guardians Menu
country_event = {
	id = leviathans.545
	title = leviathans.545.name
	desc = leviathans.545.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_curator_window"

	picture_event_data = {
		portrait = event_target:curators
		room = enclave_curator_room
	}

	immediate = {
		set_country_flag = curator_enclave_diplomacy_engaged
	}

	after = {
		hidden_effect = {
			remove_country_flag = curator_enclave_diplomacy_engaged
		}
	}

	option = {
		name = leviathans.545.a
		response_text = leviathans.545.a.reply
		is_dialog_only = yes
		custom_gui = "enclave_curator_option"
	}
	option = {
		name = leviathans.545.b
		response_text = leviathans.545.b.reply
		trigger = {
			NOT = { has_country_flag = bought_wraith_info_1 }
		}
		custom_gui = "enclave_curator_option"
		allow = {
			resource_stockpile_compare = { resource = energy value >= 200 }
		}
		hidden_effect = { set_country_flag = bought_wraith_info_1 }
		add_resource = { energy = -200 }
	}
	option = {
		name = leviathans.545.c
		response_text = leviathans.545.c.reply
		trigger = {
			NOT = { has_country_flag = bought_wraith_info_2 }
		}
		custom_gui = "enclave_curator_option"
		allow = {
			resource_stockpile_compare = { resource = energy value >= 200 }
		}
		hidden_effect = { set_country_flag = bought_wraith_info_2 }
		add_resource = { energy = -200 }
	}
	option = {
		name = leviathans.545.d
		response_text = leviathans.545.d.reply
		trigger = {
			NOT = { has_country_flag = bought_wraith_info_3 }
		}
		custom_gui = "enclave_curator_option"
		allow = {
			resource_stockpile_compare = { resource = energy value >= 200 }
		}
		hidden_effect = { set_country_flag = bought_wraith_info_3 }
		add_resource = { energy = -200 }
	}
	option = {
		name = leviathans.545.b
		response_text = leviathans.545.b.reply
		custom_gui = "enclave_curator_option"
		trigger = { has_country_flag = bought_wraith_info_1 }
	}
	option = {
		name = leviathans.545.c
		response_text = leviathans.545.c.reply
		custom_gui = "enclave_curator_option"
		trigger = { has_country_flag = bought_wraith_info_2 }
	}
	option = {
		name = leviathans.545.d
		response_text = leviathans.545.d.reply
		custom_gui = "enclave_curator_option"
		trigger = { has_country_flag = bought_wraith_info_3 }
	}
	option = { # Can we fight it? (No)
		name = leviathans.506.f
		trigger = { fleet_power < 5000	}
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f1.reply
	}
	option = { # Can we fight it? (Probably not)
		name = leviathans.506.f
		trigger = {
			fleet_power > 5000
			fleet_power < 15000
		}
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f2.reply
	}
	option = { # Can we fight it? (Maybe)
		name = leviathans.506.f
		trigger = {
			fleet_power > 15000
			fleet_power < 30000
		}
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f3.reply
	}
	option = { # Can we fight it? (Yes)
		name = leviathans.506.f
		trigger = { fleet_power > 30000 }
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f4.reply
	}
	option = { # Back
		name = leviathans.506.d
		custom_gui = "enclave_curator_option"
		hidden_effect = {
			country_event = { id = leviathans.505 }
		}
	}
	option = { # Sign Off
		name = leviathans.506.e
		default_hide_option = yes
		custom_gui = "enclave_curator_option"
	}
}

# Hatchling
# Curator Guardians Menu
country_event = {
	id = leviathans.550
	title = leviathans.550.name
	desc = leviathans.550.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_curator_window"

	picture_event_data = {
		portrait = event_target:curators
		room = enclave_curator_room
	}

	immediate = {
		set_country_flag = curator_enclave_diplomacy_engaged
	}

	after = {
		hidden_effect = {
			remove_country_flag = curator_enclave_diplomacy_engaged
		}
	}

	option = {
		name = leviathans.550.a
		response_text = leviathans.550.a.reply
		is_dialog_only = yes
		custom_gui = "enclave_curator_option"
	}
	option = {
		name = leviathans.550.b
		response_text = leviathans.550.b.reply
		trigger = {
			NOT = { has_modifier = curator_buff_hatchling }
		}
		custom_gui = "enclave_curator_option"
		allow = {
			resource_stockpile_compare = { resource = energy value >= 1000 }
		}
		add_resource = { energy = -1000 }
		add_modifier = {
			modifier = curator_buff_hatchling
			days = -1
		}
		custom_tooltip = opinion20
		hidden_effect = {
			event_target:curators = {
				add_trust = {
					who = root
					amount = 20
				}
			}
		}
	}
	option = { # Can we fight it? (No)
		name = leviathans.506.f
		trigger = { fleet_power < 5000	}
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f1.reply
	}
	option = { # Can we fight it? (Probably not)
		name = leviathans.506.f
		trigger = {
			fleet_power > 5000
			fleet_power < 15000
		}
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f2.reply
	}
	option = { # Can we fight it? (Maybe)
		name = leviathans.506.f
		trigger = {
			fleet_power > 15000
			fleet_power < 30000
		}
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f3.reply
	}
	option = { # Can we fight it? (Yes)
		name = leviathans.506.f
		trigger = { fleet_power > 30000 }
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f4.reply
	}
	option = { # Back
		name = leviathans.506.d
		custom_gui = "enclave_curator_option"
		hidden_effect = {
			country_event = { id = leviathans.505 }
		}
	}
	option = { # Sign Off
		name = leviathans.506.e
		default_hide_option = yes
		custom_gui = "enclave_curator_option"
	}
}
# Scavenger Bot
# Curator Guardians Menu
country_event = {
	id = leviathans.555
	title = leviathans.555.name
	desc = leviathans.555.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_curator_window"

	picture_event_data = {
		portrait = event_target:curators
		room = enclave_curator_room
	}

	immediate = {
		set_country_flag = curator_enclave_diplomacy_engaged
	}

	after = {
		hidden_effect = {
			remove_country_flag = curator_enclave_diplomacy_engaged
		}
	}

	option = {
		name = leviathans.555.a
		response_text = leviathans.555.a.reply
		trigger = {
			NOT = { has_country_flag = bought_scavenger_info_1 }
		}
		custom_gui = "enclave_curator_option"
		is_dialog_only = yes
		hidden_effect = { set_country_flag = bought_scavenger_info_1 }
	}
	option = {
		name = leviathans.555.b
		response_text = leviathans.555.b.reply
		trigger = {
			NOT = { has_country_flag = bought_scavenger_info_2 }
		}
		custom_gui = "enclave_curator_option"
		is_dialog_only = yes
		hidden_effect = { set_country_flag = bought_scavenger_info_2 }
	}
	option = {
		name = leviathans.555.c
		response_text = leviathans.555.c.reply
		trigger = {
			NOT = { has_modifier = scavenger_weak_points }
		}
		custom_gui = "enclave_curator_option"
		allow = {
			resource_stockpile_compare = { resource = energy value >= 1000 }
		}
		add_resource = { energy = -1000 }
		add_modifier = {
			modifier = scavenger_weak_points
			days = -1
		}
		custom_tooltip = opinion20
		hidden_effect = {
			event_target:curators = {
				add_trust = {
					who = root
					amount = 20
				}
			}
		}
	}
	option = {
		name = leviathans.555.aa
		response_text = leviathans.555.b.reply
		trigger = {
			has_country_flag = bought_scavenger_info_1
		}
		custom_gui = "enclave_curator_option"
		is_dialog_only = yes
	}
	option = {
		name = leviathans.555.bb
		response_text = leviathans.555.b.reply
		trigger = {
			has_country_flag = bought_scavenger_info_2
		}
		custom_gui = "enclave_curator_option"
		is_dialog_only = yes
	}
	option = { # Can we fight it? (No)
		name = leviathans.506.f
		trigger = { fleet_power < 5000	}
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f1.reply
	}
	option = { # Can we fight it? (Probably not)
		name = leviathans.506.f
		trigger = {
			fleet_power > 5000
			fleet_power < 15000
		}
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f2.reply
	}
	option = { # Can we fight it? (Maybe)
		name = leviathans.506.f
		trigger = {
			fleet_power > 15000
			fleet_power < 30000
		}
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f3.reply
	}
	option = { # Can we fight it? (Yes)
		name = leviathans.506.f
		trigger = { fleet_power > 30000 }
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f4.reply
	}
	option = { # Back
		name = leviathans.506.d
		custom_gui = "enclave_curator_option"
		hidden_effect = {
			country_event = { id = leviathans.505 }
		}
	}
	option = { # Sign Off
		name = leviathans.506.e
		default_hide_option = yes
		custom_gui = "enclave_curator_option"
	}
}
# Tiyanki Matriarch
# Curator Guardians Menu
country_event = {
	id = leviathans.556
	title = leviathans.556.name
	desc = leviathans.556.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_curator_window"

	picture_event_data = {
		portrait = event_target:curators
		room = enclave_curator_room
	}

	immediate = {
		set_country_flag = curator_enclave_diplomacy_engaged
	}

	after = {
		hidden_effect = {
			remove_country_flag = curator_enclave_diplomacy_engaged
		}
	}

	option = {
		name = leviathans.556.a
		response_text = leviathans.556.a.reply
		trigger = {
			NOT = { has_country_flag = bought_matriarch_info_1 }
		}
		custom_gui = "enclave_curator_option"
		is_dialog_only = yes
		hidden_effect = { set_country_flag = bought_matriarch_info_1 }
	}
	option = {
		name = leviathans.556.b
		response_text = leviathans.556.b.reply
		trigger = {
			NOT = { has_country_flag = bought_matriarch_info_2 }
		}
		custom_gui = "enclave_curator_option"
		is_dialog_only = yes
		hidden_effect = { set_country_flag = bought_matriarch_info_2 }
	}
	option = {
		name = leviathans.556.c
		response_text = leviathans.556.c.reply
		trigger = {
			NOT = { has_modifier = elderly_tiyanki_weak_points }
		}
		custom_gui = "enclave_curator_option"
		allow = {
			resource_stockpile_compare = { resource = energy value >= 1000 }
		}
		add_resource = { energy = -1000 }
		add_modifier = {
			modifier = elderly_tiyanki_weak_points
			days = -1
		}
		custom_tooltip = opinion20
		hidden_effect = {
			event_target:curators = {
				add_trust = {
					who = root
					amount = 20
				}
			}
		}
	}
	option = {
		name = leviathans.556.aa
		response_text = leviathans.556.a.reply
		trigger = {
			has_country_flag = bought_matriarch_info_1
		}
		custom_gui = "enclave_curator_option"
		is_dialog_only = yes
	}
	option = {
		name = leviathans.556.bb
		response_text = leviathans.556.b.reply
		trigger = {
			has_country_flag = bought_matriarch_info_2
		}
		custom_gui = "enclave_curator_option"
		is_dialog_only = yes
	}
	option = { # Can we fight it? (No)
		name = leviathans.506.f
		trigger = { fleet_power < 5000	}
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f1.reply
	}
	option = { # Can we fight it? (Probably not)
		name = leviathans.506.f
		trigger = {
			fleet_power > 5000
			fleet_power < 15000
		}
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f2.reply
	}
	option = { # Can we fight it? (Maybe)
		name = leviathans.506.f
		trigger = {
			fleet_power > 15000
			fleet_power < 30000
		}
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f3.reply
	}
	option = { # Can we fight it? (Yes)
		name = leviathans.506.f
		trigger = { fleet_power > 30000 }
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f4.reply
	}
	option = { # Back
		name = leviathans.506.d
		custom_gui = "enclave_curator_option"
		hidden_effect = {
			country_event = { id = leviathans.505 }
		}
	}
	option = { # Sign Off
		name = leviathans.506.e
		default_hide_option = yes
		custom_gui = "enclave_curator_option"
	}
}

# Curator Hire Scientist Menu
country_event = {
	id = leviathans.590
	title = leviathans.590.name
	desc = leviathans.590.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_curator_window"

	picture_event_data = {
		portrait = event_target:curators
		room = enclave_curator_room
	}

	immediate = {
		set_country_flag = curator_enclave_diplomacy_engaged
		event_target:curators = {
			owner_species = { save_event_target_as = curator_species }
		}
	}

	after = {
		hidden_effect = {
			remove_country_flag = curator_enclave_diplomacy_engaged
		}
	}

	option = {
		name = leviathans.590.a
		response_text = leviathans.590.a.reply
		custom_gui = "enclave_curator_option"
		allow = {
			resource_stockpile_compare = { resource = energy value >= 1000 }
			hidden_trigger = {
				NOT = {
					has_country_flag = attacked_curators
				}
			}
			NOT = {
				root = {
					any_owned_leader = {
						has_trait = leader_trait_curator
					}
				}
			}
		}
		add_resource = { energy = -1000 }
		custom_tooltip = opinion20
		hidden_effect = {
			set_country_flag = curator_scientist_recruited
			event_target:curators = {
				add_trust = {
					who = root
					amount = 20
				}
			}
			random_list = {
				20 = {
					create_leader = {
						class = scientist
						species = event_target:curator_species
						name = "NAME_Professor_Zarg"
						skill = 5
						traits = {
							trait = leader_trait_curator
						}
						event_leader = yes	# prevents this leader from leading factions and winning elections
					}
					last_created_leader = {
						set_age = 41
					}
				}
				20 = {
					create_leader = {
						class = scientist
						species = event_target:curator_species
						name = "NAME_Doctor_Xib"
						skill = 5
						traits = {
							trait = leader_trait_curator
						}
						event_leader = yes	# prevents this leader from leading factions and winning elections
					}
					last_created_leader = {
						set_age = 45
					}
				}
				20 = {
					create_leader = {
						class = scientist
						species = event_target:curator_species
						name = "NAME_The_Mentat"
						skill = 5
						traits = {
							trait = leader_trait_curator
						}
						event_leader = yes	# prevents this leader from leading factions and winning elections
					}
					last_created_leader = {
						set_age = 43
					}
				}
				20 = {
					create_leader = {
						class = scientist
						species = event_target:curator_species
						name = "NAME_Kix_the_Brilliant"
						skill = 5
						traits = {
							trait = leader_trait_curator
						}
						event_leader = yes	# prevents this leader from leading factions and winning elections
					}
					last_created_leader = {
						set_age = 47
					}
				}
				20 = {
					create_leader = {
						class = scientist
						species = event_target:curator_species
						name = "NAME_Sensei_Borkaz"
						skill = 5
						traits = {
							trait = leader_trait_curator
						}
						event_leader = yes	# prevents this leader from leading factions and winning elections
					}
					last_created_leader = {
						set_age = 42
					}
				}
			}
		}
	}
	option = { # Back
		name = leviathans.506.d
		custom_gui = "enclave_curator_option"
		hidden_effect = {
			country_event = { id = leviathans.505 }
		}
	}
	option = { # Sign Off
		name = leviathans.506.e
		custom_gui = "enclave_curator_option"
		default_hide_option = yes
	}
}

# Curator Buy Intel Menu
country_event = {
	id = leviathans.599
	title = leviathans.599.name
	desc = leviathans.599.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_curator_window"

	picture_event_data = {
		portrait = event_target:curators
		room = enclave_curator_room
	}

	immediate = {
		set_country_flag = curator_enclave_diplomacy_engaged
		event_target:curators = {
			owner_species = { save_event_target_as = curator_species }
		}
		random_country = {
			limit = {
				valid_curators_intel_trade_target = yes
			}
			save_event_target_as = curator_customer_1
			random_country = {
				limit = {
					NOT = { is_same_value = event_target:curator_customer_1 }
					valid_curators_intel_trade_target = yes
				}
				save_event_target_as = curator_customer_2
				random_country = {
					limit = {
						NOT = { is_same_value = event_target:curator_customer_1 }
						NOT = { is_same_value = event_target:curator_customer_2 }
						valid_curators_intel_trade_target = yes
					}
					save_event_target_as = curator_customer_3
					random_country = {
						limit = {
							NOT = { is_same_value = event_target:curator_customer_1 }
							NOT = { is_same_value = event_target:curator_customer_2 }
							NOT = { is_same_value = event_target:curator_customer_3 }
							valid_curators_intel_trade_target = yes
						}
						save_event_target_as = curator_customer_4
					}
				}
			}
		}
	}

	after = {
		hidden_effect = {
			remove_country_flag = curator_enclave_diplomacy_engaged
		}
	}

	option = {
		name = leviathans.599.a
		response_text = leviathans.599.yes.reply
		custom_gui = "enclave_curator_option"
		allow = {
			resource_stockpile_compare = { resource = energy value >= 1000 }
		}
		trigger = {
			exists = event_target:curator_customer_1
		}
		add_resource = { energy = -1000 }
		custom_tooltip = opinion10
		hidden_effect = {
			event_target:curators = {
				add_trust = {
					who = root
					amount = 10
				}
			}
			set_timed_relation_flag = {
				who = event_target:curator_customer_1
				flag = curator_bought_intel_on
				years = 10
			}
		}
		add_intel = {
			who = event_target:curator_customer_1
			amount = 20
		}
	}
	option = {
		name = leviathans.599.b
		response_text = leviathans.599.yes.reply
		custom_gui = "enclave_curator_option"
		allow = {
			resource_stockpile_compare = { resource = energy value >= 1000 }
		}
		trigger = {
			exists = event_target:curator_customer_2
		}
		add_resource = { energy = -1000 }
		custom_tooltip = opinion10
		hidden_effect = {
			event_target:curators = {
				add_trust = {
					who = root
					amount = 10
				}
			}
			set_timed_relation_flag = {
				who = event_target:curator_customer_2
				flag = curator_bought_intel_on
				years = 10
			}
		}
		add_intel = {
			who = event_target:curator_customer_2
			amount = 20
		}
	}
	option = {
		name = leviathans.599.c
		response_text = leviathans.599.yes.reply
		custom_gui = "enclave_curator_option"
		allow = {
			resource_stockpile_compare = { resource = energy value >= 1000 }
		}
		trigger = {
			exists = event_target:curator_customer_3
		}
		add_resource = { energy = -1000 }
		custom_tooltip = opinion10
		hidden_effect = {
			event_target:curators = {
				add_trust = {
					who = root
					amount = 10
				}
			}
			set_timed_relation_flag = {
				who = event_target:curator_customer_3
				flag = curator_bought_intel_on
				years = 10
			}
		}
		add_intel = {
			who = event_target:curator_customer_3
			amount = 20
		}
	}
	option = {
		name = leviathans.599.d
		response_text = leviathans.599.yes.reply
		custom_gui = "enclave_curator_option"
		allow = {
			resource_stockpile_compare = { resource = energy value >= 1000 }
		}
		trigger = {
			exists = event_target:curator_customer_4
		}
		add_resource = { energy = -1000 }
		custom_tooltip = opinion10
		hidden_effect = {
			event_target:curators = {
				add_trust = {
					who = root
					amount = 10
				}
			}
			set_timed_relation_flag = {
				who = event_target:curator_customer_4
				flag = curator_bought_intel_on
				years = 10
			}
		}
		add_intel = {
			who = event_target:curator_customer_4
			amount = 20
		}
	}
	option = { # Back
		name = leviathans.506.d
		custom_gui = "enclave_curator_option"
		hidden_effect = {
			country_event = { id = leviathans.505 }
		}
	}
	option = { # Sign Off
		name = leviathans.506.e
		custom_gui = "enclave_curator_option"
		default_hide_option = yes
	}
}

# Port
country_event = {
	id = leviathans.501
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		from = {
			country_event = { id = leviathans.502 }
		}
	}
}

# Curator Introduction
country_event = {
	id = leviathans.502
	title = leviathans.502.name

	desc = {
		text = leviathans.502a.desc
		trigger = {
			NOT = { has_country_flag = curator_intro }
		}
	}
	desc = {
		text = leviathans.502b.desc
		trigger = { has_country_flag = curator_intro }
	}

	diplomatic = yes
	custom_gui = "enclave_curator_window"

	picture_event_data = {
		portrait = from
		room = enclave_curator_room
	}

	is_triggered_only = yes

	after = {
		if = {
			limit = {
				NOT = { has_country_flag = curator_intro }
			}
			set_country_flag = curator_intro
		}
	}

	option = {
		name = leviathans.502.a
		custom_gui = "enclave_curator_option"
		trigger = {
			NOR = { has_valid_civic = civic_fanatic_purifiers has_valid_civic = civic_hive_devouring_swarm has_valid_civic = civic_machine_terminator }
		}
	}

	option = {
		name = SCUM
		custom_gui = "enclave_curator_option"
		trigger = {
			has_valid_civic = civic_fanatic_purifiers
		}
	}

	option = {
		name = TASTY
		custom_gui = "enclave_curator_option"
		trigger = {
			has_valid_civic = civic_hive_devouring_swarm
		}
	}

	option = {
		name = EXTERMINATE
		custom_gui = "enclave_curator_option"
		trigger = {
			has_valid_civic = civic_machine_terminator
		}
	}
}

# Enclave Communication Spread
country_event = {
	id = leviathans.560
	hide_window = yes

	trigger = {
		is_country_type = enclave
		any_relation = {
			is_country_type = default
			any_relation = {
				is_country_type = default
				NOT = { has_communications = ROOT }
			}
		}
	}

	mean_time_to_happen = {
		months = 160
	}

	immediate = {
		random_relation = {
			limit = {
				any_relation = {
					is_country_type = default
					NOT = { has_communications = ROOT }
				}
			}
			random_relation = {
				limit = {
					is_country_type = default
					NOT = { has_communications = ROOT }
				}
				root = { establish_communications_no_message = prev }
				country_event = { id = leviathans.98 }
			}
		}
	}
}

# Curator Destroyed (HIDDEN)
country_event = {
	id = leviathans.592
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		is_country_type = enclave
		has_country_flag = curator_enclave_country
		FROMFROM = {
			is_ship_size = enclave_station
		}
	}

	immediate = {
		FROMFROM = {
			solar_system = { save_event_target_as = curator_system }
		}
		FROM = {
			country_event = { id = leviathans.593 }
			save_event_target_as = curator_destroyer
		}
		observer_event = { id = observer.7 }
		every_country = {
			limit = {
				has_communications = ROOT
				NOT = { is_country = event_target:curator_destroyer }
				is_country_type = default
			}
			country_event = { id = leviathans.594 }
		}
	}
}

# Curator Destroyed (Destroyer)
country_event = {
	id = leviathans.593
	title = "leviathans.593"
	desc = "leviathans.593.desc"
	picture = GFX_evt_space_debris
	location = event_target:curator_system
	show_sound = event_ship_bridge

	is_triggered_only = yes

	immediate = {
		set_country_flag = destroyed_curator
		if = {
			limit = {
				has_modifier = curator_insight
				has_relation_flag = {
					who = FROM
					flag = curator_trade
				}
			}
			remove_modifier = "curator_insight"
			remove_relation_flag = {
				who = FROM
				flag = curator_trade
			}
		}
	}

	option = {
		name = EXCELLENT
		add_resource = {
			physics_research = 1000
			society_research = 1000
			engineering_research = 1000
		}
		if = {
			limit = { has_ancrel = yes }
			medium_artifact_reward = yes
		}
	}
}

# Curator Destroyed
country_event = {
	id = leviathans.594
	title = "leviathans.593"
	desc = {
		text = leviathans.594.a.desc
		trigger = {
			NOT = {
				has_relation_flag = {
					who = FROM
					flag = curator_trade
				}
			}
			has_communications = event_target:curator_destroyer
		}
	}
	desc = {
		text = leviathans.594.b.desc
		trigger = {
			NOT = {
				has_relation_flag = {
					who = FROM
					flag = curator_trade
				}
			}
			NOT = { has_communications = event_target:curator_destroyer }
		}
	}
	desc = {
		text = leviathans.594.c.desc
		trigger = {
			has_relation_flag = {
				who = FROM
				flag = curator_trade
			}
			FROM = {
				count_owned_ship = {
					limit = { is_ship_size = enclave_station }
					count < 1
				}
			}
			has_communications = event_target:curator_destroyer
		}
	}
	desc = {
		text = leviathans.594.d.desc
		trigger = {
			has_relation_flag = {
				who = FROM
				flag = curator_trade
			}
			FROM = {
				count_owned_ship = {
					limit = { is_ship_size = enclave_station }
					count < 1
				}
			}
			NOT = { has_communications = event_target:curator_destroyer }
		}
	}
	picture = GFX_evt_exploding_ship
	location = event_target:curator_system
	show_sound = event_ship_explosion

	is_triggered_only = yes

	immediate = {
		if = {
			limit = {
				has_modifier = curator_insight
				has_relation_flag = {
					who = FROM
					flag = curator_trade
				}
				FROM = {
					count_owned_ship = {
						limit = { is_ship_size = enclave_station }
						count < 1
					}
				}
			}
			remove_modifier = "curator_insight"
		}
		if = {
			limit = {
				has_relation_flag = {
					who = FROM
					flag = curator_trade
				}
				FROM = {
					count_owned_ship = {
						limit = { is_ship_size = enclave_station }
						count < 1
					}
				}
				is_ai = yes
			}
			add_opinion_modifier = {
				who = event_target:curator_destroyer
				modifier = opinion_destroyed_curator_insight
			}
		}
		if = {
			limit = {
				NOT = {
					has_relation_flag = {
						who = FROM
						flag = curator_trade
					}
				}
				is_ai = yes
			}
			add_opinion_modifier = {
				who = event_target:curator_destroyer
				modifier = opinion_destroyed_curator
			}
		}
	}

	option = {
		name = "leviathans.594.a"
		trigger = {
			NOT = {
				has_relation_flag = {
					who = FROM
					flag = curator_trade
				}
			}
		}
	}
	option = {
		name = "leviathans.594.b"
		trigger = {
			has_relation_flag = {
				who = FROM
				flag = curator_trade
			}
			FROM = {
				count_owned_ship = {
					limit = { is_ship_size = enclave_station }
					count < 1
				}
			}
		}
		hidden_effect = {
			remove_relation_flag = {
				who = FROM
				flag = curator_trade
			}
		}
	}
}

# Attacked Curators (HIDDEN)
country_event = {
	id = leviathans.595
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		is_country_type = default
		FROM = { has_country_flag = curator_enclave_country }
	}

	immediate = {
		FROM = {
			save_event_target_as = curators
			add_trust = {
				who = ROOT
				amount = -100
			}
		}
		set_country_flag = attacked_curators
		if = {
			limit = { has_modifier = curator_insight }
			remove_modifier = curator_insight
			country_event = { id = leviathans.596}
		}
	}
}

# Attacked Curators - Research Agreement Terminated
country_event = {
	id = leviathans.596
	title = leviathans.500.name
	desc = leviathans.596.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_curator_window"

	picture_event_data = {
		portrait = event_target:curators
		room = enclave_curator_room
	}

	option = {
		name = leviathans.156.a
		custom_gui = "enclave_curator_option"
	}
}

# Attacked Curators - Refuses Communications
country_event = {
	id = leviathans.597
	title = leviathans.500.name
	desc = leviathans.597a.desc
	desc = leviathans.597b.desc
	desc = leviathans.597c.desc
	desc = leviathans.597d.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_curator_window"
	force_open = yes

	picture_event_data = {
		portrait = event_target:curators
		room = enclave_curator_room
	}

	trigger = {
		FROM = {
			is_country_type = enclave
			has_country_flag = curator_enclave_country
		}
		has_country_flag = attacked_curators
		NOT = { has_country_flag = curator_enclave_diplomacy_engaged }
	}

	immediate = {
		set_country_flag = curator_enclave_diplomacy_engaged
		FROM = { save_event_target_as = curators }
	}

	after = {
		hidden_effect = {
			remove_country_flag = curator_enclave_diplomacy_engaged
		}
	}

	option = {
		name = SCUM
		trigger = { has_valid_civic = civic_fanatic_purifiers }
		custom_gui = "enclave_curator_option"
	}

	option = {
		name = TASTY
		trigger = { has_valid_civic = civic_hive_devouring_swarm }
		custom_gui = "enclave_curator_option"
	}

	option = {
		name = EXTERMINATE
		trigger = {
			has_valid_civic = civic_machine_terminator
		}
		custom_gui = "enclave_curator_option"
	}

	option = {
		name = leviathans.156.a
		custom_gui = "enclave_curator_option"
		trigger = { NOR = { has_valid_civic = civic_fanatic_purifiers has_valid_civic = civic_hive_devouring_swarm has_valid_civic = civic_machine_terminator } }
		default_hide_option = yes
	}
}

# RESTART DEBUG
fleet_event = {
	id = leviathans.601
	hide_window = yes
	trigger = { always = no }
	immediate = { fleet_event = { id = leviathans.602 } }
}
fleet_event = {
	id = leviathans.602
	hide_window = yes
	trigger = { always = no }
	immediate = { owner = { country_event = { id = leviathans.640 } } }
}

# Encounter
fleet_event = {
	id = leviathans.610
	title = leviathans.610.name
	desc = leviathans.610.desc
	picture = GFX_evt_space_dragon
	location = from
	show_sound = event_yellow_alert

	is_triggered_only = yes

	trigger = {
		from = {
			has_star_flag = guardians_dragon_system
			any_fleet_in_system = { is_ship_size = space_dragon_red }
		}
		owner = {
			NOT = {
				has_country_flag = dragon_encounter
			}
			OR = {
				is_country_type = default
				is_country_type = fallen_empire
				is_country_type = awakened_fallen_empire
			}
		}
	}

	immediate = {
		owner = {
			set_country_flag = dragon_encounter
		}
	}

	option = {
		name = leviathans.610.a
	}
}

# Restart mission after battle
# Ariphaos note: The dragon_mission flags don't get set anywhere.
country_event = {
	id = leviathans.640
	hide_window = yes
	trigger = {
		is_country_type = guardian_dragon
		has_country_flag = dragon_country
		fromfrom = {
			has_hp_percentage > 0.15
			solar_system = {
				NOT = {
					has_star_flag = guardians_dragon_system
				}
			}
		}
	}

	is_triggered_only = yes

	immediate = {
		fromfrom = {
			if = {
				limit = {
					has_fleet_flag = dragon_mission_1
				}
				queue_actions = {
					repeat = {
						find_closest_system = {
							trigger = {
								id = dragon.1.retaliation.1x
								has_star_flag = system_target_1
							}
							found_system = {
								move_to = this
								find_closest_planet = {
									trigger = {
										id = dragon.1.retaliation.2x
										is_star = yes
									}
									found_planet = {
										move_to = this
										wait = {
											duration = 60
										}
										effect = {
											id = dragon.1.retaliation.3x
											solar_system = {
												remove_star_flag = system_target_1
											}
											fromfrom = {
												remove_fleet_flag = dragon_mission_1
												clear_fleet_actions = this
											}
										}
									}
								}
							}
						}
					}
				}
				if = {
					limit = {
						any_system = {
							has_star_flag = system_target_2
						}
					}
					queue_actions = {
						repeat = {
							find_closest_system = {
								trigger = {
									id = dragon.2.retaliation.1x
									is_same_value = event_target:system_target_2
								}
								found_system = {
									move_to = this
									find_closest_planet = {
										trigger = {
											id = dragon.2.retaliation.2x
											is_star = yes
										}
										found_planet = {
											move_to = this
											wait = {
												duration = 60
											}
											effect = {
												id = dragon.2.retaliation.3x
												solar_system = {
													remove_star_flag = system_target_2
												}
												fromfrom = {
													remove_fleet_flag = dragon_mission_2
													clear_fleet_actions = this
												}
											}
										}
									}
								}
							}
						}
					}
					queue_actions = {
						repeat = {
							find_closest_system = {
								trigger = {
									id = dragon.3.retaliation.1x
									has_star_flag = guardians_dragon_system
								}
								found_system = {
									move_to = this
									find_closest_planet = {
										trigger = {
											id = dragon.3.retaliation.2x
											has_planet_flag = hoard_planet
										}
										found_planet = {
											move_to = this
											effect = {
												id = dragon.3.retaliation.3x
												fromfrom = {
													remove_fleet_flag = dragon_mission_2
													clear_fleet_actions = this
												}
											}
										}
									}
								}
							}
						}
					}
				}
				break = yes
			}
			if = {
				limit = {
					has_fleet_flag = dragon_mission_2
				}
				queue_actions = {
					repeat = {
						find_closest_system = {
							trigger = {
								id = dragon.2.retaliation.1y
								has_star_flag = system_target_2
							}
							found_system = {
								move_to = this
							}
						}
						find_closest_planet = {
							trigger = {
								id = dragon.2.retaliation.2y
								is_star = yes
							}
							found_planet = {
								move_to = this
								wait = {
									duration = 60
								}
								effect = {
									id = dragon.2.retaliation.3y
									solar_system = {
										remove_star_flag = system_target_2
									}
									fromfrom = {
										remove_fleet_flag = dragon_mission_2
										clear_fleet_actions = this
									}
								}
							}
						}
					}
				}
				queue_actions = {
					repeat = {
						find_closest_system = {
							trigger = {
								id = dragon.3.retaliation.1y
								has_star_flag = guardians_dragon_system
							}
							found_system = {
								move_to = this
								find_closest_planet = {
									trigger = {
										id = dragon.3.retaliation.2y
										has_planet_flag = hoard_planet
									}
									found_planet = {
										move_to = this
										effect = {
											id = dragon.3.retaliation.3y
											fromfrom = {
												remove_fleet_flag = dragon_mission_2
												clear_fleet_actions = this
											}
										}
									}
								}
							}
						}
					}
				}
				break = yes
			}
			if = {
				limit = {
					has_fleet_flag = dragon_mission_2
				}
				queue_actions = {
					repeat = {
						find_closest_system = {
							trigger = {
								id = dragon.3.retaliation.1z
								has_star_flag = guardians_dragon_system
							}
							found_system = {
								move_to = this
								find_closest_planet = {
									trigger = {
										id = dragon.3.retaliation.2z
										has_planet_flag = hoard_planet
									}
									found_planet = {
										move_to = this
										effect = {
											id = dragon.3.retaliation.3z
											fromfrom = {
												remove_fleet_flag = dragon_mission_2
												clear_fleet_actions = this
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
}

# Dragon retaliates if hurt and fleet destroyed
country_event = {
	id = leviathans.648
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		is_country_type = guardian_dragon
		any_owned_ship = {
			is_ship_size = space_dragon_red
			has_hp_percentage < 0.80
			has_hp_percentage > 0.15
			fleet = {
				NOT = {
					has_fleet_flag = aggro_cooldown
				}
				exists = solar_system
				solar_system = {
					has_star_flag = guardians_dragon_system
				}
			}
		}
		from = {
			is_country_type = default
		}
	}

	immediate = {
		random_owned_fleet = {
			limit = {
				any_owned_ship = {
					is_ship_size = space_dragon_red
				}
			}
			set_timed_fleet_flag = {
				flag = aggro_cooldown
				days = 60
			}
			clear_fleet_actions = this
			fleet_event = { id = leviathans.652 }
		}
		from = {
			country_event = { id = leviathans.649 }
		}
	}
}

# Retaliation notification
country_event = {
	id = leviathans.649
	title = leviathans.650.name
	desc = {
		text = leviathans.649.desc
		trigger = {
			NOT = { has_ethic = ethic_gestalt_consciousness }
		}
	}
	desc = {
		text = leviathans.649.desc.gesta
		trigger = {
			has_ethic = ethic_gestalt_consciousness
		}
	}
	picture = GFX_evt_exploding_ship
	is_triggered_only = yes

	trigger = {
		from = { is_country_type = guardian_dragon }
	}

	option = {
		name = leviathans.649.a
		trigger = {
			NOT = { has_ethic = ethic_gestalt_consciousness }
		}
	}

	option = {
		name = leviathans.649.b.gesta
		trigger = {
			has_ethic = ethic_gestalt_consciousness
		}
	}
}

# Dragon pursues if fleet flees
# Fired before entering FTL - does combat still exist?
fleet_event = {
	id = leviathans.650
	#hide_window = yes
	title = leviathans.650.name
	desc = {
		text = leviathans.650.desc
		trigger = {
			owner = { NOT = { has_ethic = ethic_gestalt_consciousness } }
		}
	}
	desc = {
		text = leviathans.650.desc.gesta
		trigger = {
			owner = { has_ethic = ethic_gestalt_consciousness }
		}
	}
	picture = GFX_evt_space_dragon
	is_triggered_only = yes

	trigger = {
		owner = {
			is_country_type = default
		}
		from = {
			has_star_flag = guardians_dragon_system
		}
		any_combatant_fleet = {
			exists = owner
			owner = {
				is_country_type = guardian_dragon
			}
			NOT = { has_fleet_flag = aggro_cooldown }
			any_owned_ship = {
				is_ship_size = space_dragon_red
				has_hp_percentage < 0.80
				has_hp_percentage > 0.15
			}
		}
	}

	immediate = {
		random_combatant_fleet = {
			limit = {
				exists = owner
				owner = {
					is_country_type = guardian_dragon
				}
				any_owned_ship = {
					is_ship_size = space_dragon_red
				}
			}
			#save_event_target_as = retaliating_dragon
			set_timed_fleet_flag = {
				flag = aggro_cooldown
				days = 30
			}
			clear_fleet_actions = this
			fleet_event = { id = leviathans.651 }
		}
	}

	option = {
		name = leviathans.649.a
		trigger = { owner = { NOT = { has_ethic = ethic_gestalt_consciousness } } }
	}

	option = {
		name = leviathans.649.b.gesta
		trigger = { owner = { has_ethic = ethic_gestalt_consciousness } }
	}
}

# Goes to two of fleeing country's systems (with stations) and gets wreckin'
fleet_event = {
	id = leviathans.651
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		exists = from
		exists = from.owner
	}

	immediate = {
		closest_system = {
			limit = {
				any_fleet_in_system = {
					OR = {
						is_ship_size = mining_station
						is_ship_size = research_station
						is_ship_class = shipclass_starbase
					}
					exists = owner
					owner = {
						is_same_value = from.owner
					}
				}
			}
			set_star_flag = system_target_1
			save_event_target_as = system_target_1
		}
		if = {
			limit = {
				exists = event_target:system_target_1
			}
			set_fleet_flag = dragon_mission_1
			#from.owner = { country_event = { id = leviathans.649 } }
			queue_actions = {
				repeat = {
					max_iterations = 1
					find_closest_system = {
						trigger = {
							id = dragon.1.retaliation.1
							is_same_value = event_target:system_target_1
						}
						found_system = {
							move_to = this
							find_closest_planet = {
								trigger = {
									id = dragon.1.retaliation.2
									is_star = yes
								}
								found_planet = {
									move_to = this
									wait = {
										duration = 1
									}
									effect = {
										id = dragon.1.retaliation.3
										solar_system = {
											remove_star_flag = system_target_1
										}
										root = {
											remove_fleet_flag = dragon_mission_1
											#clear_fleet_actions = this
										}
									}
									find_closest_system = {
										trigger = {
											id = dragon.3.retaliation.1
											has_star_flag = guardians_dragon_system
										}
										found_system = {
											move_to = this
											find_closest_planet = {
												trigger = {
													id = dragon.3.retaliation.2
													has_planet_flag = hoard_planet
												}
												found_planet = {
													move_to = this
													effect = {
														id = dragon.3.retaliation.3
														root = {
															remove_fleet_flag = dragon_mission_2
															clear_fleet_actions = this
														}
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
}

# Goes to two of destroyed fleet owner's systems (with stations) and gets wreckin'
fleet_event = {
	id = leviathans.652
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		exists = fromfrom
	}

	immediate = {
		closest_system = {
			limit = {
				any_fleet_in_system = {
					OR = {
						is_ship_size = mining_station
						is_ship_size = research_station
						is_ship_class = shipclass_starbase
					}
					exists = owner
					owner = {
						is_same_value = fromfrom
					}
				}
			}
			set_star_flag = system_target_2
			save_event_target_as = system_target_2
		}
		if = {
			limit = {
				exists = event_target:system_target_2
			}
			set_fleet_flag = dragon_mission_1
			#fromfrom = { country_event = { id = leviathans.649 } }
			queue_actions = {
				repeat = {
					max_iterations = 1
					find_closest_system = {
						trigger = {
							id = dragon.4.retaliation.1
							is_same_value = event_target:system_target_2
						}
						found_system = {
							move_to = this
							find_closest_planet = {
								trigger = {
									id = dragon.4.retaliation.2
									is_star = yes
								}
								found_planet = {
									move_to = this
									wait = {
										duration = 1
									}
									effect = {
										id = dragon.4.retaliation.3
										solar_system = {
											remove_star_flag = system_target_2
										}
										root = {
											remove_fleet_flag = dragon_mission_2
											#clear_fleet_actions = this
										}
									}
									find_closest_system = {
										trigger = {
											id = dragon.5.retaliation.1
											has_star_flag = guardians_dragon_system
										}
										found_system = {
											move_to = this
											find_closest_planet = {
												trigger = {
													id = dragon.5.retaliation.2
													has_planet_flag = hoard_planet
												}
												found_planet = {
													move_to = this
													effect = {
														id = dragon.5.retaliation.3
														root = {
															remove_fleet_flag = dragon_mission_2
															clear_fleet_actions = this
														}
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
}

fleet_event = {
	id = leviathans.654
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		owner = {
			is_country_type = default
		}
		from = {
			has_star_flag = guardians_dragon_system
		}
		any_combatant_fleet = {
			exists = owner
			owner = {
				is_country_type = guardian_dragon
			}
			#NOT = { has_fleet_flag = aggro_cooldown }
			any_owned_ship = {
				is_ship_size = space_dragon_red
				has_hp_percentage < 0.16
			}
		}
	}

	immediate = {
		from = {
			random_fleet_in_system = {
				limit = {
					exists = owner
					owner = {
						is_country_type = guardian_dragon
					}
					#NOT = { has_fleet_flag = aggro_cooldown }
					any_owned_ship = {
						is_ship_size = space_dragon_red
					}
				}
				random_owned_ship = {
					limit = { is_ship_size = space_dragon_red }
					save_event_target_as = dragon_ship
				}
				clear_fleet_actions = this
				queue_actions = {
					repeat = {
						max_iterations = 1
						find_random_system = {
							trigger = {
								id = guardian.hibernate.7
								has_star_flag = guardians_dragon_system
							}
							found_system = {
								move_to = this
								find_random_planet = {
									trigger = {
										id = guardian.hibernate.8
										is_star = yes
									}
									found_planet = {
										move_to = this
										orbit_planet = this
										effect = {
											id = guardian.hibernate.9
											event_target:dragon_ship = {
												repair_ship = yes
											}
										}
									}
								}
								wait = {
									duration = 60
								}
							}
						}
					}
				}
			}
		}
	}
}

# On won battle but wounded, hibernate
country_event = {
	id = leviathans.655
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		is_country_type = guardian_dragon
		fromfrom = {
			any_owned_ship = {
				has_hp_percentage < 0.16
			}
			NOR = {
				has_fleet_flag = dragon_mission_1
				has_fleet_flag = dragon_mission_2
			}
		}
	}

	immediate = {
		fromfrom = {
			clear_fleet_actions = this
			queue_actions = {
				repeat = {
					max_iterations = 1
					find_random_system = {
						trigger = {
							id = guardian.hibernate.1
							has_star_flag = guardians_dragon_system
						}
						found_system = {
							move_to = this
							find_random_planet = {
								trigger = {
									id = guardian.hibernate.2
									is_star = yes
								}
								found_planet = {
									orbit_planet = this
									effect = {
										id = guardian.hibernate.3
										root.fromfrom = { random_owned_ship = { repair_ship = yes } }
									}
								}
							}
							wait = {
								duration = 60
							}
						}
					}
				}
			}
		}
	}
}

fleet_event = {
	id = leviathans.1
	hide_window = yes

	trigger = { always = no }

	immediate = {
		destroy_fleet = this
	}
}

planet_event = {
	id = leviathans.660
	hide_window = yes
	mean_time_to_happen = {
		years = 50
	}

	trigger = {
		has_planet_flag = hoard_planet
		#has_deposit = d_guardian_dragon_hoard
		NOT = {
			has_planet_flag = deboned
		}
		has_mining_station = yes
		exists = controller
		controller = {
			is_country_type = default
		}
	}

	immediate = {
		set_planet_flag = deboned
		controller = {
			country_event = { id = leviathans.661 }
		}
	}
}

# Dragon Hoard event - Bones
country_event = {
	id = leviathans.661
	title = "leviathans.660.name"
	desc = "leviathans.660.desc"
	picture = GFX_evt_archaeological_dig
	location = from
	show_sound = event_mystic_reveal

	is_triggered_only = yes

	option = {
		name = leviathans.660.a
		trigger = {
			NOR = {
				has_tech_option = tech_dragon_armor
				has_technology = tech_dragon_armor
			}
		}
		add_research_option = tech_dragon_armor
		add_tech_progress = {
			tech = tech_dragon_armor
			progress = 0.3
		}
	}

	option = {
		name = leviathans.660.b
		add_monthly_resource_mult = {
			resource = minerals
			value = @tier4materialreward
			min = @tier4materialmin
			max = @tier4materialmax
		}
		add_monthly_resource_mult = {
			resource = society_research
			value = @tier4researchreward
			min = @tier4researchmin
			max = @tier4researchmax
		}
	}
}

planet_event = {
	id = leviathans.662
	hide_window = yes

	mean_time_to_happen = {
		years = 50
	}

	trigger = {
		has_planet_flag = hoard_planet
		#has_deposit = d_guardian_dragon_hoard
		NOT = {
			has_planet_flag = deegged
		}
		has_mining_station = yes
		exists = controller
		controller = {
			is_country_type = default
		}
	}

	immediate = {
		set_planet_flag = deegged
		controller = {
			country_event = { id = leviathans.663 }
		}
	}
}

# Dragon Hoard event - Egg
country_event = {
	id = leviathans.663
	title = "leviathans.661.name"
	desc = "leviathans.661.desc"
	picture = GFX_evt_archaeological_dig
	location = root
	show_sound = event_mystic_reveal
	trackable = yes

	is_triggered_only = yes

	option = {
		name = leviathans.661.a
		custom_tooltip = leviathans.661.a.tooltip
		# planet/owner project, best start in country scope, instead of location scope
		enable_special_project = {
			name = "DRAGON_INCUBATION_PROJECT"
			location = capital_scope
			owner = root
		}
	}

	option = {
		name = leviathans.661.b
		custom_tooltip = leviathans.661.b.tooltip
		add_resource = { influence = 300 }
	}
}

# Egg incubated
planet_event = {
	id = leviathans.664
	title = leviathans.664.name
	desc = leviathans.664.desc
	picture = GFX_evt_space_dragon
	location = root
	show_sound = event_mystic_reveal

	is_triggered_only = yes

	immediate = {
		create_fleet = {
			name = "NAME_Ether_Hatchling"
			settings = {
				can_upgrade = no
				can_change_composition = no
				can_change_leader = no
				uses_naval_capacity = no
				spawn_debris = no
			}
			effect = {
				set_owner = root.owner
				create_ship_design = {
					design = NAME_Dragonspawn
				}
				create_ship = {
					design = last_created_design
					name = "NAME_Scile"
					prefix = no
					upgradable = no
				}
				set_location = root
			}
		}
		owner = { set_country_flag = hatched_dragon }
	}

	option = {
		name = leviathans.664.a
		custom_tooltip = leviathans.664.a.tooltip
	}
}

country_event = {
	id = leviathans.665
	title = leviathans.665.name
	desc = {
		text = leviathans.665.desc
		trigger = { NOT = { has_ethic = ethic_gestalt_consciousness } }
	}
	desc = {
		text = leviathans.665.desc.gesta
		trigger = { has_ethic = ethic_gestalt_consciousness }
	}
	picture = GFX_evt_throne_room
	location = capital_scope
	show_sound = event_mystic_reveal

	is_triggered_only = yes

	option = {
		name = UNFORTUNATE
	}
}

# victorious admiral gains dragonslayer trait
country_event = {
	id = leviathans.670
	title = leviathans.670.name
	desc = {
		text = leviathans.670.desc
		trigger = {
			NOT = { has_ethic = ethic_gestalt_consciousness }
			fromfrom = {
				exists = leader
			}
		}
	}
	desc = {
		text = leviathans.670.desc.noleader
		trigger = {
			NOT = { has_ethic = ethic_gestalt_consciousness }
			fromfrom = {
				NOT = { exists = leader }
			}
		}
	}
	desc = {
		text = leviathans.670.desc.gesta
		trigger = {
			has_ethic = ethic_gestalt_consciousness
		}
	}
	picture = GFX_evt_space_dragon
	location = fromfrom
	show_sound = event_mystic_reveal

	is_triggered_only = yes

	trigger = {
		from = {
			is_country_type = guardian_dragon
			NOR = {
				has_country_flag = rubricator_dragon_country
				has_country_flag = here_be_the_dragon
			}
		}
		#fromfromfrom = {
		#	has_fleet_flag = dragon_fleet
		#}
	}

	immediate = {
		every_country = {
			limit = {
				is_country_type = default
				has_modifier = draconic_beats
			}
			remove_modifier = draconic_beats
		}
		fromfrom.solar_system = {
			save_event_target_as = slain_guardian_system
		}
		every_country = {
			limit = {
				is_country_type = default
				has_event_chain = curator_poi_chain
				event_target:slain_guardian_system = {
					is_point_of_interest = {
						id = curator_poi_dragon
						event_chain = curator_poi_chain
						owner = prev
					}
				}
			}
			remove_point_of_interest = curator_poi_dragon
			end_curator_chain = yes
		}
	}

	option = {
		name = leviathans.670.a
		trigger = {
			fromfrom = {
				exists = leader
			}
		}
		fromfrom = {
			leader = {
				if = {
					limit = {
						leader_class = admiral
					}
					add_trait = leader_trait_dragonslayer
				}
				ELSE_IF = {
					limit = {
						leader_class = general
					}
					add_trait = leader_trait_dragonbane
				}
			}
		}
		add_resource = { influence = 300 }
		add_relic = r_dragon_trophy
		if = { #maybe the Tiyanki accidentally killed them
			limit = { exists = capital_scope }
			capital_scope = {
				add_deposit = d_dragon_monument
			}
		}
	}

	option = {
		name = leviathans.670.a
		trigger = {
			fromfrom = {
				NOT = {
					exists = leader
				}
			}
		}
		add_resource = { influence = 300 }
		add_relic = r_dragon_trophy
		if = { #maybe the Tiyanki accidentally killed them
			limit = { exists = capital_scope }
			capital_scope = {
				add_deposit = d_dragon_monument
			}
		}
	}
	option = {
		name = galactic_features.385.reanimated

		trigger = {
			has_civic = civic_reanimated_armies
			fromfrom = {
				exists = leader
			}
		}

		enable_special_project = {
			name = "REANIMATE_GUARDIAN_DRAGON"
			location = fromfrom.solar_system.star
			owner = root.owner
		}
		fromfrom = {
			leader = {
				if = {
					limit = {
						leader_class = admiral
					}
					add_trait = leader_trait_dragonslayer
				}
				ELSE_IF = {
					limit = {
						leader_class = general
					}
					add_trait = leader_trait_dragonbane
				}
			}
		}
		add_resource = { influence = 300 }
		add_relic = r_dragon_trophy
		if = { #maybe the Tiyanki accidentally killed them
			limit = { exists = capital_scope }
			capital_scope = {
				add_deposit = d_dragon_monument
			}
		}
	}
	option = {
		name = galactic_features.385.reanimated

		trigger = {
			has_civic = civic_reanimated_armies
			fromfrom = {
				NOT = {
					exists = leader
				}
			}
		}

		enable_special_project = {
			name = "REANIMATE_GUARDIAN_DRAGON"
			location = fromfrom.solar_system.star
			owner = root.owner
		}

		add_resource = { influence = 300 }
		add_relic = r_dragon_trophy
		if = { #maybe the Tiyanki accidentally killed them
			limit = { exists = capital_scope }
			capital_scope = {
				add_deposit = d_dragon_monument
			}
		}
	}
}

# Undead Armies Reanimation
country_event = {
	id = leviathans.675
	title = "distar.218.name"
	desc = "leviathans.675.desc"
	location = from

	is_triggered_only = yes

	picture = GFX_evt_space_dragon
	show_sound = event_mystic_reveal

	option = {
		name = "it_hungers"

		create_fleet = {
			name = "NAME_Avice"
			effect = {
				set_owner = root
				create_ship = {
					name = "NAME_Avice"
					design = "NAME_Grand_Dragon"
					prefix = no
					upgradable = no
				}
				set_location = {
					target = from
					distance = 0
					angle = random
				}
				set_fleet_stance = passive
			}
			settings = {
				can_upgrade = no
				can_change_composition = no
				can_change_leader = no
				uses_naval_capacity = no
				spawn_debris = no
			}
		}
	}
}
